{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Nombre de instancia de Data Factory",
			"defaultValue": "nmex-dv-origmx-dh-usw2-adf"
		},
		"tr_catalogo_geografico_properties_typeProperties_scope": {
			"type": "string",
			"defaultValue": "/subscriptions/a6c9f13d-be73-4227-b485-c7a16289be08/resourceGroups/nmex-pp-origenesmx-dh-usea-rgp/providers/Microsoft.Storage/storageAccounts/nmexpporigdsdh79sta"
		},
		"tr_connection_catalog_properties_typeProperties_scope": {
			"type": "string",
			"defaultValue": "/subscriptions/a6c9f13d-be73-4227-b485-c7a16289be08/resourceGroups/nmex-pp-origenesmx-dh-usea-rgp/providers/Microsoft.Storage/storageAccounts/nmexpporigdsdh79sta"
		},
		"tr_dispersiones_properties_typeProperties_scope": {
			"type": "string",
			"defaultValue": "/subscriptions/a6c9f13d-be73-4227-b485-c7a16289be08/resourceGroups/nmex-pp-origenesmx-dh-usea-rgp/providers/Microsoft.Storage/storageAccounts/nmexpporigdsdh79sta"
		},
		"tr_ecomm_properties_typeProperties_scope": {
			"type": "string",
			"defaultValue": "/subscriptions/a6c9f13d-be73-4227-b485-c7a16289be08/resourceGroups/nmex-pp-origenesmx-dh-usea-rgp/providers/Microsoft.Storage/storageAccounts/nmexpporigdsdh79sta"
		},
		"tr_kf_properties_typeProperties_scope": {
			"type": "string",
			"defaultValue": "/subscriptions/a6c9f13d-be73-4227-b485-c7a16289be08/resourceGroups/nmex-pp-origenesmx-dh-usea-rgp/providers/Microsoft.Storage/storageAccounts/nmexpporigdsdh79sta"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/pl_extract_api_tablas_inb_outb')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Date UTC",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Fecha Ayer 00",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "var_final_date",
							"value": {
								"value": "@formatDateTime(convertTimeZone(utcNow(),'UTC','Central Standard Time (Mexico)'),'yyyy-MM-dd hh:mm')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Date",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Date UTC",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "date_ext",
							"value": {
								"value": "@formatDateTime(pipeline().TriggerTime,'yyyyMMdd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "web api auth",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Set Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@pipeline().parameters.par_url",
								"type": "Expression"
							},
							"method": "POST",
							"headers": {},
							"body": {
								"value": "{\n    \n}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Switch1",
						"type": "Switch",
						"dependsOn": [
							{
								"activity": "web api auth",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"on": {
								"value": "@pipeline().parameters.par_tabla",
								"type": "Expression"
							},
							"cases": [
								{
									"value": "OUTBOUND_LIVE",
									"activities": [
										{
											"name": "api_web API FECHA_EN_PLAN_COPY_01",
											"type": "Copy",
											"dependsOn": [
												{
													"activity": "Set URL Complete with Token_01",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"timeout": "0.12:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"source": {
													"type": "RestSource",
													"httpRequestTimeout": "00:01:40",
													"requestInterval": "00.00:00:00.010",
													"requestMethod": "POST",
													"requestBody": "{}"
												},
												"sink": {
													"type": "DelimitedTextSink",
													"storeSettings": {
														"type": "AzureBlobFSWriteSettings"
													},
													"formatSettings": {
														"type": "DelimitedTextWriteSettings",
														"quoteAllText": true,
														"fileExtension": ".txt"
													}
												},
												"enableStaging": false,
												"translator": {
													"type": "TabularTranslator",
													"mappings": [
														{
															"source": {
																"path": "$['truck']['eco']"
															},
															"sink": {
																"name": "truck_eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['unity']"
															},
															"sink": {
																"name": "unity",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['type_unity']"
															},
															"sink": {
																"name": "type_unity",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['ARRIVE_SOURCE_TRUCK']"
															},
															"sink": {
																"name": "ARRIVE_SOURCE_TRUCK",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['box']"
															},
															"sink": {
																"name": "box",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['note']"
															},
															"sink": {
																"name": "note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['notes']"
															},
															"sink": {
																"name": "source_notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['status']"
															},
															"sink": {
																"name": "status",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['CREATED']['date']"
															},
															"sink": {
																"name": "source_src_plan_CREATED_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['CREATED']['user']"
															},
															"sink": {
																"name": "source_src_plan_CREATED_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['DISPATCH']['date']"
															},
															"sink": {
																"name": "source_src_plan_DISPATCH_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITH_DOC']['date']"
															},
															"sink": {
																"name": "source_src_plan_WITH_DOC_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITH_DOC']['user']"
															},
															"sink": {
																"name": "source_src_plan_WITH_DOC_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['LOAD_START']['date']"
															},
															"sink": {
																"name": "source_src_plan_LOAD_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITHOUT_DOC']['date']"
															},
															"sink": {
																"name": "source_src_plan_WITHOUT_DOC_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITHOUT_DOC']['user']"
															},
															"sink": {
																"name": "source_src_plan_WITHOUT_DOC_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['EXIT']['date']"
															},
															"sink": {
																"name": "source_src_track_EXIT_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['EXIT']['user']"
															},
															"sink": {
																"name": "source_src_track_EXIT_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['INVOICE']['date']"
															},
															"sink": {
																"name": "source_src_track_INVOICE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['INVOICE']['user']"
															},
															"sink": {
																"name": "source_src_track_INVOICE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DISPATCH']['date']"
															},
															"sink": {
																"name": "source_src_track_DISPATCH_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DISPATCH']['user']"
															},
															"sink": {
																"name": "source_src_track_DISPATCH_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ENTRANCE']['date']"
															},
															"sink": {
																"name": "source_src_track_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ENTRANCE']['user']"
															},
															"sink": {
																"name": "source_src_track_ENTRANCE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_END']['date']"
															},
															"sink": {
																"name": "source_src_track_LOAD_END_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_END']['user']"
															},
															"sink": {
																"name": "source_src_track_LOAD_END_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DESK_TRUCK']['date']"
															},
															"sink": {
																"name": "source_src_track_DESK_TRUCK_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_START']['date']"
															},
															"sink": {
																"name": "source_src_track_LOAD_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_START']['user']"
															},
															"sink": {
																"name": "source_src_track_LOAD_START_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ARRIVE_DESK']['date']"
															},
															"sink": {
																"name": "source_src_track_ARRIVE_DESK_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ARRIVE_DESK']['user']"
															},
															"sink": {
																"name": "source_src_track_ARRIVE_DESK_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DESK_TRAILER']['date']"
															},
															"sink": {
																"name": "source_src_track_DESK_TRAILER_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['date']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['user']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['notes']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['auditor']"
															},
															"sink": {
																"name": "auditor",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_START']['date']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_START']['user']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_START_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['driver_exit']"
															},
															"sink": {
																"name": "source_driver_exit",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['ramp']"
															},
															"sink": {
																"name": "ramp",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['seal']"
															},
															"sink": {
																"name": "seal",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['layout']"
															},
															"sink": {
																"name": "layout",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['customs']"
															},
															"sink": {
																"name": "customs",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['coworker']"
															},
															"sink": {
																"name": "coworker",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['seal_type']"
															},
															"sink": {
																"name": "seal_type",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['box_picking']"
															},
															"sink": {
																"name": "box_picking",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['pallets_rack']"
															},
															"sink": {
																"name": "pallets_rack",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['pallets_block']"
															},
															"sink": {
																"name": "pallets_block",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['platform_chep']"
															},
															"sink": {
																"name": "platform_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['platform_white']"
															},
															"sink": {
																"name": "platform_white",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['warehouse_note']"
															},
															"sink": {
																"name": "warehouse_note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['is_committee_priority']"
															},
															"sink": {
																"name": "is_committee_priority",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['date_invoice']"
															},
															"sink": {
																"name": "date_invoice",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['convenio_chep']"
															},
															"sink": {
																"name": "convenio_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['location_name']"
															},
															"sink": {
																"name": "location_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['main_location']"
															},
															"sink": {
																"name": "main_location",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['with_document']"
															},
															"sink": {
																"name": "with_document",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['valuation_note']"
															},
															"sink": {
																"name": "valuation_note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['client']"
															},
															"sink": {
																"name": "client",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['shipto']"
															},
															"sink": {
																"name": "shipto",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny']"
															},
															"sink": {
																"name": "destiny",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['UPDATE_DATE']['date']"
															},
															"sink": {
																"name": "destiny_dst_plan_UPDATE_DATE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['UPDATE_DATE']['user']"
															},
															"sink": {
																"name": "destiny_dst_plan_UPDATE_DATE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['ENTRANCE_DATE']['date']"
															},
															"sink": {
																"name": "destiny_dst_plan_ENTRANCE_DATE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENT_GPS']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ENT_GPS_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['END_UNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_END_UNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['START_UNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_START_UNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DESTINY_ENTRANCE']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_DESTINY_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['population']"
															},
															"sink": {
																"name": "population",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['driver_exit']"
															},
															"sink": {
																"name": "destiny_driver_exit",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['gross_weight']"
															},
															"sink": {
																"name": "gross_weight",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['eco']"
															},
															"sink": {
																"name": "trailer_eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['plate']"
															},
															"sink": {
																"name": "plate",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['assing_user']"
															},
															"sink": {
																"name": "assing_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['assing_trailer']"
															},
															"sink": {
																"name": "assing_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['trailer_update']"
															},
															"sink": {
																"name": "trailer_update",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['update_date_trailer']"
															},
															"sink": {
																"name": "update_date_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['update_user_trailer']"
															},
															"sink": {
																"name": "update_user_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['ARRIVE_SOURCE_TRAILER']"
															},
															"sink": {
																"name": "ARRIVE_SOURCE_TRAILER",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['carga_tm']"
															},
															"sink": {
																"name": "carga_tm",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['semaforo']"
															},
															"sink": {
																"name": "semaforo",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['user']"
															},
															"sink": {
																"name": "supplier_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['company_name']"
															},
															"sink": {
																"name": "company_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['last_company_update']"
															},
															"sink": {
																"name": "last_company_update",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['deliveries']"
															},
															"sink": {
																"name": "deliveries",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['confirmation']"
															},
															"sink": {
																"name": "confirmation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supply_chain']"
															},
															"sink": {
																"name": "supply_chain",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['type_operation']"
															},
															"sink": {
																"name": "type_operation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['grupo_comercial']"
															},
															"sink": {
																"name": "grupo_comercial",
																"type": "String"
															}
														}
													],
													"collectionReference": ""
												}
											},
											"inputs": [
												{
													"referenceName": "nmex_rest_dataset_api",
													"type": "DatasetReference",
													"parameters": {
														"url_dataset_post_rest_api": {
															"value": "@variables('url_complete')",
															"type": "Expression"
														}
													}
												}
											],
											"outputs": [
												{
													"referenceName": "ds_adsl2_origenesmx_csv",
													"type": "DatasetReference",
													"parameters": {
														"par_directory": {
															"value": "@concat(pipeline().parameters.par_folder,'OUTBOUND_LIVE_ARCHIVOS/',variables('var_final_date'),'/')",
															"type": "Expression"
														},
														"par_filename": {
															"value": "@concat('OUTBOUND_LIVE_01_',pipeline().parameters.par_search_type,'_',variables('date_ext'),'.csv')",
															"type": "Expression"
														},
														"par_delimeter": ","
													}
												}
											]
										},
										{
											"name": "Set URL Complete with Token_01",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "Set Parameters Copy 01",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "url_complete",
												"value": {
													"value": "@concat(pipeline().parameters.par_url_base,pipeline().parameters.par_function,'?token=',activity('web api auth').output.token,'&parameters=',variables('var_parameters'))",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set Parameters Copy 01",
											"type": "SetVariable",
											"dependsOn": [],
											"policy": {
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "var_parameters",
												"value": {
													"value": "@if(empty(pipeline().parameters.par_status),\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"initial_date\":\"',variables('var_fecha_01'),'\",\"final_date\":\"', variables('var_fecha_hoy'),'\"}}')\n    ,\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"status\":\"',pipeline().parameters.par_status,'\",\"initial_date\":\"',variables('var_fecha_01'),'\",\"final_date\":\"', variables('var_fecha_hoy'),'\"}}')\n    )",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set Parameters Copy 02",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "api_web API FECHA_EN_PLAN_COPY_01",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "var_parameters_02",
												"value": {
													"value": "@if(empty(pipeline().parameters.par_status),\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"initial_date\":\"',variables('var_fecha_02'),'\",\"final_date\":\"', variables('var_fecha_01'),'\"}}')\n    ,\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"status\":\"',pipeline().parameters.par_status,'\",\"initial_date\":\"',variables('var_fecha_02'),'\",\"final_date\":\"', variables('var_fecha_01'),'\"}}')\n    )",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set Parameters Copy 03",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "api_web API FECHA_EN_PLAN_COPY_02",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "var_parameters_03",
												"value": {
													"value": "@if(empty(pipeline().parameters.par_status),\n    concat('{\"search_filters\": {\"search_type\":\"DESPACHO_REAL\",\"initial_date\":\"',variables('var_fecha_hoy'),'\",\"final_date\":\"', variables('var_fecha_hoy_02'),'\"}}')\n    ,\n    concat('{\"search_filters\": {\"search_type\":\"DESPACHO_REAL\",\"initial_date\":\"',variables('var_fecha_hoy'),'\",\"final_date\":\"', variables('var_fecha_hoy_02'),'\"}}')\n    )",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set URL Complete with Token_02",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "Set Parameters Copy 02",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "url_complete_02",
												"value": {
													"value": "@concat(pipeline().parameters.par_url_base,pipeline().parameters.par_function,'?token=',activity('web api auth').output.token,'&parameters=',variables('var_parameters_02'))",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set URL Complete with Token_03",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "Set Parameters Copy 03",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "url_complete_03",
												"value": {
													"value": "@concat(pipeline().parameters.par_url_base,pipeline().parameters.par_function,'?token=',activity('web api auth').output.token,'&parameters=',variables('var_parameters_03'))",
													"type": "Expression"
												}
											}
										},
										{
											"name": "api_web API FECHA_EN_PLAN_COPY_02",
											"type": "Copy",
											"dependsOn": [
												{
													"activity": "Set URL Complete with Token_02",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"timeout": "0.12:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"source": {
													"type": "RestSource",
													"httpRequestTimeout": "00:01:40",
													"requestInterval": "00.00:00:00.010",
													"requestMethod": "POST",
													"requestBody": "{}"
												},
												"sink": {
													"type": "DelimitedTextSink",
													"storeSettings": {
														"type": "AzureBlobFSWriteSettings"
													},
													"formatSettings": {
														"type": "DelimitedTextWriteSettings",
														"quoteAllText": true,
														"fileExtension": ".txt"
													}
												},
												"enableStaging": false,
												"translator": {
													"type": "TabularTranslator",
													"mappings": [
														{
															"source": {
																"path": "$['truck']['eco']"
															},
															"sink": {
																"name": "truck_eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['unity']"
															},
															"sink": {
																"name": "unity",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['type_unity']"
															},
															"sink": {
																"name": "type_unity",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['ARRIVE_SOURCE_TRUCK']"
															},
															"sink": {
																"name": "ARRIVE_SOURCE_TRUCK",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['box']"
															},
															"sink": {
																"name": "box",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['note']"
															},
															"sink": {
																"name": "note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['notes']"
															},
															"sink": {
																"name": "source_notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['status']"
															},
															"sink": {
																"name": "status",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['CREATED']['date']"
															},
															"sink": {
																"name": "source_src_plan_CREATED_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['CREATED']['user']"
															},
															"sink": {
																"name": "source_src_plan_CREATED_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['DISPATCH']['date']"
															},
															"sink": {
																"name": "source_src_plan_DISPATCH_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITH_DOC']['date']"
															},
															"sink": {
																"name": "source_src_plan_WITH_DOC_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITH_DOC']['user']"
															},
															"sink": {
																"name": "source_src_plan_WITH_DOC_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['LOAD_START']['date']"
															},
															"sink": {
																"name": "source_src_plan_LOAD_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITHOUT_DOC']['date']"
															},
															"sink": {
																"name": "source_src_plan_WITHOUT_DOC_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITHOUT_DOC']['user']"
															},
															"sink": {
																"name": "source_src_plan_WITHOUT_DOC_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['EXIT']['date']"
															},
															"sink": {
																"name": "source_src_track_EXIT_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['EXIT']['user']"
															},
															"sink": {
																"name": "source_src_track_EXIT_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['INVOICE']['date']"
															},
															"sink": {
																"name": "source_src_track_INVOICE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['INVOICE']['user']"
															},
															"sink": {
																"name": "source_src_track_INVOICE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DISPATCH']['date']"
															},
															"sink": {
																"name": "source_src_track_DISPATCH_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DISPATCH']['user']"
															},
															"sink": {
																"name": "source_src_track_DISPATCH_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ENTRANCE']['date']"
															},
															"sink": {
																"name": "source_src_track_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ENTRANCE']['user']"
															},
															"sink": {
																"name": "source_src_track_ENTRANCE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_END']['date']"
															},
															"sink": {
																"name": "source_src_track_LOAD_END_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_END']['user']"
															},
															"sink": {
																"name": "source_src_track_LOAD_END_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DESK_TRUCK']['date']"
															},
															"sink": {
																"name": "source_src_track_DESK_TRUCK_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_START']['date']"
															},
															"sink": {
																"name": "source_src_track_LOAD_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_START']['user']"
															},
															"sink": {
																"name": "source_src_track_LOAD_START_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ARRIVE_DESK']['date']"
															},
															"sink": {
																"name": "source_src_track_ARRIVE_DESK_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ARRIVE_DESK']['user']"
															},
															"sink": {
																"name": "source_src_track_ARRIVE_DESK_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DESK_TRAILER']['date']"
															},
															"sink": {
																"name": "source_src_track_DESK_TRAILER_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['date']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['user']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['notes']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['auditor']"
															},
															"sink": {
																"name": "auditor",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_START']['date']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_START']['user']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_START_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['driver_exit']"
															},
															"sink": {
																"name": "source_driver_exit",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['ramp']"
															},
															"sink": {
																"name": "ramp",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['seal']"
															},
															"sink": {
																"name": "seal",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['layout']"
															},
															"sink": {
																"name": "layout",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['customs']"
															},
															"sink": {
																"name": "customs",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['coworker']"
															},
															"sink": {
																"name": "coworker",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['seal_type']"
															},
															"sink": {
																"name": "seal_type",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['box_picking']"
															},
															"sink": {
																"name": "box_picking",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['pallets_rack']"
															},
															"sink": {
																"name": "pallets_rack",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['pallets_block']"
															},
															"sink": {
																"name": "pallets_block",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['platform_chep']"
															},
															"sink": {
																"name": "platform_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['platform_white']"
															},
															"sink": {
																"name": "platform_white",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['warehouse_note']"
															},
															"sink": {
																"name": "warehouse_note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['is_committee_priority']"
															},
															"sink": {
																"name": "is_committee_priority",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['date_invoice']"
															},
															"sink": {
																"name": "date_invoice",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['convenio_chep']"
															},
															"sink": {
																"name": "convenio_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['location_name']"
															},
															"sink": {
																"name": "location_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['main_location']"
															},
															"sink": {
																"name": "main_location",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['with_document']"
															},
															"sink": {
																"name": "with_document",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['valuation_note']"
															},
															"sink": {
																"name": "valuation_note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['client']"
															},
															"sink": {
																"name": "client",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['shipto']"
															},
															"sink": {
																"name": "shipto",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny']"
															},
															"sink": {
																"name": "destiny",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['UPDATE_DATE']['date']"
															},
															"sink": {
																"name": "destiny_dst_plan_UPDATE_DATE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['UPDATE_DATE']['user']"
															},
															"sink": {
																"name": "destiny_dst_plan_UPDATE_DATE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['ENTRANCE_DATE']['date']"
															},
															"sink": {
																"name": "destiny_dst_plan_ENTRANCE_DATE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENT_GPS']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ENT_GPS_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['END_UNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_END_UNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['START_UNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_START_UNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DESTINY_ENTRANCE']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_DESTINY_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['population']"
															},
															"sink": {
																"name": "population",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['driver_exit']"
															},
															"sink": {
																"name": "destiny_driver_exit",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['gross_weight']"
															},
															"sink": {
																"name": "gross_weight",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['eco']"
															},
															"sink": {
																"name": "trailer_eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['plate']"
															},
															"sink": {
																"name": "plate",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['assing_user']"
															},
															"sink": {
																"name": "assing_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['assing_trailer']"
															},
															"sink": {
																"name": "assing_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['trailer_update']"
															},
															"sink": {
																"name": "trailer_update",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['update_date_trailer']"
															},
															"sink": {
																"name": "update_date_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['update_user_trailer']"
															},
															"sink": {
																"name": "update_user_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['ARRIVE_SOURCE_TRAILER']"
															},
															"sink": {
																"name": "ARRIVE_SOURCE_TRAILER",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['carga_tm']"
															},
															"sink": {
																"name": "carga_tm",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['semaforo']"
															},
															"sink": {
																"name": "semaforo",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['user']"
															},
															"sink": {
																"name": "supplier_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['company_name']"
															},
															"sink": {
																"name": "company_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['last_company_update']"
															},
															"sink": {
																"name": "last_company_update",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['deliveries']"
															},
															"sink": {
																"name": "deliveries",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['confirmation']"
															},
															"sink": {
																"name": "confirmation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supply_chain']"
															},
															"sink": {
																"name": "supply_chain",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['type_operation']"
															},
															"sink": {
																"name": "type_operation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['grupo_comercial']"
															},
															"sink": {
																"name": "grupo_comercial",
																"type": "String"
															}
														}
													],
													"collectionReference": ""
												}
											},
											"inputs": [
												{
													"referenceName": "nmex_rest_dataset_api",
													"type": "DatasetReference",
													"parameters": {
														"url_dataset_post_rest_api": {
															"value": "@variables('url_complete_02')",
															"type": "Expression"
														}
													}
												}
											],
											"outputs": [
												{
													"referenceName": "ds_adsl2_origenesmx_csv",
													"type": "DatasetReference",
													"parameters": {
														"par_directory": {
															"value": "@concat(pipeline().parameters.par_folder,'OUTBOUND_LIVE_ARCHIVOS/',variables('var_final_date'),'/')",
															"type": "Expression"
														},
														"par_filename": {
															"value": "@concat('OUTBOUND_LIVE_02_',pipeline().parameters.par_search_type,'_',variables('date_ext'),'.csv')",
															"type": "Expression"
														},
														"par_delimeter": ","
													}
												}
											]
										},
										{
											"name": "api_web API FECHA_EN_PLAN_COPY_03",
											"type": "Copy",
											"dependsOn": [
												{
													"activity": "Set URL Complete with Token_03",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"timeout": "0.12:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"source": {
													"type": "RestSource",
													"httpRequestTimeout": "00:01:40",
													"requestInterval": "00.00:00:00.010",
													"requestMethod": "POST",
													"requestBody": "{}"
												},
												"sink": {
													"type": "DelimitedTextSink",
													"storeSettings": {
														"type": "AzureBlobFSWriteSettings"
													},
													"formatSettings": {
														"type": "DelimitedTextWriteSettings",
														"quoteAllText": true,
														"fileExtension": ".txt"
													}
												},
												"enableStaging": false,
												"translator": {
													"type": "TabularTranslator",
													"mappings": [
														{
															"source": {
																"path": "$['truck']['eco']"
															},
															"sink": {
																"name": "truck_eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['unity']"
															},
															"sink": {
																"name": "unity",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['type_unity']"
															},
															"sink": {
																"name": "type_unity",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['ARRIVE_SOURCE_TRUCK']"
															},
															"sink": {
																"name": "ARRIVE_SOURCE_TRUCK",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['box']"
															},
															"sink": {
																"name": "box",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['note']"
															},
															"sink": {
																"name": "note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['notes']"
															},
															"sink": {
																"name": "source_notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['status']"
															},
															"sink": {
																"name": "status",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['CREATED']['date']"
															},
															"sink": {
																"name": "source_src_plan_CREATED_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['CREATED']['user']"
															},
															"sink": {
																"name": "source_src_plan_CREATED_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['DISPATCH']['date']"
															},
															"sink": {
																"name": "source_src_plan_DISPATCH_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITH_DOC']['date']"
															},
															"sink": {
																"name": "source_src_plan_WITH_DOC_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITH_DOC']['user']"
															},
															"sink": {
																"name": "source_src_plan_WITH_DOC_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['LOAD_START']['date']"
															},
															"sink": {
																"name": "source_src_plan_LOAD_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITHOUT_DOC']['date']"
															},
															"sink": {
																"name": "source_src_plan_WITHOUT_DOC_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITHOUT_DOC']['user']"
															},
															"sink": {
																"name": "source_src_plan_WITHOUT_DOC_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['EXIT']['date']"
															},
															"sink": {
																"name": "source_src_track_EXIT_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['EXIT']['user']"
															},
															"sink": {
																"name": "source_src_track_EXIT_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['INVOICE']['date']"
															},
															"sink": {
																"name": "source_src_track_INVOICE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['INVOICE']['user']"
															},
															"sink": {
																"name": "source_src_track_INVOICE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DISPATCH']['date']"
															},
															"sink": {
																"name": "source_src_track_DISPATCH_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DISPATCH']['user']"
															},
															"sink": {
																"name": "source_src_track_DISPATCH_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ENTRANCE']['date']"
															},
															"sink": {
																"name": "source_src_track_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ENTRANCE']['user']"
															},
															"sink": {
																"name": "source_src_track_ENTRANCE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_END']['date']"
															},
															"sink": {
																"name": "source_src_track_LOAD_END_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_END']['user']"
															},
															"sink": {
																"name": "source_src_track_LOAD_END_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DESK_TRUCK']['date']"
															},
															"sink": {
																"name": "source_src_track_DESK_TRUCK_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_START']['date']"
															},
															"sink": {
																"name": "source_src_track_LOAD_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_START']['user']"
															},
															"sink": {
																"name": "source_src_track_LOAD_START_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ARRIVE_DESK']['date']"
															},
															"sink": {
																"name": "source_src_track_ARRIVE_DESK_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ARRIVE_DESK']['user']"
															},
															"sink": {
																"name": "source_src_track_ARRIVE_DESK_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DESK_TRAILER']['date']"
															},
															"sink": {
																"name": "source_src_track_DESK_TRAILER_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['date']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['user']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['notes']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['auditor']"
															},
															"sink": {
																"name": "auditor",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_START']['date']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_START']['user']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_START_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['driver_exit']"
															},
															"sink": {
																"name": "source_driver_exit",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['ramp']"
															},
															"sink": {
																"name": "ramp",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['seal']"
															},
															"sink": {
																"name": "seal",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['layout']"
															},
															"sink": {
																"name": "layout",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['customs']"
															},
															"sink": {
																"name": "customs",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['coworker']"
															},
															"sink": {
																"name": "coworker",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['seal_type']"
															},
															"sink": {
																"name": "seal_type",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['box_picking']"
															},
															"sink": {
																"name": "box_picking",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['pallets_rack']"
															},
															"sink": {
																"name": "pallets_rack",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['pallets_block']"
															},
															"sink": {
																"name": "pallets_block",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['platform_chep']"
															},
															"sink": {
																"name": "platform_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['platform_white']"
															},
															"sink": {
																"name": "platform_white",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['warehouse_note']"
															},
															"sink": {
																"name": "warehouse_note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['is_committee_priority']"
															},
															"sink": {
																"name": "is_committee_priority",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['date_invoice']"
															},
															"sink": {
																"name": "date_invoice",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['convenio_chep']"
															},
															"sink": {
																"name": "convenio_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['location_name']"
															},
															"sink": {
																"name": "location_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['main_location']"
															},
															"sink": {
																"name": "main_location",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['with_document']"
															},
															"sink": {
																"name": "with_document",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['valuation_note']"
															},
															"sink": {
																"name": "valuation_note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['client']"
															},
															"sink": {
																"name": "client",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['shipto']"
															},
															"sink": {
																"name": "shipto",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny']"
															},
															"sink": {
																"name": "destiny",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['UPDATE_DATE']['date']"
															},
															"sink": {
																"name": "destiny_dst_plan_UPDATE_DATE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['UPDATE_DATE']['user']"
															},
															"sink": {
																"name": "destiny_dst_plan_UPDATE_DATE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['ENTRANCE_DATE']['date']"
															},
															"sink": {
																"name": "destiny_dst_plan_ENTRANCE_DATE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENT_GPS']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ENT_GPS_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['END_UNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_END_UNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['START_UNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_START_UNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DESTINY_ENTRANCE']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_DESTINY_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['population']"
															},
															"sink": {
																"name": "population",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['driver_exit']"
															},
															"sink": {
																"name": "destiny_driver_exit",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['gross_weight']"
															},
															"sink": {
																"name": "gross_weight",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['eco']"
															},
															"sink": {
																"name": "trailer_eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['plate']"
															},
															"sink": {
																"name": "plate",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['assing_user']"
															},
															"sink": {
																"name": "assing_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['assing_trailer']"
															},
															"sink": {
																"name": "assing_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['trailer_update']"
															},
															"sink": {
																"name": "trailer_update",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['update_date_trailer']"
															},
															"sink": {
																"name": "update_date_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['update_user_trailer']"
															},
															"sink": {
																"name": "update_user_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['ARRIVE_SOURCE_TRAILER']"
															},
															"sink": {
																"name": "ARRIVE_SOURCE_TRAILER",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['carga_tm']"
															},
															"sink": {
																"name": "carga_tm",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['semaforo']"
															},
															"sink": {
																"name": "semaforo",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['user']"
															},
															"sink": {
																"name": "supplier_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['company_name']"
															},
															"sink": {
																"name": "company_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['last_company_update']"
															},
															"sink": {
																"name": "last_company_update",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['deliveries']"
															},
															"sink": {
																"name": "deliveries",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['confirmation']"
															},
															"sink": {
																"name": "confirmation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supply_chain']"
															},
															"sink": {
																"name": "supply_chain",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['type_operation']"
															},
															"sink": {
																"name": "type_operation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['grupo_comercial']"
															},
															"sink": {
																"name": "grupo_comercial",
																"type": "String"
															}
														}
													],
													"collectionReference": ""
												}
											},
											"inputs": [
												{
													"referenceName": "nmex_rest_dataset_api",
													"type": "DatasetReference",
													"parameters": {
														"url_dataset_post_rest_api": {
															"value": "@variables('url_complete_03')",
															"type": "Expression"
														}
													}
												}
											],
											"outputs": [
												{
													"referenceName": "ds_adsl2_origenesmx_csv",
													"type": "DatasetReference",
													"parameters": {
														"par_directory": {
															"value": "@concat(pipeline().parameters.par_folder,'OUTBOUND_LIVE_ARCHIVOS/',variables('var_final_date'),'/')",
															"type": "Expression"
														},
														"par_filename": {
															"value": "@concat('OUTBOUND_LIVE_03_',pipeline().parameters.par_search_type,'_',variables('date_ext'),'.csv')",
															"type": "Expression"
														},
														"par_delimeter": ","
													}
												}
											]
										}
									]
								},
								{
									"value": "INBOUND_LIVE",
									"activities": [
										{
											"name": "api_web API FECHA_CREACION_COPY_01_IN",
											"type": "Copy",
											"dependsOn": [
												{
													"activity": "Set URL Complete with Token_01_IN",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"timeout": "0.12:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"source": {
													"type": "RestSource",
													"httpRequestTimeout": "00:01:40",
													"requestInterval": "00.00:00:00.010",
													"requestMethod": "POST",
													"requestBody": "{}"
												},
												"sink": {
													"type": "DelimitedTextSink",
													"storeSettings": {
														"type": "AzureBlobFSWriteSettings"
													},
													"formatSettings": {
														"type": "DelimitedTextWriteSettings",
														"quoteAllText": true,
														"fileExtension": ".txt"
													}
												},
												"enableStaging": false,
												"translator": {
													"type": "TabularTranslator",
													"mappings": [
														{
															"source": {
																"path": "$['source']['location_name']"
															},
															"sink": {
																"name": "location_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['status']"
															},
															"sink": {
																"name": "status",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['date_gi']"
															},
															"sink": {
																"name": "date_gi",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny']"
															},
															"sink": {
																"name": "destiny",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['STAY']['hours']"
															},
															"sink": {
																"name": "hours",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['RAMP_ON']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_RAMP_ON_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENTRANCE']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENTRANCE']['rcontrol']"
															},
															"sink": {
																"name": "rcontrol",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ON_DOWNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ON_DOWNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DOWNLOAD_ON_CUSTOM']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_DOWNLOAD_ON_CUSTOM_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DOWNLOAD_ON_CUSTOM']['user']"
															},
															"sink": {
																"name": "user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['STO']"
															},
															"sink": {
																"name": "STO",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['ramp']"
															},
															"sink": {
																"name": "ramp",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['notes']"
															},
															"sink": {
																"name": "notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['auditor']"
															},
															"sink": {
																"name": "auditor",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['customs']"
															},
															"sink": {
																"name": "customs",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['picking']"
															},
															"sink": {
																"name": "picking",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['coworker']"
															},
															"sink": {
																"name": "coworker",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['number_chep']"
															},
															"sink": {
																"name": "number_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['seal_number']"
															},
															"sink": {
																"name": "seal_number",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['temperature']"
															},
															"sink": {
																"name": "temperature",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['pallets_rack']"
															},
															"sink": {
																"name": "pallets_rack",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['pallets_block']"
															},
															"sink": {
																"name": "pallets_block",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['eco']"
															},
															"sink": {
																"name": "eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['box_type']"
															},
															"sink": {
																"name": "box_type",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['carga_tm']"
															},
															"sink": {
																"name": "carga_tm",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['priority']"
															},
															"sink": {
																"name": "priority",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['company_name']"
															},
															"sink": {
																"name": "company_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['circuit_name']"
															},
															"sink": {
																"name": "circuit_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['type_operation']"
															},
															"sink": {
																"name": "type_operation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['grupo_comercial']"
															},
															"sink": {
																"name": "grupo_comercial",
																"type": "String"
															}
														}
													],
													"collectionReference": ""
												}
											},
											"inputs": [
												{
													"referenceName": "nmex_rest_dataset_api",
													"type": "DatasetReference",
													"parameters": {
														"url_dataset_post_rest_api": {
															"value": "@variables('url_complete')",
															"type": "Expression"
														}
													}
												}
											],
											"outputs": [
												{
													"referenceName": "ds_adsl2_origenesmx_csv",
													"type": "DatasetReference",
													"parameters": {
														"par_directory": {
															"value": "@concat(pipeline().parameters.par_folder,'INBOUND_LIVE_ARCHIVOS/',variables('var_final_date'),'/')",
															"type": "Expression"
														},
														"par_filename": {
															"value": "@concat('INBOUND_LIVE_01_',pipeline().parameters.par_search_type,'_',variables('date_ext'),'.csv')",
															"type": "Expression"
														},
														"par_delimeter": ","
													}
												}
											]
										},
										{
											"name": "Set URL Complete with Token_01_IN",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "Set Parameters Copy 01_IN",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "url_complete",
												"value": {
													"value": "@concat(pipeline().parameters.par_url_base,pipeline().parameters.par_function,'?token=',activity('web api auth').output.token,'&parameters=',variables('var_parameters'))",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set Parameters Copy 01_IN",
											"type": "SetVariable",
											"dependsOn": [],
											"policy": {
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "var_parameters",
												"value": {
													"value": "@if(empty(pipeline().parameters.par_status),\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"initial_date\":\"',variables('var_fecha_01'),'\",\"final_date\":\"', variables('var_fecha_hoy'),'\"}}')\n    ,\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"status\":\"',pipeline().parameters.par_status,'\",\"initial_date\":\"',variables('var_fecha_01'),'\",\"final_date\":\"', variables('var_fecha_hoy'),'\"}}')\n    )",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set Parameters Copy 02_IN",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "api_web API FECHA_CREACION_COPY_01_IN",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "var_parameters_02",
												"value": {
													"value": "@if(empty(pipeline().parameters.par_status),\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"initial_date\":\"',variables('var_fecha_02'),'\",\"final_date\":\"', variables('var_fecha_01'),'\"}}')\n    ,\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"status\":\"',pipeline().parameters.par_status,'\",\"initial_date\":\"',variables('var_fecha_02'),'\",\"final_date\":\"', variables('var_fecha_01'),'\"}}')\n    )",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set Parameters Copy 03_IN",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "api_web API FECHA_CREACION_COPY_02_IN",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "var_parameters_03",
												"value": {
													"value": "@if(empty(pipeline().parameters.par_status),\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"initial_date\":\"',variables('var_fecha_02'),'\",\"final_date\":\"', variables('var_fecha_01'),'\"}}')\n    ,\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"status\":\"SI9\",\"initial_date\":\"',variables('var_fecha_02'),'\",\"final_date\":\"', variables('var_fecha_01'),'\"}}')\n    )",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set URL Complete with Token_02_IN",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "Set Parameters Copy 02_IN",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "url_complete_02",
												"value": {
													"value": "@concat(pipeline().parameters.par_url_base,pipeline().parameters.par_function,'?token=',activity('web api auth').output.token,'&parameters=',variables('var_parameters_02'))",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set URL Complete with Token_03_copy1",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "Set Parameters Copy 03_IN",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "url_complete_03",
												"value": {
													"value": "@concat(pipeline().parameters.par_url_base,pipeline().parameters.par_function,'?token=',activity('web api auth').output.token,'&parameters=',variables('var_parameters_03'))",
													"type": "Expression"
												}
											}
										},
										{
											"name": "api_web API FECHA_CREACION_COPY_02_IN",
											"type": "Copy",
											"dependsOn": [
												{
													"activity": "Set URL Complete with Token_02_IN",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"timeout": "0.12:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"source": {
													"type": "RestSource",
													"httpRequestTimeout": "00:01:40",
													"requestInterval": "00.00:00:00.010",
													"requestMethod": "POST",
													"requestBody": "{}"
												},
												"sink": {
													"type": "DelimitedTextSink",
													"storeSettings": {
														"type": "AzureBlobFSWriteSettings"
													},
													"formatSettings": {
														"type": "DelimitedTextWriteSettings",
														"quoteAllText": true,
														"fileExtension": ".txt"
													}
												},
												"enableStaging": false,
												"translator": {
													"type": "TabularTranslator",
													"mappings": [
														{
															"source": {
																"path": "$['source']['location_name']"
															},
															"sink": {
																"name": "location_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['status']"
															},
															"sink": {
																"name": "status",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['date_gi']"
															},
															"sink": {
																"name": "date_gi",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny']"
															},
															"sink": {
																"name": "destiny",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['STAY']['hours']"
															},
															"sink": {
																"name": "hours",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['RAMP_ON']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_RAMP_ON_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENTRANCE']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENTRANCE']['rcontrol']"
															},
															"sink": {
																"name": "rcontrol",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ON_DOWNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ON_DOWNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DOWNLOAD_ON_CUSTOM']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_DOWNLOAD_ON_CUSTOM_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DOWNLOAD_ON_CUSTOM']['user']"
															},
															"sink": {
																"name": "user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['STO']"
															},
															"sink": {
																"name": "STO",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['ramp']"
															},
															"sink": {
																"name": "ramp",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['notes']"
															},
															"sink": {
																"name": "notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['auditor']"
															},
															"sink": {
																"name": "auditor",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['customs']"
															},
															"sink": {
																"name": "customs",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['picking']"
															},
															"sink": {
																"name": "picking",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['coworker']"
															},
															"sink": {
																"name": "coworker",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['number_chep']"
															},
															"sink": {
																"name": "number_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['seal_number']"
															},
															"sink": {
																"name": "seal_number",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['temperature']"
															},
															"sink": {
																"name": "temperature",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['pallets_rack']"
															},
															"sink": {
																"name": "pallets_rack",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['pallets_block']"
															},
															"sink": {
																"name": "pallets_block",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['eco']"
															},
															"sink": {
																"name": "eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['box_type']"
															},
															"sink": {
																"name": "box_type",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['carga_tm']"
															},
															"sink": {
																"name": "carga_tm",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['priority']"
															},
															"sink": {
																"name": "priority",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['company_name']"
															},
															"sink": {
																"name": "company_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['circuit_name']"
															},
															"sink": {
																"name": "circuit_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['type_operation']"
															},
															"sink": {
																"name": "type_operation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['grupo_comercial']"
															},
															"sink": {
																"name": "grupo_comercial",
																"type": "String"
															}
														}
													],
													"collectionReference": ""
												}
											},
											"inputs": [
												{
													"referenceName": "nmex_rest_dataset_api",
													"type": "DatasetReference",
													"parameters": {
														"url_dataset_post_rest_api": {
															"value": "@variables('url_complete_02')",
															"type": "Expression"
														}
													}
												}
											],
											"outputs": [
												{
													"referenceName": "ds_adsl2_origenesmx_csv",
													"type": "DatasetReference",
													"parameters": {
														"par_directory": {
															"value": "@concat(pipeline().parameters.par_folder,'INBOUND_LIVE_ARCHIVOS/',variables('var_final_date'),'/')",
															"type": "Expression"
														},
														"par_filename": {
															"value": "@concat('INBOUND_LIVE_02_',pipeline().parameters.par_search_type,'_',variables('date_ext'),'.csv')",
															"type": "Expression"
														},
														"par_delimeter": ","
													}
												}
											]
										},
										{
											"name": "api_web API FECHA_CREACION_COPY_03_IN",
											"type": "Copy",
											"dependsOn": [
												{
													"activity": "Set URL Complete with Token_03_copy1",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"timeout": "0.12:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"source": {
													"type": "RestSource",
													"httpRequestTimeout": "00:01:40",
													"requestInterval": "00.00:00:00.010",
													"requestMethod": "POST",
													"requestBody": "{}"
												},
												"sink": {
													"type": "DelimitedTextSink",
													"storeSettings": {
														"type": "AzureBlobFSWriteSettings"
													},
													"formatSettings": {
														"type": "DelimitedTextWriteSettings",
														"quoteAllText": true,
														"fileExtension": ".txt"
													}
												},
												"enableStaging": false,
												"translator": {
													"type": "TabularTranslator",
													"mappings": [
														{
															"source": {
																"path": "$['source']['location_name']"
															},
															"sink": {
																"name": "location_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['status']"
															},
															"sink": {
																"name": "status",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['date_gi']"
															},
															"sink": {
																"name": "date_gi",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny']"
															},
															"sink": {
																"name": "destiny",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['STAY']['hours']"
															},
															"sink": {
																"name": "hours",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['RAMP_ON']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_RAMP_ON_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENTRANCE']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENTRANCE']['rcontrol']"
															},
															"sink": {
																"name": "rcontrol",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ON_DOWNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ON_DOWNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DOWNLOAD_ON_CUSTOM']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_DOWNLOAD_ON_CUSTOM_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DOWNLOAD_ON_CUSTOM']['user']"
															},
															"sink": {
																"name": "user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['STO']"
															},
															"sink": {
																"name": "STO",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['ramp']"
															},
															"sink": {
																"name": "ramp",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['notes']"
															},
															"sink": {
																"name": "notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['auditor']"
															},
															"sink": {
																"name": "auditor",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['customs']"
															},
															"sink": {
																"name": "customs",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['picking']"
															},
															"sink": {
																"name": "picking",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['coworker']"
															},
															"sink": {
																"name": "coworker",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['number_chep']"
															},
															"sink": {
																"name": "number_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['seal_number']"
															},
															"sink": {
																"name": "seal_number",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['temperature']"
															},
															"sink": {
																"name": "temperature",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['pallets_rack']"
															},
															"sink": {
																"name": "pallets_rack",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['pallets_block']"
															},
															"sink": {
																"name": "pallets_block",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['eco']"
															},
															"sink": {
																"name": "eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['box_type']"
															},
															"sink": {
																"name": "box_type",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['carga_tm']"
															},
															"sink": {
																"name": "carga_tm",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['priority']"
															},
															"sink": {
																"name": "priority",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['company_name']"
															},
															"sink": {
																"name": "company_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['circuit_name']"
															},
															"sink": {
																"name": "circuit_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['type_operation']"
															},
															"sink": {
																"name": "type_operation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['grupo_comercial']"
															},
															"sink": {
																"name": "grupo_comercial",
																"type": "String"
															}
														}
													],
													"collectionReference": ""
												}
											},
											"inputs": [
												{
													"referenceName": "nmex_rest_dataset_api",
													"type": "DatasetReference",
													"parameters": {
														"url_dataset_post_rest_api": {
															"value": "@variables('url_complete_03')",
															"type": "Expression"
														}
													}
												}
											],
											"outputs": [
												{
													"referenceName": "ds_adsl2_origenesmx_csv",
													"type": "DatasetReference",
													"parameters": {
														"par_directory": {
															"value": "@concat(pipeline().parameters.par_folder,'INBOUND_LIVE_ARCHIVOS/',variables('var_final_date'),'/')",
															"type": "Expression"
														},
														"par_filename": {
															"value": "@concat('INBOUND_LIVE_03_',pipeline().parameters.par_search_type,'_',variables('date_ext'),'.csv')",
															"type": "Expression"
														},
														"par_delimeter": ","
													}
												}
											]
										}
									]
								},
								{
									"value": "OUTBOUND_HISTORICO",
									"activities": [
										{
											"name": "api_web API DESPACHO_REAL_HIST_COPY_01",
											"type": "Copy",
											"dependsOn": [
												{
													"activity": "Set URL Complete with Token_01_H",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"timeout": "0.12:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"source": {
													"type": "RestSource",
													"httpRequestTimeout": "00:01:40",
													"requestInterval": "00.00:00:00.010",
													"requestMethod": "POST",
													"requestBody": "{}"
												},
												"sink": {
													"type": "DelimitedTextSink",
													"storeSettings": {
														"type": "AzureBlobFSWriteSettings"
													},
													"formatSettings": {
														"type": "DelimitedTextWriteSettings",
														"quoteAllText": true,
														"fileExtension": ".txt"
													}
												},
												"enableStaging": false,
												"translator": {
													"type": "TabularTranslator",
													"mappings": [
														{
															"source": {
																"path": "$['truck']['eco']"
															},
															"sink": {
																"name": "truck_eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['unity']"
															},
															"sink": {
																"name": "unity",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['type_unity']"
															},
															"sink": {
																"name": "type_unity",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['ARRIVE_SOURCE_TRUCK']"
															},
															"sink": {
																"name": "ARRIVE_SOURCE_TRUCK",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['box']"
															},
															"sink": {
																"name": "box",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['note']"
															},
															"sink": {
																"name": "note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['notes']"
															},
															"sink": {
																"name": "source_notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['status']"
															},
															"sink": {
																"name": "status",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['CREATED']['date']"
															},
															"sink": {
																"name": "source_src_plan_CREATED_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['CREATED']['user']"
															},
															"sink": {
																"name": "source_src_plan_CREATED_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['DISPATCH']['date']"
															},
															"sink": {
																"name": "source_src_plan_DISPATCH_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITH_DOC']['date']"
															},
															"sink": {
																"name": "source_src_plan_WITH_DOC_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITH_DOC']['user']"
															},
															"sink": {
																"name": "source_src_plan_WITH_DOC_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['LOAD_START']['date']"
															},
															"sink": {
																"name": "source_src_plan_LOAD_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITHOUT_DOC']['date']"
															},
															"sink": {
																"name": "source_src_plan_WITHOUT_DOC_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITHOUT_DOC']['user']"
															},
															"sink": {
																"name": "source_src_plan_WITHOUT_DOC_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['EXIT']['date']"
															},
															"sink": {
																"name": "source_src_track_EXIT_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['EXIT']['user']"
															},
															"sink": {
																"name": "source_src_track_EXIT_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['INVOICE']['date']"
															},
															"sink": {
																"name": "source_src_track_INVOICE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['INVOICE']['user']"
															},
															"sink": {
																"name": "source_src_track_INVOICE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DISPATCH']['date']"
															},
															"sink": {
																"name": "source_src_track_DISPATCH_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DISPATCH']['user']"
															},
															"sink": {
																"name": "source_src_track_DISPATCH_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ENTRANCE']['date']"
															},
															"sink": {
																"name": "source_src_track_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ENTRANCE']['user']"
															},
															"sink": {
																"name": "source_src_track_ENTRANCE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_END']['date']"
															},
															"sink": {
																"name": "source_src_track_LOAD_END_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_END']['user']"
															},
															"sink": {
																"name": "source_src_track_LOAD_END_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DESK_TRUCK']['date']"
															},
															"sink": {
																"name": "source_src_track_DESK_TRUCK_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_START']['date']"
															},
															"sink": {
																"name": "source_src_track_LOAD_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_START']['user']"
															},
															"sink": {
																"name": "source_src_track_LOAD_START_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ARRIVE_DESK']['date']"
															},
															"sink": {
																"name": "source_src_track_ARRIVE_DESK_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ARRIVE_DESK']['user']"
															},
															"sink": {
																"name": "source_src_track_ARRIVE_DESK_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DESK_TRAILER']['date']"
															},
															"sink": {
																"name": "source_src_track_DESK_TRAILER_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['date']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['user']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['notes']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['auditor']"
															},
															"sink": {
																"name": "auditor",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_START']['date']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_START']['user']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_START_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['driver_exit']"
															},
															"sink": {
																"name": "source_driver_exit",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['ramp']"
															},
															"sink": {
																"name": "ramp",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['seal']"
															},
															"sink": {
																"name": "seal",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['layout']"
															},
															"sink": {
																"name": "layout",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['customs']"
															},
															"sink": {
																"name": "customs",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['coworker']"
															},
															"sink": {
																"name": "coworker",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['seal_type']"
															},
															"sink": {
																"name": "seal_type",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['box_picking']"
															},
															"sink": {
																"name": "box_picking",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['pallets_rack']"
															},
															"sink": {
																"name": "pallets_rack",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['pallets_block']"
															},
															"sink": {
																"name": "pallets_block",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['platform_chep']"
															},
															"sink": {
																"name": "platform_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['platform_white']"
															},
															"sink": {
																"name": "platform_white",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['warehouse_note']"
															},
															"sink": {
																"name": "warehouse_note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['is_committee_priority']"
															},
															"sink": {
																"name": "is_committee_priority",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['date_invoice']"
															},
															"sink": {
																"name": "date_invoice",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['convenio_chep']"
															},
															"sink": {
																"name": "convenio_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['location_name']"
															},
															"sink": {
																"name": "location_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['main_location']"
															},
															"sink": {
																"name": "main_location",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['with_document']"
															},
															"sink": {
																"name": "with_document",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['valuation_note']"
															},
															"sink": {
																"name": "valuation_note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['client']"
															},
															"sink": {
																"name": "client",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['shipto']"
															},
															"sink": {
																"name": "shipto",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny']"
															},
															"sink": {
																"name": "destiny",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['UPDATE_DATE']['date']"
															},
															"sink": {
																"name": "destiny_dst_plan_UPDATE_DATE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['UPDATE_DATE']['user']"
															},
															"sink": {
																"name": "destiny_dst_plan_UPDATE_DATE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['ENTRANCE_DATE']['date']"
															},
															"sink": {
																"name": "destiny_dst_plan_ENTRANCE_DATE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENT_GPS']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ENT_GPS_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['END_UNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_END_UNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['START_UNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_START_UNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DESTINY_ENTRANCE']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_DESTINY_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['population']"
															},
															"sink": {
																"name": "population",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['driver_exit']"
															},
															"sink": {
																"name": "destiny_driver_exit",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['gross_weight']"
															},
															"sink": {
																"name": "gross_weight",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['eco']"
															},
															"sink": {
																"name": "trailer_eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['plate']"
															},
															"sink": {
																"name": "plate",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['assing_user']"
															},
															"sink": {
																"name": "assing_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['assing_trailer']"
															},
															"sink": {
																"name": "assing_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['trailer_update']"
															},
															"sink": {
																"name": "trailer_update",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['update_date_trailer']"
															},
															"sink": {
																"name": "update_date_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['update_user_trailer']"
															},
															"sink": {
																"name": "update_user_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['ARRIVE_SOURCE_TRAILER']"
															},
															"sink": {
																"name": "ARRIVE_SOURCE_TRAILER",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['carga_tm']"
															},
															"sink": {
																"name": "carga_tm",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['semaforo']"
															},
															"sink": {
																"name": "semaforo",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['user']"
															},
															"sink": {
																"name": "supplier_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['company_name']"
															},
															"sink": {
																"name": "company_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['last_company_update']"
															},
															"sink": {
																"name": "last_company_update",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['deliveries']"
															},
															"sink": {
																"name": "deliveries",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['confirmation']"
															},
															"sink": {
																"name": "confirmation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supply_chain']"
															},
															"sink": {
																"name": "supply_chain",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['type_operation']"
															},
															"sink": {
																"name": "type_operation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['grupo_comercial']"
															},
															"sink": {
																"name": "grupo_comercial",
																"type": "String"
															}
														}
													],
													"collectionReference": ""
												}
											},
											"inputs": [
												{
													"referenceName": "nmex_rest_dataset_api",
													"type": "DatasetReference",
													"parameters": {
														"url_dataset_post_rest_api": {
															"value": "@variables('url_complete')",
															"type": "Expression"
														}
													}
												}
											],
											"outputs": [
												{
													"referenceName": "ds_adsl2_origenesmx_csv",
													"type": "DatasetReference",
													"parameters": {
														"par_directory": {
															"value": "@concat(pipeline().parameters.par_folder,'OUTBOUND_HISTORICO_ARCHIVOS/',variables('var_final_date'),'/')",
															"type": "Expression"
														},
														"par_filename": {
															"value": "@concat('OUTBOUND_HISTORICO_01_',pipeline().parameters.par_search_type,'_',variables('date_ext'),'.csv')",
															"type": "Expression"
														},
														"par_delimeter": ","
													}
												}
											]
										},
										{
											"name": "Set URL Complete with Token_01_H",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "Set Parameters Copy 01_H",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "url_complete",
												"value": {
													"value": "@concat(pipeline().parameters.par_url_base,pipeline().parameters.par_function,'?token=',activity('web api auth').output.token,'&parameters=',variables('var_parameters'))",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set Parameters Copy 01_H",
											"type": "SetVariable",
											"dependsOn": [],
											"policy": {
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "var_parameters",
												"value": {
													"value": "@if(empty(pipeline().parameters.par_status),\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"initial_date\":\"',variables('var_fecha_ayer_00'),'\",\"final_date\":\"', variables('var_fecha_ayer_23'),'\"}}')\n    ,\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"status\":\"',pipeline().parameters.par_status,'\",\"initial_date\":\"',variables('var_fecha_ayer_00'),'\",\"final_date\":\"', variables('var_fecha_ayer_23'),'\"}}')\n    )",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"value": "INBOUND_HISTORICO",
									"activities": [
										{
											"name": "api_web API FIN_DESCARGA_HIST_COPY_01_copy1",
											"type": "Copy",
											"dependsOn": [
												{
													"activity": "Set URL Complete with Token_01_H_copy1",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"timeout": "0.12:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"source": {
													"type": "RestSource",
													"httpRequestTimeout": "00:01:40",
													"requestInterval": "00.00:00:00.010",
													"requestMethod": "POST",
													"requestBody": "{}"
												},
												"sink": {
													"type": "DelimitedTextSink",
													"storeSettings": {
														"type": "AzureBlobFSWriteSettings"
													},
													"formatSettings": {
														"type": "DelimitedTextWriteSettings",
														"quoteAllText": true,
														"fileExtension": ".txt"
													}
												},
												"enableStaging": false,
												"translator": {
													"type": "TabularTranslator",
													"mappings": [
														{
															"source": {
																"path": "$['source']['location_name']"
															},
															"sink": {
																"name": "location_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['status']"
															},
															"sink": {
																"name": "status",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['date_gi']"
															},
															"sink": {
																"name": "date_gi",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny']"
															},
															"sink": {
																"name": "destiny",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['STAY']['hours']"
															},
															"sink": {
																"name": "hours",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['RAMP_ON']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_RAMP_ON_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENTRANCE']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENTRANCE']['rcontrol']"
															},
															"sink": {
																"name": "rcontrol",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ON_DOWNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ON_DOWNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DOWNLOAD_ON_CUSTOM']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_DOWNLOAD_ON_CUSTOM_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DOWNLOAD_ON_CUSTOM']['user']"
															},
															"sink": {
																"name": "user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['STO']"
															},
															"sink": {
																"name": "STO",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['ramp']"
															},
															"sink": {
																"name": "ramp",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['notes']"
															},
															"sink": {
																"name": "notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['auditor']"
															},
															"sink": {
																"name": "auditor",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['customs']"
															},
															"sink": {
																"name": "customs",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['picking']"
															},
															"sink": {
																"name": "picking",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['coworker']"
															},
															"sink": {
																"name": "coworker",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['number_chep']"
															},
															"sink": {
																"name": "number_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['seal_number']"
															},
															"sink": {
																"name": "seal_number",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['temperature']"
															},
															"sink": {
																"name": "temperature",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['pallets_rack']"
															},
															"sink": {
																"name": "pallets_rack",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['pallets_block']"
															},
															"sink": {
																"name": "pallets_block",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['eco']"
															},
															"sink": {
																"name": "eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['box_type']"
															},
															"sink": {
																"name": "box_type",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['carga_tm']"
															},
															"sink": {
																"name": "carga_tm",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['priority']"
															},
															"sink": {
																"name": "priority",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['company_name']"
															},
															"sink": {
																"name": "company_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['circuit_name']"
															},
															"sink": {
																"name": "circuit_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['type_operation']"
															},
															"sink": {
																"name": "type_operation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['grupo_comercial']"
															},
															"sink": {
																"name": "grupo_comercial",
																"type": "String"
															}
														}
													],
													"collectionReference": ""
												}
											},
											"inputs": [
												{
													"referenceName": "nmex_rest_dataset_api",
													"type": "DatasetReference",
													"parameters": {
														"url_dataset_post_rest_api": {
															"value": "@variables('url_complete')",
															"type": "Expression"
														}
													}
												}
											],
											"outputs": [
												{
													"referenceName": "ds_adsl2_origenesmx_csv",
													"type": "DatasetReference",
													"parameters": {
														"par_directory": {
															"value": "@concat(pipeline().parameters.par_folder,'INBOUND_HISTORICO_ARCHIVOS/',variables('var_final_date'),'/')",
															"type": "Expression"
														},
														"par_filename": {
															"value": "@concat('INBOUND_HISTORICO_01_',pipeline().parameters.par_search_type,'_',variables('date_ext'),'.csv')",
															"type": "Expression"
														},
														"par_delimeter": ","
													}
												}
											]
										},
										{
											"name": "Set URL Complete with Token_01_H_copy1",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "Set Parameters Copy 01_H_copy1",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "url_complete",
												"value": {
													"value": "@concat(pipeline().parameters.par_url_base,pipeline().parameters.par_function,'?token=',activity('web api auth').output.token,'&parameters=',variables('var_parameters'))",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set Parameters Copy 01_H_copy1",
											"type": "SetVariable",
											"dependsOn": [],
											"policy": {
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "var_parameters",
												"value": {
													"value": "@if(empty(pipeline().parameters.par_status),\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"initial_date\":\"',variables('var_fecha_ayer_00'),'\",\"final_date\":\"', variables('var_fecha_ayer_23'),'\"}}')\n    ,\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"status\":\"',pipeline().parameters.par_status,'\",\"initial_date\":\"',variables('var_fecha_ayer_00'),'\",\"final_date\":\"', variables('var_fecha_ayer_23'),'\"}}')\n    )",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Fecha Ayer 00",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Fecha Ayer 23",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "var_fecha_ayer_00",
							"value": {
								"value": "@formatDateTime(adddays(convertTimeZone(utcNow(),'UTC','Central Standard Time (Mexico)'),-1),'yyyy-MM-dd 00:00')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Fecha Ayer 23",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Fecha Hoy_02",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "var_fecha_ayer_23",
							"value": {
								"value": "@formatDateTime(adddays(convertTimeZone(utcNow(),'UTC','Central Standard Time (Mexico)'),-1),'yyyy-MM-dd 23:59')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Fecha 01",
						"description": "Fecha 01 = Fecha Actual - 14 Dias",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "var_fecha_01",
							"value": {
								"value": "@formatDateTime(adddays(convertTimeZone(utcNow(),'UTC','Central Standard Time (Mexico)'),-14),'yyyy-MM-dd 00:00')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Fecha 02",
						"description": "Fecha 02 = Fecha 01 - 14 Dias",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Fecha 01",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "var_fecha_02",
							"value": {
								"value": "@formatDateTime(adddays(variables('var_fecha_01'),-14),'yyyy-MM-dd 00:00')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Fecha 03",
						"description": "Fecha 03 = Hoy",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Fecha 02",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "var_fecha_03",
							"value": {
								"value": "@formatDateTime(adddays(convertTimeZone(utcNow(),'UTC','Central Standard Time (Mexico)'),-1),'yyyy-MM-dd 23:59')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Fecha Hoy",
						"description": "Fecha Hoy = Hoy 23:59",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Fecha 03",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "var_fecha_hoy",
							"value": {
								"value": "@formatDateTime(convertTimeZone(utcNow(),'UTC','Central Standard Time (Mexico)'),'yyyy-MM-dd 00:00')\n\n",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Fecha Hoy_02",
						"description": "Fecha Hoy = Hoy 23:59",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Fecha Hoy",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "var_fecha_hoy_02",
							"value": {
								"value": "@formatDateTime(convertTimeZone(utcNow(),'UTC','Central Standard Time (Mexico)'),'yyyy-MM-dd 23:59')\n\n",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Execute Carga Tablas",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Switch1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_load_tablas_api_inb_out_alice",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"parFechaExec": {
									"value": "@variables('var_final_date')",
									"type": "Expression"
								},
								"parFechaTabla": {
									"value": "@pipeline().parameters.par_tabla",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Send Error Auth",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "web api auth",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_send_email_notification_alice",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"par_conteudo_email": "Ocorreu um Erro na Autenticao da API",
								"par_lista_email": "rafael.medeiros2@br.nestle.com;yair.atristain@mx.nestle.com;Roberto.Fernandez@mx.nestle.com;valeria.camacho1@mx.nestle.com",
								"par_project_name": "ALICE API",
								"par_status_msg": "Error",
								"par_etapa": {
									"value": "@concat('Auth API - ',pipeline().parameters.par_tabla)",
									"type": "Expression"
								},
								"par_fecha": {
									"value": "@variables('var_final_date')",
									"type": "Expression"
								},
								"par_runid": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Send Error Copy",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Switch1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_send_email_notification_alice",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"par_conteudo_email": "Ocorreu um Erro na Copia dos Dados da API",
								"par_lista_email": "rafael.medeiros2@br.nestle.com;yair.atristain@mx.nestle.com;Roberto.Fernandez@mx.nestle.com;valeria.camacho1@mx.nestle.com",
								"par_project_name": "ALICE API",
								"par_status_msg": "Error",
								"par_etapa": {
									"value": "@concat('Copy Data API - ',pipeline().parameters.par_tabla)",
									"type": "Expression"
								},
								"par_fecha": {
									"value": "@variables('var_final_date')",
									"type": "Expression"
								},
								"par_runid": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Send Error Load",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Execute Carga Tablas",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_send_email_notification_alice",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"par_conteudo_email": "Ocorreu um Erro na Carga das Tabelas no Databricks",
								"par_lista_email": "rafael.medeiros2@br.nestle.com;yair.atristain@mx.nestle.com;Roberto.Fernandez@mx.nestle.com;valeria.camacho1@mx.nestle.com",
								"par_project_name": "ALICE API",
								"par_status_msg": "Error",
								"par_etapa": {
									"value": "@concat('Load Tablas API - ',pipeline().parameters.par_tabla)",
									"type": "Expression"
								},
								"par_fecha": {
									"value": "@variables('var_final_date')",
									"type": "Expression"
								},
								"par_runid": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Send Sucesso",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Execute Carga Tablas",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_send_email_notification_alice",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"par_conteudo_email": "Proceso de carga y copia de datos API completado con xito",
								"par_lista_email": "rafael.medeiros2@br.nestle.com;yair.atristain@mx.nestle.com;Roberto.Fernandez@mx.nestle.com;valeria.camacho1@mx.nestle.com",
								"par_project_name": "ALICE API",
								"par_status_msg": "Sucesso",
								"par_etapa": {
									"value": "@concat('Fin Carga API Sucesso - ',pipeline().parameters.par_tabla)",
									"type": "Expression"
								},
								"par_fecha": {
									"value": "@variables('var_final_date')",
									"type": "Expression"
								},
								"par_runid": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"par_search_type": {
						"type": "string",
						"defaultValue": "DESPACHO_REAL"
					},
					"par_url": {
						"type": "string",
						"defaultValue": "https://www.rcontrol.com.mx/rcSuite/GetUserToken?arg00=Origenes02&arg01=Temporal1"
					},
					"par_folder": {
						"type": "string",
						"defaultValue": "/inbound/ext_api_files/"
					},
					"par_url_base": {
						"type": "string",
						"defaultValue": "https://www.rcontrol.com.mx/japi/"
					},
					"par_cont": {
						"type": "string",
						"defaultValue": "dev"
					},
					"par_status": {
						"type": "string"
					},
					"par_function": {
						"type": "string",
						"defaultValue": "get_shipment_info_outb"
					},
					"par_tabla": {
						"type": "string"
					}
				},
				"variables": {
					"var_initial_date": {
						"type": "String"
					},
					"var_final_date": {
						"type": "String"
					},
					"date_ext": {
						"type": "String"
					},
					"var_parameters": {
						"type": "String"
					},
					"url_complete": {
						"type": "String"
					},
					"var_fecha_01": {
						"type": "String"
					},
					"var_fecha_02": {
						"type": "String"
					},
					"var_fecha_03": {
						"type": "String"
					},
					"var_fecha_hoy": {
						"type": "String"
					},
					"var_parameters_02": {
						"type": "String"
					},
					"var_parameters_03": {
						"type": "String"
					},
					"url_complete_02": {
						"type": "String"
					},
					"url_complete_03": {
						"type": "String"
					},
					"var_fecha_hoy_02": {
						"type": "String"
					},
					"var_fecha_ayer_00": {
						"type": "String"
					},
					"var_fecha_ayer_23": {
						"type": "String"
					},
					"teste": {
						"type": "String"
					}
				},
				"folder": {
					"name": "amsmx_supply_alice"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-06T16:03:26Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_extract_merge_files')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get Carpeta",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "ds_adsl2_origenesmx_binary",
								"type": "DatasetReference",
								"parameters": {
									"par_directory": {
										"value": "@pipeline().parameters.parPathCopy",
										"type": "Expression"
									},
									"par_filename": {
										"value": "@pipeline().parameters.parFileNameCopy",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "BinaryReadSettings"
							}
						}
					},
					{
						"name": "Filter Archivos Hoy",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "Get Carpeta",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get Carpeta').output.childItems",
								"type": "Expression"
							},
							"condition": {
								"value": "@and(contains(item().name,pipeline().parameters.parFechaAtual),equals(item().type,'File'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ForEach Copy",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Filter Archivos Hoy",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Filter Archivos Hoy').output.value",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Copy Files Hoy",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "BinarySource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "BinaryReadSettings"
											}
										},
										"sink": {
											"type": "BinarySink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "ds_adsl2_origenesmx_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": {
													"value": "@pipeline().parameters.parPathCopy",
													"type": "Expression"
												},
												"par_filename": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ds_adsl2_origenesmx_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": {
													"value": "@concat(pipeline().parameters.parPathDestination,pipeline().parameters.parFechaAtual,'_',pipeline().parameters.parFileNameTitle)",
													"type": "Expression"
												},
												"par_filename": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Delete Files",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "Copy Files Hoy",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "ds_adsl2_origenesmx_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": {
													"value": "@pipeline().parameters.parPathCopy",
													"type": "Expression"
												},
												"par_filename": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "AzureBlobFSReadSettings",
											"recursive": true,
											"enablePartitionDiscovery": false
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"parFileNameCopy": {
						"type": "string"
					},
					"parPathCopy": {
						"type": "string"
					},
					"parPathDestination": {
						"type": "string"
					},
					"parFileNameTitle": {
						"type": "string"
					},
					"parContainer": {
						"type": "string"
					},
					"parFechaAtual": {
						"type": "string"
					}
				},
				"folder": {
					"name": "amsmx_supply_alice"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-06T16:03:22Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_extract_move_blob_to_blob')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get Carpeta",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "ds_sc_nmex_devorigmx_generic",
								"type": "DatasetReference",
								"parameters": {
									"par_container": {
										"value": "@pipeline().parameters.parContainer",
										"type": "Expression"
									},
									"par_diretorio": {
										"value": "@pipeline().parameters.parPathCopy",
										"type": "Expression"
									},
									"par_arquivo": {
										"value": "@pipeline().parameters.parFileNameCopy",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "BinaryReadSettings"
							}
						}
					},
					{
						"name": "Filter Archivos Hoy",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "Get Carpeta",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get Carpeta').output.childItems",
								"type": "Expression"
							},
							"condition": {
								"value": "@equals(item().type,'File')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ForEach Copy",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Filter Archivos Hoy",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Filter Archivos Hoy').output.value",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Copy Files Hoy",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "BinarySource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "BinaryReadSettings"
											}
										},
										"sink": {
											"type": "BinarySink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "ds_adsl2_origenesmx_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": {
													"value": "@pipeline().parameters.parPathCopy",
													"type": "Expression"
												},
												"par_filename": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ds_adsl2_origenesmx_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": {
													"value": "@concat(pipeline().parameters.parPathDestination,pipeline().parameters.parFechaAtual,'_',pipeline().parameters.parFileNameTitle)",
													"type": "Expression"
												},
												"par_filename": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Delete",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "Copy Files Hoy",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "ds_adsl2_origenesmx_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": {
													"value": "@pipeline().parameters.parPathCopy",
													"type": "Expression"
												},
												"par_filename": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "AzureBlobFSReadSettings",
											"recursive": true,
											"wildcardFileName": {
												"value": "@{item().name}",
												"type": "Expression"
											},
											"enablePartitionDiscovery": false
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"parFileNameCopy": {
						"type": "string"
					},
					"parPathCopy": {
						"type": "string"
					},
					"parPathDestination": {
						"type": "string"
					},
					"parFileNameTitle": {
						"type": "string"
					},
					"parContainer": {
						"type": "string"
					},
					"parFechaAtual": {
						"type": "string"
					}
				},
				"folder": {
					"name": "amsmx_supply_alice"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-06T16:03:23Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_extract_move_blob_to_blob_filter')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get Metadata Alice",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "ds_adsl2_origenesmx_binary",
								"type": "DatasetReference",
								"parameters": {
									"par_directory": {
										"value": "@pipeline().parameters.parPathCopy",
										"type": "Expression"
									},
									"par_filename": {
										"value": "@pipeline().parameters.parFolderName",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "BinaryReadSettings"
							}
						}
					},
					{
						"name": "ForEach Folders",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Filter Folder",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Filter Folder').output.value",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Get Metadata Inside Folder",
									"type": "GetMetadata",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "ds_adsl2_origenesmx_binary_source",
											"type": "DatasetReference",
											"parameters": {
												"parContName": {
													"value": "@pipeline().parameters.parContName",
													"type": "Expression"
												},
												"parPathCopy": {
													"value": "@concat(pipeline().parameters.parPathCopy,item().name)",
													"type": "Expression"
												}
											}
										},
										"fieldList": [
											"childItems",
											"itemName"
										],
										"storeSettings": {
											"type": "AzureBlobFSReadSettings",
											"recursive": true,
											"enablePartitionDiscovery": false
										},
										"formatSettings": {
											"type": "BinaryReadSettings"
										}
									}
								},
								{
									"name": "Copy Folder Content",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Get Metadata Inside Folder",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "BinarySource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"wildcardFolderPath": {
													"value": "@concat(pipeline().parameters.parPathCopy,item().name)",
													"type": "Expression"
												},
												"wildcardFileName": "*",
												"deleteFilesAfterCompletion": false
											},
											"formatSettings": {
												"type": "BinaryReadSettings"
											}
										},
										"sink": {
											"type": "BinarySink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "ds_adsl2_origenesmx_binary_source",
											"type": "DatasetReference",
											"parameters": {
												"parContName": {
													"value": "@pipeline().parameters.parContName",
													"type": "Expression"
												},
												"parPathCopy": {
													"value": "@pipeline().parameters.parPathCopy",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ds_adsl2_origenesmx_binary_sink",
											"type": "DatasetReference",
											"parameters": {
												"parContName": {
													"value": "@pipeline().parameters.parContName",
													"type": "Expression"
												},
												"parPathDestination": {
													"value": "@concat(pipeline().parameters.parPathDestination,'/',item().name)",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Delete Files and Folders",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "Copy Folder Content",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "ds_adsl2_origenesmx_binary_source",
											"type": "DatasetReference",
											"parameters": {
												"parContName": {
													"value": "@pipeline().parameters.parContName",
													"type": "Expression"
												},
												"parPathCopy": {
													"value": "@{concat(pipeline().parameters.parPathCopy,item().name)}",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "AzureBlobFSReadSettings",
											"recursive": true,
											"enablePartitionDiscovery": false
										}
									}
								}
							]
						}
					},
					{
						"name": "Filter Folder",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "Get Metadata Alice",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get Metadata Alice').output.childItems",
								"type": "Expression"
							},
							"condition": {
								"value": "@equals(item().type,'Folder')",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"parFolderName": {
						"type": "string"
					},
					"parContName": {
						"type": "string"
					},
					"parPathCopy": {
						"type": "string"
					},
					"parPathDestination": {
						"type": "string"
					}
				},
				"variables": {
					"varFiles30Days": {
						"type": "String"
					},
					"varReferenceDate": {
						"type": "String",
						"defaultValue": "1900-01-01 00:00:00"
					}
				},
				"folder": {
					"name": "amsmx_supply_alice"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-06T16:03:24Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_extract_move_to_csv_reference')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "View Archivo Parametro",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Get Fecha Actual",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"dataset": {
								"referenceName": "ds_adsl2_origenesmx_csv",
								"type": "DatasetReference",
								"parameters": {
									"par_directory": "inbound/alice/alice_config",
									"par_filename": "LX03_ARCHIVOS_LIST.csv",
									"par_delimeter": ","
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Get Fecha Actual",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "varFechaAtual",
							"value": {
								"value": "@formatDateTime(utcnow(),'yyyyMMdd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "View Archivo Parametro",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('View Archivo Parametro').output.value",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Copy data1",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "BinarySource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "BinaryReadSettings"
											}
										},
										"sink": {
											"type": "BinarySink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "ds_adsl2_origenesmx_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": "inbound/alice",
												"par_filename": {
													"value": "@concat(item().nombre_archivo,variables('varFechaAtual'),'.csv')",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ds_adsl2_origenesmx_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": {
													"value": "@concat('inbound/alice/',variables('varFechaAtual'),'_LX03')",
													"type": "Expression"
												},
												"par_filename": {
													"value": "@concat(item().nombre_archivo,variables('varFechaAtual'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"varFilesCopy": {
						"type": "Array"
					},
					"varFilesNameCopy": {
						"type": "Array"
					},
					"varFechaAtual": {
						"type": "String"
					},
					"varArrayNombreAndFecha": {
						"type": "Array"
					}
				},
				"folder": {
					"name": "amsmx_supply_alice"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-06T16:03:24Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_extract_p_ic3')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "IC3 to DataLake",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Variavel UTC",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "IC3_SQL_TO_LAKE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_adsl2_origenesmx_csv",
								"type": "DatasetReference",
								"parameters": {
									"par_directory": {
										"value": "@concat('inbound/credit_notes/files_ic3/',variables('varUTCNow'))",
										"type": "Expression"
									},
									"par_filename": {
										"value": "@concat('ic3_',variables('varUTCNow'),'.csv')",
										"type": "Expression"
									},
									"par_delimeter": ","
								}
							}
						]
					},
					{
						"name": "Variavel UTC",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "varUTCNow",
							"value": {
								"value": "@utcnow()",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Carga Bronze IC3",
						"type": "DatabricksNotebook",
						"dependsOn": [
							{
								"activity": "IC3 to DataLake",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebookPath": "/Users/rafael.medeiros2@br.nestle.com/sl_creditnotes_tipification/01_inbound_ic3",
							"baseParameters": {
								"parArchivoNombreAtual": {
									"value": "@concat('ic3_',variables('varUTCNow'),'.csv')",
									"type": "Expression"
								},
								"parDateTimeUTC": {
									"value": "@variables('varUTCNow')",
									"type": "Expression"
								},
								"parPathFull": {
									"value": "@concat(variables('varUTCNow'),'/ic3_',variables('varUTCNow'),'.csv')",
									"type": "Expression"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "lk_nmex_dv_origenesmx_id_usw2_dbr",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"varUTCNow": {
						"type": "String"
					}
				},
				"folder": {
					"name": "amsmx_finance_creditnotes"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-06T16:03:24Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_load_data')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "List Inbound Files",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "ds_adsl2_origenesmx_binary",
								"type": "DatasetReference",
								"parameters": {
									"par_directory": "inbound/fact/ndg",
									"par_filename": " "
								}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "BinaryReadSettings"
							}
						}
					},
					{
						"name": "Load Silver Layer",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "List Inbound Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('List Inbound Files').output.childItems",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Load CSV into Silver Layer",
									"description": "Notebook that processes each CSV file found in the Inbound folder and load the data in the Silver Data Layer",
									"type": "DatabricksNotebook",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"notebookPath": "/Repos/ricardo.perez1@mx.nestle.com/DatabricksMX/sl_ndg/fact/fact_master_plan/execution/0010_ndg_fact_master_plan_load_silver_layer",
										"baseParameters": {
											"adf_csvFile": {
												"value": "@item().name",
												"type": "Expression"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "lk_nmex_dv_origenesmx_id_usw2_dbr",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Catch Error Loading CSV",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Load CSV into Silver Layer",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "ErrorMessage",
										"value": {
											"value": "@activity('Load CSV into Silver Layer').Error.Message",
											"type": "Expression"
										}
									}
								}
							]
						}
					},
					{
						"name": "Catch Error Listing Files",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "List Inbound Files",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "ErrorMessage",
							"value": {
								"value": "@activity('List Inbound Files').Error.Message",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Catch Error Load Silver Layer",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Load Silver Layer",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "ErrorMessage",
							"value": {
								"value": "@activity('Load Silver Layer').Error.Message",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Load Gold Layer",
						"type": "DatabricksNotebook",
						"dependsOn": [
							{
								"activity": "Load Silver Layer",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebookPath": "/Repos/ricardo.perez1@mx.nestle.com/DatabricksMX/sl_ndg/fact/fact_master_plan/execution/0020_ndg_fact_master_plan_load_gold_layer"
						},
						"linkedServiceName": {
							"referenceName": "lk_nmex_dv_origenesmx_id_usw2_dbr",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Catch Error Load Gold Layer",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Load Gold Layer",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "ErrorMessage",
							"value": {
								"value": "@activity('Load Gold Layer').Error.Message",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"ErrorMessage": {
						"type": "String"
					}
				},
				"folder": {
					"name": "amsmx_ndg"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-06T16:03:23Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_load_silver_layer_bck')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Load Silver Layer",
						"type": "DatabricksNotebook",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebookPath": "/Repos/ricardo.perez1@mx.nestle.com/DatabricksMX/sl_ndg/fact/fact_master_plan/execution/0010_ndg_fact_master_plan_load_silver_layer",
							"baseParameters": {
								"adf_csvFile": {
									"value": "@activity('List Inbound Files').output.childItems[0].name",
									"type": "Expression"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "lk_nmex_dv_origenesmx_id_usw2_dbr",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "List Inbound Files",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "ds_adsl2_origenesmx_binary",
								"type": "DatasetReference",
								"parameters": {
									"par_directory": "inbound/fact/ndg",
									"par_filename": " "
								}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "BinaryReadSettings"
							}
						}
					},
					{
						"name": "Archive Inbound Files",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Load Silver Layer",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": false,
									"deleteFilesAfterCompletion": true
								},
								"formatSettings": {
									"type": "BinaryReadSettings"
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "ds_adsl2_origenesmx_binary",
								"type": "DatasetReference",
								"parameters": {
									"par_directory": "inbound/fact/ndg",
									"par_filename": "@activity('List Inbound Files').output.childItems[0].name"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_adsl2_origenesmx_binary",
								"type": "DatasetReference",
								"parameters": {
									"par_directory": "archive/fact/ndg",
									"par_filename": "@activity('List Inbound Files').output.childItems[0].name"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "amsmx_ndg"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-06T16:03:23Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_load_silver_lyr')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "List Inbound Files",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "ds_adsl2_origenesmx_binary",
								"type": "DatasetReference",
								"parameters": {
									"par_directory": "inbound/fact/ndg",
									"par_filename": " "
								}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "BinaryReadSettings"
							}
						}
					},
					{
						"name": "Load All Inbound Files",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "List Inbound Files",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('List Inbound Files').output.childItems",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Load Silver Layer",
									"description": "Notebook that processes each CSV file found in the Inbound folder and load the data in the Silver Data Layer",
									"type": "DatabricksNotebook",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"notebookPath": "/Repos/ricardo.perez1@mx.nestle.com/DatabricksMX/sl_ndg/fact/fact_master_plan/execution/0010_ndg_fact_master_plan_load_silver_layer",
										"baseParameters": {
											"adf_csvFile": {
												"value": "@item().name",
												"type": "Expression"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "lk_nmex_dv_origenesmx_id_usw2_dbr",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Catch Error Loading Silver Layer",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Load Silver Layer",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "ErrorMessage",
										"value": {
											"value": "@activity('Load Silver Layer').Error.Message",
											"type": "Expression"
										}
									}
								}
							]
						}
					},
					{
						"name": "Catch Error Listing Files",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "List Inbound Files",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "ErrorMessage",
							"value": {
								"value": "@activity('List Inbound Files').Error.Message",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"ErrorMessage": {
						"type": "String"
					}
				},
				"folder": {
					"name": "amsmx_ndg"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-06T16:03:23Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_load_tablas_notebook_alice')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Switch Table Load",
						"type": "Switch",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"on": {
								"value": "@pipeline().parameters.parTableName",
								"type": "Expression"
							},
							"cases": [
								{
									"value": "lx03",
									"activities": [
										{
											"name": "Load LX03",
											"type": "ExecutePipeline",
											"dependsOn": [],
											"userProperties": [],
											"typeProperties": {
												"pipeline": {
													"referenceName": "pl_common_tabla_lx03",
													"type": "PipelineReference"
												},
												"waitOnCompletion": true,
												"parameters": {
													"parFechaAtual_Carga": {
														"value": "@pipeline().parameters.parFechaAtual_Carga",
														"type": "Expression"
													}
												}
											}
										}
									]
								},
								{
									"value": "lt23",
									"activities": [
										{
											"name": "Load LT23",
											"type": "ExecutePipeline",
											"dependsOn": [],
											"userProperties": [],
											"typeProperties": {
												"pipeline": {
													"referenceName": "pl_common_tabla_lt23",
													"type": "PipelineReference"
												},
												"waitOnCompletion": true,
												"parameters": {
													"parFechaAtual_Carga": {
														"value": "@pipeline().parameters.parFechaAtual_Carga",
														"type": "Expression"
													}
												}
											}
										}
									]
								},
								{
									"value": "otr",
									"activities": [
										{
											"name": "Load OTR",
											"type": "ExecutePipeline",
											"dependsOn": [],
											"userProperties": [],
											"typeProperties": {
												"pipeline": {
													"referenceName": "pl_common_tabla_otr",
													"type": "PipelineReference"
												},
												"waitOnCompletion": true,
												"parameters": {
													"parFechaAtual_Carga": {
														"value": "@pipeline().parameters.parFechaAtual_Carga",
														"type": "Expression"
													}
												}
											}
										}
									]
								},
								{
									"value": "contabilizado",
									"activities": [
										{
											"name": "Load OTR Contabilizado",
											"type": "ExecutePipeline",
											"dependsOn": [],
											"userProperties": [],
											"typeProperties": {
												"pipeline": {
													"referenceName": "pl_common_tabla_otr_contabilizado",
													"type": "PipelineReference"
												},
												"waitOnCompletion": true,
												"parameters": {
													"parFechaAtual_Carga": {
														"value": "@pipeline().parameters.parFechaAtual_Carga",
														"type": "Expression"
													}
												}
											}
										}
									]
								},
								{
									"value": "mb5t",
									"activities": [
										{
											"name": "Load MB5T",
											"type": "ExecutePipeline",
											"dependsOn": [],
											"userProperties": [],
											"typeProperties": {
												"pipeline": {
													"referenceName": "pl_common_tabla_mb5t",
													"type": "PipelineReference"
												},
												"waitOnCompletion": true,
												"parameters": {
													"parFechaAtual_Carga": {
														"value": "@pipeline().parameters.parFechaAtual_Carga",
														"type": "Expression"
													}
												}
											}
										}
									]
								},
								{
									"value": "me2n",
									"activities": [
										{
											"name": "Load ME2N",
											"type": "ExecutePipeline",
											"dependsOn": [],
											"userProperties": [],
											"typeProperties": {
												"pipeline": {
													"referenceName": "pl_common_tabla_me2n",
													"type": "PipelineReference"
												},
												"waitOnCompletion": true,
												"parameters": {
													"parFechaAtual_Carga": {
														"value": "@pipeline().parameters.parFechaAtual_Carga",
														"type": "Expression"
													}
												}
											}
										}
									]
								},
								{
									"value": "vl06f_nac",
									"activities": [
										{
											"name": "Load VL06F_NAC",
											"type": "ExecutePipeline",
											"dependsOn": [],
											"userProperties": [],
											"typeProperties": {
												"pipeline": {
													"referenceName": "pl_common_tabla_vl06f_nac",
													"type": "PipelineReference"
												},
												"waitOnCompletion": true,
												"parameters": {
													"parFechaAtual_Carga": {
														"value": "@pipeline().parameters.parFechaAtual_Carga",
														"type": "Expression"
													}
												}
											}
										}
									]
								},
								{
									"value": "vl06f_con",
									"activities": [
										{
											"name": "Load VL06F_CON",
											"type": "ExecutePipeline",
											"dependsOn": [],
											"userProperties": [],
											"typeProperties": {
												"pipeline": {
													"referenceName": "pl_common_tabla_vl06f_con",
													"type": "PipelineReference"
												},
												"waitOnCompletion": true,
												"parameters": {
													"parFechaAtual_Carga": {
														"value": "@pipeline().parameters.parFechaAtual_Carga",
														"type": "Expression"
													}
												}
											}
										}
									]
								},
								{
									"value": "atp",
									"activities": [
										{
											"name": "Load ATP",
											"type": "ExecutePipeline",
											"dependsOn": [],
											"userProperties": [],
											"typeProperties": {
												"pipeline": {
													"referenceName": "pl_common_tabla_atp",
													"type": "PipelineReference"
												},
												"waitOnCompletion": true,
												"parameters": {
													"parFechaAtual_Carga": {
														"value": "@pipeline().parameters.parFechaAtual_Carga",
														"type": "Expression"
													}
												}
											}
										}
									]
								},
								{
									"value": "trm_log",
									"activities": [
										{
											"name": "Load TRM_LOG",
											"type": "ExecutePipeline",
											"dependsOn": [],
											"userProperties": [],
											"typeProperties": {
												"pipeline": {
													"referenceName": "pl_common_tabla_trm_log",
													"type": "PipelineReference"
												},
												"waitOnCompletion": true,
												"parameters": {
													"parFechaAtual_Carga": {
														"value": "@pipeline().parameters.parFechaAtual_Carga",
														"type": "Expression"
													}
												}
											}
										}
									]
								},
								{
									"value": "me80fn",
									"activities": [
										{
											"name": "Load ME80FN",
											"type": "ExecutePipeline",
											"dependsOn": [],
											"userProperties": [],
											"typeProperties": {
												"pipeline": {
													"referenceName": "pl_common_tabla_me80fn",
													"type": "PipelineReference"
												},
												"waitOnCompletion": true,
												"parameters": {
													"parFechaAtual_Carga": {
														"value": "@pipeline().parameters.parFechaAtual_Carga",
														"type": "Expression"
													}
												}
											}
										}
									]
								},
								{
									"value": "ageing",
									"activities": [
										{
											"name": "Load AGEING",
											"type": "ExecutePipeline",
											"dependsOn": [],
											"userProperties": [],
											"typeProperties": {
												"pipeline": {
													"referenceName": "pl_common_tabla_ageing",
													"type": "PipelineReference"
												},
												"waitOnCompletion": true,
												"parameters": {
													"parFechaAtual_Carga": {
														"value": "@pipeline().parameters.parFechaAtual_Carga",
														"type": "Expression"
													}
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"parFechaAtual_Carga": {
						"type": "string"
					},
					"parTableName": {
						"type": "string"
					}
				},
				"variables": {
					"varPathNotebook": {
						"type": "String"
					}
				},
				"folder": {
					"name": "amsmx_supply_alice"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-06T16:03:26Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_mayoreodigital')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy_ore",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "SftpReadSettings",
									"recursive": false,
									"deleteFilesAfterCompletion": false,
									"disableChunking": false
								},
								"formatSettings": {
									"type": "BinaryReadSettings"
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_ore",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DestinationDataset_ore",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "HugogallardoTestingtbMayoreoDigitalLiquidaciones",
						"type": "DatabricksNotebook",
						"dependsOn": [
							{
								"activity": "Copy_ore",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebookPath": "/Repos/hugo.gallardo@mx.nestle.com/DatabricksMX/sl_mayoreodigital/execution/hugogallardo.MayoreoDigital.26072022"
						},
						"linkedServiceName": {
							"referenceName": "lk_nmex_dv_origenesmx_id_usw2_dbr",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "amsmx_mayoreodigital"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-06T16:03:20Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_proceso_liquidaciones')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Upload MayoreoDigital Liquidaciones",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "SftpReadSettings",
									"recursive": true,
									"disableChunking": false
								},
								"formatSettings": {
									"type": "BinaryReadSettings"
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_ore",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DestinationDataset_ore",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "HugogallardoTestingtbMayoreoDigitalLiquidaciones",
						"type": "DatabricksNotebook",
						"dependsOn": [
							{
								"activity": "Upload MayoreoDigital Liquidaciones",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebookPath": "/Repos/hugo.gallardo@mx.nestle.com/DatabricksMX/sl_mayoreodigital/execution/hugogallardo.MayoreoDigital.26072022"
						},
						"linkedServiceName": {
							"referenceName": "lk_nmex_dv_origenesmx_id_usw2_dbr",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "amsmx_mayoreodigital"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-06T16:03:20Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_proceso_productos')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy Cat Productos",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "SftpReadSettings",
									"recursive": true,
									"disableChunking": false
								},
								"formatSettings": {
									"type": "BinaryReadSettings"
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "SourceDataSetProductos",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DestinationProductos",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "tb_Productos_Load_Notebook",
						"type": "DatabricksNotebook",
						"dependsOn": [
							{
								"activity": "Copy Cat Productos",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebookPath": "/Repos/hugo.gallardo@mx.nestle.com/DatabricksMX/sl_mayoreodigital/execution/hugogallardo.MayoreoDigital.Productos.03082022"
						},
						"linkedServiceName": {
							"referenceName": "lk_nmex_dv_origenesmx_id_usw2_dbr",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "amsmx_mayoreodigital"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-06T16:03:21Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_sales_refresh_power_bi')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get ADF_parameters_sharepoint",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"dataset": {
								"referenceName": "ds_adls_datascience_csv",
								"type": "DatasetReference",
								"parameters": {
									"par_directory": "datastore/sales/adf_parameters/",
									"par_filename": "ADF_parameters_sharepoint.csv",
									"par_delimiter": ",",
									"par_encoding": "UTF-8",
									"par_header": true
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach look up value",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Get ADF_parameters_sharepoint",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get ADF_parameters_sharepoint').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "If Condition1",
									"type": "IfCondition",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"expression": {
											"value": "@equals(item().blob_filename,pipeline().parameters.par_blob_filename)",
											"type": "Expression"
										},
										"ifTrueActivities": [
											{
												"name": "Execute Pipeline Power BI refresh",
												"type": "ExecutePipeline",
												"dependsOn": [
													{
														"activity": "Set variable workspace_id",
														"dependencyConditions": [
															"Succeeded"
														]
													},
													{
														"activity": "Set variable dataset_id",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"userProperties": [],
												"typeProperties": {
													"pipeline": {
														"referenceName": "pl_common_generic_refresh_power_bi_dataset",
														"type": "PipelineReference"
													},
													"waitOnCompletion": true,
													"parameters": {
														"par_id_workspace": {
															"value": "@variables('var_workspace_id')",
															"type": "Expression"
														},
														"par_id_dataset": {
															"value": "@variables('var_dataset_id')",
															"type": "Expression"
														}
													}
												}
											},
											{
												"name": "Set variable workspace_id",
												"type": "SetVariable",
												"dependsOn": [],
												"policy": {
													"secureOutput": false,
													"secureInput": false
												},
												"userProperties": [],
												"typeProperties": {
													"variableName": "var_workspace_id",
													"value": {
														"value": "@string(item().workspace_id)",
														"type": "Expression"
													}
												}
											},
											{
												"name": "Set variable dataset_id",
												"type": "SetVariable",
												"dependsOn": [],
												"policy": {
													"secureOutput": false,
													"secureInput": false
												},
												"userProperties": [],
												"typeProperties": {
													"variableName": "var_dataset_id",
													"value": {
														"value": "@string(item().dataset_id)",
														"type": "Expression"
													}
												}
											}
										]
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"par_blob_filename": {
						"type": "string"
					},
					"par_blob_path": {
						"type": "string"
					}
				},
				"variables": {
					"var_workspace_id": {
						"type": "String"
					},
					"var_dataset_id": {
						"type": "String"
					}
				},
				"folder": {
					"name": "amsmx_sales"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-06T16:03:20Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/tr_ai_cloud')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "pl_sales_ai_cloud",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Week",
						"interval": 1,
						"startTime": "2023-01-31T14:29:00",
						"timeZone": "Central Standard Time (Mexico)",
						"schedule": {
							"minutes": [
								1
							],
							"hours": [
								21
							],
							"weekDays": [
								"Monday"
							]
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/tr_catalogo_geografico')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Trigger que se activa cuando se sube el catalogo geografico",
				"annotations": [],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "pl_sales_catalogo_geografico",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "BlobEventsTrigger",
				"typeProperties": {
					"blobPathBeginsWith": "/datascience/blobs/datastore/sales/catalogos/",
					"blobPathEndsWith": "Cat_Geo.csv",
					"ignoreEmptyBlobs": true,
					"scope": "[parameters('tr_catalogo_geografico_properties_typeProperties_scope')]",
					"events": [
						"Microsoft.Storage.BlobCreated"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/tr_connection_catalog')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Trigger que ejecuta cada que el catalogo de conexiones entre SO, SI y exhibiciones se actualiza",
				"annotations": [],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "pl_sales_catalog_connection",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "BlobEventsTrigger",
				"typeProperties": {
					"blobPathBeginsWith": "/datascience/blobs/datastore/sales/walmart/catalogos",
					"blobPathEndsWith": "catalogo_final_walmart.xlsx",
					"ignoreEmptyBlobs": true,
					"scope": "[parameters('tr_connection_catalog_properties_typeProperties_scope')]",
					"events": [
						"Microsoft.Storage.BlobCreated"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/tr_dispersiones')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Trigger que desencadena cuando se agrega el csv de la base fria",
				"annotations": [],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "pl_sales_dispersiones",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "BlobEventsTrigger",
				"typeProperties": {
					"blobPathBeginsWith": "/datascience/blobs/datastore/sales/dispersiones/",
					"blobPathEndsWith": "BF.csv",
					"ignoreEmptyBlobs": true,
					"scope": "[parameters('tr_dispersiones_properties_typeProperties_scope')]",
					"events": [
						"Microsoft.Storage.BlobCreated"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/tr_ecomm')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "pl_sales_ecomm",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "BlobEventsTrigger",
				"typeProperties": {
					"blobPathBeginsWith": "/datascience/blobs/datastore/sales/walmart/e-commerce/",
					"blobPathEndsWith": "BASE_MWB_2021vs2022.csv",
					"ignoreEmptyBlobs": true,
					"scope": "[parameters('tr_ecomm_properties_typeProperties_scope')]",
					"events": [
						"Microsoft.Storage.BlobCreated"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/tr_kf')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "pl_sales_kf",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "BlobEventsTrigger",
				"typeProperties": {
					"blobPathBeginsWith": "/datascience/blobs/datastore/sales/sabanas/kf",
					"blobPathEndsWith": "kf.csv",
					"ignoreEmptyBlobs": true,
					"scope": "[parameters('tr_kf_properties_typeProperties_scope')]",
					"events": [
						"Microsoft.Storage.BlobCreated"
					]
				}
			},
			"dependsOn": []
		}
	]
}