{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Nombre de instancia de Data Factory",
			"defaultValue": "nmex-dv-origmx-dh-usw2-adf"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/pl_API_drivin_historico')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"dataset": {
								"referenceName": "DelimitedText1",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Set variable1",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "start_date",
										"value": {
											"value": "@item().Prop_0",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set variable2",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Set variable1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "start_date",
										"value": {
											"value": "@item().Prop_1",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set variable3",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Set variable2",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "key_provider",
										"value": {
											"value": "@item().Prop_2",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Notebook1",
									"type": "DatabricksNotebook",
									"dependsOn": [
										{
											"activity": "Set variable3",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"notebookPath": "/Repos/valeria.camacho1@mx.nestle.com/DatabricksMX/sl_ncdt/sl_Driv_In_API/Rutas de un Escenario/DRIVINAPI",
										"baseParameters": {
											"end_date": {
												"value": "@variables('start_date')",
												"type": "Expression"
											},
											"key_provider": {
												"value": "@variables('key_provider')",
												"type": "Expression"
											},
											"startdate": {
												"value": "@variables('start_date')",
												"type": "Expression"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "lk_nmex_dv_origenesmx_id_usw2_dbr",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"start_date": {
						"type": "String"
					},
					"end_date": {
						"type": "String"
					},
					"key_provider": {
						"type": "String"
					},
					"validator": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2023-05-30T18:47:53Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_afs_npp')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy AFS",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings",
									"maxConcurrentConnections": 0
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "AFS_Monitoring",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Dev_AFS_Prod",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "amsmx_veterinarios"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_common_extract_log_register')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Move Log Orig to External",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Exporta Log File",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "BinaryReadSettings"
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "ds_adsl2_origenesmx_binary",
								"type": "DatasetReference",
								"parameters": {
									"par_directory": "inbound/credit_notes/files_log",
									"par_filename": "pl_master_tipification_to_lake.csv"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_adsl2_extdata_binary",
								"type": "DatasetReference",
								"parameters": {
									"par_directory": "export_log_tipification",
									"par_filename": "pl_master_tipification_to_lake.csv"
								}
							}
						]
					},
					{
						"name": "Exporta Log File",
						"type": "DatabricksNotebook",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebookPath": "/Users/rafael.medeiros2@br.nestle.com/sl_creditnotes_tipification/07_export_log"
						},
						"linkedServiceName": {
							"referenceName": "lk_nmex_dv_origenesmx_id_usw2_dbr",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "amsmx_finance_creditnotes"
				},
				"annotations": [],
				"lastPublishTime": "2023-01-16T21:13:47Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_common_generic_api_login')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get ADF_parameters_apis_login",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"dataset": {
								"referenceName": "ds_adls_datascience_csv",
								"type": "DatasetReference",
								"parameters": {
									"par_directory": "datastore/sales/adf_parameters/",
									"par_filename": "ADF_parameters_mayoreo_apis_login.csv",
									"par_delimiter": ",",
									"par_encoding": "UTF-8",
									"par_header": true
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Filter ADF_parameters_apis_login",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "Get ADF_parameters_apis_login",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get ADF_parameters_apis_login').output.value",
								"type": "Expression"
							},
							"condition": {
								"value": "@equals(string(item().retailer),pipeline().parameters.par_retailer)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Web Login",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Filter ADF_parameters_apis_login",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@activity('Filter ADF_parameters_apis_login').output.value[0]['url']",
								"type": "Expression"
							},
							"method": "POST",
							"headers": {},
							"body": {
								"value": "@concat('{ \"username\":\"',activity('Filter ADF_parameters_apis_login').output.value[0]['username'],'\", \"password\": \"',activity('Filter ADF_parameters_apis_login').output.value[0]['password'],'\" }')",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"par_retailer": {
						"type": "string"
					}
				},
				"variables": {
					"var_test": {
						"type": "String"
					}
				},
				"folder": {
					"name": "amsmx_sales/amsmx_common_db"
				},
				"annotations": [],
				"lastPublishTime": "2023-06-12T15:04:36Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_common_generic_parquet_copy')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get ADF_parameters_parquets",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"dataset": {
								"referenceName": "ds_adls_datascience_csv",
								"type": "DatasetReference",
								"parameters": {
									"par_directory": "datastore/sales/adf_parameters/",
									"par_filename": "ADF_parameters_parquets.csv",
									"par_delimiter": ",",
									"par_encoding": "UTF-8",
									"par_header": true
								}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Filter ADF_parameters_parquet",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "Get ADF_parameters_parquets",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get ADF_parameters_parquets').output.value",
								"type": "Expression"
							},
							"condition": {
								"value": "@equals(string(item().db_sol_path),pipeline().parameters.par_db_sol_path)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Parquet Generic Notebook",
						"type": "DatabricksNotebook",
						"dependsOn": [
							{
								"activity": "Filter ADF_parameters_parquet",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebookPath": "/Repos/Production/DatabricksMX/sl_common_data_tool/execution/0010.Exec_Copy_Last_Version_Parquets",
							"baseParameters": {
								"parPath": {
									"value": "@concat(activity('Filter ADF_parameters_parquet').output.value[0]['path'],activity('Filter ADF_parameters_parquet').output.value[0]['tb_name'])",
									"type": "Expression"
								},
								"parPathlv": {
									"value": "@concat(activity('Filter ADF_parameters_parquet').output.value[0]['path_lv'],activity('Filter ADF_parameters_parquet').output.value[0]['tb_name'])",
									"type": "Expression"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "lk_nmex_dv_origenesmx_id_usw2_dbr",
							"type": "LinkedServiceReference",
							"parameters": {
								"par_cluster": "0130-211945-mcv1mi12"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"par_db_sol_path": {
						"type": "string"
					}
				},
				"folder": {
					"name": "amsmx_sales/amsmx_common_db"
				},
				"annotations": [],
				"lastPublishTime": "2023-06-12T19:45:47Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_common_load_extract_tipification')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Move DataLake Orig to External",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "BinaryReadSettings"
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "ds_adsl2_origenesmx_binary",
								"type": "DatasetReference",
								"parameters": {
									"par_directory": "datasets/credit_notes/dataset_tipification/file_tipification_output",
									"par_filename": "Tipification_Trabajo.xlsx"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_adsl2_extdata_binary",
								"type": "DatasetReference",
								"parameters": {
									"par_directory": "export_trabajo_tipification",
									"par_filename": "Tipification_Trabajo.xlsx"
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "amsmx_finance_creditnotes"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-12T22:29:01Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_common_shp')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Copy files of any size from SharePoint  to Data Lake, including copy all files matching a startswith condition of a folder and files modified in the last x hours.\n\nTo use this pipeline you need to have the sharepoint client id and secret id registered in the dedicated sharepoint key vault",
				"activities": [
					{
						"name": "ForEachFile",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "FilterFiles",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('FilterFiles').output.Value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Copy File",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Filename Copy",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "BinarySource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET",
												"additionalHeaders": {
													"value": "@{concat('Authorization: Bearer ', activity('GetSharepointBearerToken').output.access_token)}",
													"type": "Expression"
												},
												"requestTimeout": ""
											},
											"formatSettings": {
												"type": "BinaryReadSettings"
											}
										},
										"sink": {
											"type": "BinarySink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "ds_ar_rest_shp_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_Url": {
													"value": "@concat(pipeline().parameters.parShpSiteUrl,'/_api/web/GetFileByServerRelativeUrl(''',replace(pipeline().parameters.parShpSiteUrl,'https://nestle.sharepoint.com',''),pipeline().parameters.parShpRelativeFolderPath,'/',pipeline().parameters.parFileName,''')/$value')",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ds_adsl2_origenesmx_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": {
													"value": "@pipeline().parameters.parAdlsDestinationFolder",
													"type": "Expression"
												},
												"par_filename": {
													"value": "@pipeline().parameters.parFileName",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Filename Copy",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "var_File_NameOut",
										"value": {
											"value": "@pipeline().parameters.parFileName",
											"type": "Expression"
										}
									}
								}
							]
						}
					},
					{
						"name": "GetShpClientId",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": true,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@pipeline().parameters.parClientID",
								"type": "Expression"
							},
							"method": "GET",
							"headers": {},
							"authentication": {
								"type": "MSI",
								"resource": "https://vault.azure.net"
							}
						}
					},
					{
						"name": "GetShpSecret",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": true,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@pipeline().parameters.parClientSecret",
								"type": "Expression"
							},
							"method": "GET",
							"headers": {},
							"authentication": {
								"type": "MSI",
								"resource": "https://vault.azure.net"
							}
						}
					},
					{
						"name": "ReadSharepointFolder",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "GetSharepointBearerToken",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": true
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@concat(pipeline().parameters.parShpSiteUrl,'/_api/web/GetFolderByServerRelativeUrl(''',replace(pipeline().parameters.parShpSiteUrl,'https://nestle.sharepoint.com',''),'/',pipeline().parameters.parShpRelativeFolderPath,''')/Files')",
								"type": "Expression"
							},
							"method": "GET",
							"headers": {
								"Authorization": {
									"value": "@{concat('Bearer ', activity('GetSharepointBearerToken').output.access_token)}",
									"type": "Expression"
								},
								"Accept": "application/json;odata=verbose"
							}
						}
					},
					{
						"name": "GetSharepointBearerToken",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "GetShpClientId",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "GetShpSecret",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": true,
							"secureInput": true
						},
						"userProperties": [],
						"typeProperties": {
							"url": "https://accounts.accesscontrol.windows.net/12a3af23-a769-4654-847f-958f3d479f4a/tokens/OAuth/2",
							"method": "POST",
							"headers": {
								"Content-Type": "application/x-www-form-urlencoded"
							},
							"body": {
								"value": "@concat('grant_type=client_credentials&client_id=',uriComponent(activity('GetShpClientId').output.value),'@12a3af23-a769-4654-847f-958f3d479f4a&client_secret=',uriComponent(activity('GetShpSecret').output.value),'&resource=00000003-0000-0ff1-ce00-000000000000/nestle.sharepoint.com@12a3af23-a769-4654-847f-958f3d479f4a')\n",
								"type": "Expression"
							}
						}
					},
					{
						"name": "FilterFiles",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "ReadSharepointFolder",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('ReadSharepointFolder').output['d']['results']",
								"type": "Expression"
							},
							"condition": {
								"value": "@and(\n    startswith(item()['Name'],pipeline().parameters.parFileName),\n    greaterOrEquals(\n        item()['TimeLastModified'],\n        addToTime(\n            utcnow(),\n            mul(int(pipeline().parameters.parModifiedLastNHours),-1),\n            'hour'\n        )\n    )\n)",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"parEnvironment": {
						"type": "string"
					},
					"parAdlsDestinationFolder": {
						"type": "string"
					},
					"parFileName": {
						"type": "string"
					},
					"parShpSiteUrl": {
						"type": "string"
					},
					"parShpRelativeFolderPath": {
						"type": "string"
					},
					"parModifiedLastNHours": {
						"type": "string"
					},
					"parNewFileName": {
						"type": "string"
					},
					"parClientID": {
						"type": "string"
					},
					"parClientSecret": {
						"type": "string"
					},
					"par_UtcNowVar": {
						"type": "string"
					}
				},
				"variables": {
					"var_File_NameOut": {
						"type": "String"
					},
					"varNombreArchivoAtual": {
						"type": "String"
					},
					"varNombreNewArchivo": {
						"type": "String"
					},
					"varPathUTCArchivoAnterior": {
						"type": "String"
					}
				},
				"folder": {
					"name": "amsmx_supply_alice/pl_extract/SharePoint Catalogs"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-24T22:29:43Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_common_shp_copy-multiplefilestodatalakehourfilter')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Copy files of any size from SharePoint  to Data Lake, including copy all files matching a startswith condition of a folder and files modified in the last x hours.\n\nTo use this pipeline you need to have the sharepoint client id and secret id registered in the dedicated sharepoint key vault",
				"activities": [
					{
						"name": "ForEachFile",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "FilterFiles",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('FilterFiles').output.Value",
								"type": "Expression"
							},
							"batchCount": 10,
							"activities": [
								{
									"name": "Copy File",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Filename Copy",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "BinarySource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET",
												"additionalHeaders": {
													"value": "@{concat('Authorization: Bearer ', activity('GetSharepointBearerToken').output.access_token)}",
													"type": "Expression"
												},
												"requestTimeout": ""
											},
											"formatSettings": {
												"type": "BinaryReadSettings"
											}
										},
										"sink": {
											"type": "BinarySink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "ds_ar_rest_shp_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_Url": {
													"value": "@concat(pipeline().parameters.parShpSiteUrl,'/_api/web/GetFileByServerRelativeUrl(''',replace(pipeline().parameters.parShpSiteUrl,'https://nestle.sharepoint.com',''),pipeline().parameters.parShpRelativeFolderPath,'/',item().Name,''')/$value')",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ds_adsl2_origenesmx_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": {
													"value": "@concat(pipeline().parameters.parAdlsDestinationFolder,'/',pipeline().parameters.par_UtcNowVar)",
													"type": "Expression"
												},
												"par_filename": {
													"value": "@item().Name",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Filename Copy",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "var_FileTipificationNameOut",
										"value": {
											"value": "@item().Name",
											"type": "Expression"
										}
									}
								}
							]
						}
					},
					{
						"name": "GetShpClientId",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": true,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@pipeline().parameters.parClientID",
								"type": "Expression"
							},
							"method": "GET",
							"headers": {},
							"authentication": {
								"type": "MSI",
								"resource": "https://vault.azure.net"
							}
						}
					},
					{
						"name": "GetShpSecret",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": true,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@pipeline().parameters.parClientSecret",
								"type": "Expression"
							},
							"method": "GET",
							"headers": {},
							"authentication": {
								"type": "MSI",
								"resource": "https://vault.azure.net"
							}
						}
					},
					{
						"name": "FilterFiles",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "ReadSharepointFolder",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('ReadSharepointFolder').output['d']['results']",
								"type": "Expression"
							},
							"condition": {
								"value": "@and(\n    startswith(item()['Name'],pipeline().parameters.parFileName),\n    greaterOrEquals(\n        item()['TimeLastModified'],\n        addToTime(\n            utcnow(),\n            mul(int(pipeline().parameters.parModifiedLastNHours),-1),\n            'hour'\n        )\n    )\n)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ReadSharepointFolder",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "GetSharepointBearerToken",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": true
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@concat(pipeline().parameters.parShpSiteUrl,'/_api/web/GetFolderByServerRelativeUrl(''',replace(pipeline().parameters.parShpSiteUrl,'https://nestle.sharepoint.com',''),'/',pipeline().parameters.parShpRelativeFolderPath,''')/Files')",
								"type": "Expression"
							},
							"method": "GET",
							"headers": {
								"Authorization": {
									"value": "@{concat('Bearer ', activity('GetSharepointBearerToken').output.access_token)}",
									"type": "Expression"
								},
								"Accept": "application/json;odata=verbose"
							}
						}
					},
					{
						"name": "GetSharepointBearerToken",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "GetShpClientId",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "GetShpSecret",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": true,
							"secureInput": true
						},
						"userProperties": [],
						"typeProperties": {
							"url": "https://accounts.accesscontrol.windows.net/12a3af23-a769-4654-847f-958f3d479f4a/tokens/OAuth/2",
							"method": "POST",
							"headers": {
								"Content-Type": "application/x-www-form-urlencoded"
							},
							"body": {
								"value": "@concat('grant_type=client_credentials&client_id=',uriComponent(activity('GetShpClientId').output.value),'@12a3af23-a769-4654-847f-958f3d479f4a&client_secret=',uriComponent(activity('GetShpSecret').output.value),'&resource=00000003-0000-0ff1-ce00-000000000000/nestle.sharepoint.com@12a3af23-a769-4654-847f-958f3d479f4a')\n",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Carga Tipification COMP - Inbound",
						"type": "DatabricksNotebook",
						"dependsOn": [
							{
								"activity": "ForEachFile",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebookPath": "/Users/rafael.medeiros2@br.nestle.com/sl_creditnotes_tipification/02_inbound_tipification_new_archivo",
							"baseParameters": {
								"parArchivoNombreAtual": {
									"value": "@variables('var_FileTipificationNameOut')",
									"type": "Expression"
								},
								"parDateTimeUTC": {
									"value": "@pipeline().parameters.par_UtcNowVar",
									"type": "Expression"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "lk_nmex_dv_origenesmx_id_usw2_dbr",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "pl_common_process_tipification",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Tipification COMP - Inbound",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_common_process_tipification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"parEnvironment": {
						"type": "string",
						"defaultValue": "dev"
					},
					"parAdlsDestinationFolder": {
						"type": "string"
					},
					"parFileName": {
						"type": "string"
					},
					"parShpSiteUrl": {
						"type": "string"
					},
					"parShpRelativeFolderPath": {
						"type": "string"
					},
					"parModifiedLastNHours": {
						"type": "string"
					},
					"parNewFileName": {
						"type": "string"
					},
					"parClientID": {
						"type": "string"
					},
					"parClientSecret": {
						"type": "string"
					},
					"par_UtcNowVar": {
						"type": "string"
					}
				},
				"variables": {
					"var_FileTipificationNameOut": {
						"type": "String"
					},
					"varNombreArchivoAtual": {
						"type": "String"
					},
					"varNombreNewArchivo": {
						"type": "String"
					},
					"varPathUTCArchivoAnterior": {
						"type": "String"
					}
				},
				"folder": {
					"name": "amsmx_finance_creditnotes/Utils/SharePoint/Toolset"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-12T22:29:01Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_common_shp_copy-multiplefilestodatalakehourfilter_generica')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Copy files of any size from SharePoint  to Data Lake, including copy all files matching a startswith condition of a folder and files modified in the last x hours.\n\nTo use this pipeline you need to have the sharepoint client id and secret id registered in the dedicated sharepoint key vault",
				"activities": [
					{
						"name": "ForEachFile",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "FilterFiles",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('FilterFiles').output.Value",
								"type": "Expression"
							},
							"batchCount": 10,
							"activities": [
								{
									"name": "Copy File",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Filename Copy",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "BinarySource",
											"storeSettings": {
												"type": "HttpReadSettings",
												"requestMethod": "GET",
												"additionalHeaders": {
													"value": "@{concat('Authorization: Bearer ', activity('GetSharepointBearerToken').output.access_token)}",
													"type": "Expression"
												},
												"requestTimeout": ""
											},
											"formatSettings": {
												"type": "BinaryReadSettings"
											}
										},
										"sink": {
											"type": "BinarySink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "ds_ar_rest_shp_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_Url": {
													"value": "@concat(pipeline().parameters.parShpSiteUrl,'/_api/web/GetFileByServerRelativeUrl(''',replace(pipeline().parameters.parShpSiteUrl,'https://nestle.sharepoint.com',''),pipeline().parameters.parShpRelativeFolderPath,'/',item().Name,''')/$value')",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ds_adsl2_origenesmx_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": {
													"value": "@concat(pipeline().parameters.parAdlsDestinationFolder,'/',pipeline().parameters.par_UtcNowVar)",
													"type": "Expression"
												},
												"par_filename": {
													"value": "@item().Name",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Filename Copy",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "var_FileTipificationNameOut",
										"value": {
											"value": "@item().Name",
											"type": "Expression"
										}
									}
								}
							]
						}
					},
					{
						"name": "GetShpClientId",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": true,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@pipeline().parameters.parClientID",
								"type": "Expression"
							},
							"method": "GET",
							"headers": {},
							"authentication": {
								"type": "MSI",
								"resource": "https://vault.azure.net"
							}
						}
					},
					{
						"name": "GetShpSecret",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": true,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@pipeline().parameters.parClientSecret",
								"type": "Expression"
							},
							"method": "GET",
							"headers": {},
							"authentication": {
								"type": "MSI",
								"resource": "https://vault.azure.net"
							}
						}
					},
					{
						"name": "FilterFiles",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "ReadSharepointFolder",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('ReadSharepointFolder').output['d']['results']",
								"type": "Expression"
							},
							"condition": {
								"value": "@and(\n    startswith(item()['Name'],pipeline().parameters.parFileName),\n    greaterOrEquals(\n        item()['TimeLastModified'],\n        addToTime(\n            utcnow(),\n            mul(int(pipeline().parameters.parModifiedLastNHours),-1),\n            'hour'\n        )\n    )\n)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ReadSharepointFolder",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "GetSharepointBearerToken",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": true
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@concat(pipeline().parameters.parShpSiteUrl,'/_api/web/GetFolderByServerRelativeUrl(''',replace(pipeline().parameters.parShpSiteUrl,'https://nestle.sharepoint.com',''),'/',pipeline().parameters.parShpRelativeFolderPath,''')/Files')",
								"type": "Expression"
							},
							"method": "GET",
							"headers": {
								"Authorization": {
									"value": "@{concat('Bearer ', activity('GetSharepointBearerToken').output.access_token)}",
									"type": "Expression"
								},
								"Accept": "application/json;odata=verbose"
							}
						}
					},
					{
						"name": "GetSharepointBearerToken",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "GetShpClientId",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "GetShpSecret",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": true,
							"secureInput": true
						},
						"userProperties": [],
						"typeProperties": {
							"url": "https://accounts.accesscontrol.windows.net/12a3af23-a769-4654-847f-958f3d479f4a/tokens/OAuth/2",
							"method": "POST",
							"headers": {
								"Content-Type": "application/x-www-form-urlencoded"
							},
							"body": {
								"value": "@concat('grant_type=client_credentials&client_id=',uriComponent(activity('GetShpClientId').output.value),'@12a3af23-a769-4654-847f-958f3d479f4a&client_secret=',uriComponent(activity('GetShpSecret').output.value),'&resource=00000003-0000-0ff1-ce00-000000000000/nestle.sharepoint.com@12a3af23-a769-4654-847f-958f3d479f4a')\n",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Carga Tipification COMP - Inbound",
						"type": "DatabricksNotebook",
						"dependsOn": [
							{
								"activity": "ForEachFile",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebookPath": "/Users/rafael.medeiros2@br.nestle.com/sl_creditnotes_tipification/02_inbound_tipification_new_archivo",
							"baseParameters": {
								"parArchivoNombreAtual": {
									"value": "@variables('var_FileTipificationNameOut')",
									"type": "Expression"
								},
								"parDateTimeUTC": {
									"value": "@pipeline().parameters.par_UtcNowVar",
									"type": "Expression"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "lk_nmex_dv_origenesmx_id_usw2_dbr",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "pl_common_process_tipification",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Carga Tipification COMP - Inbound",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_common_process_tipification",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"parEnvironment": {
						"type": "string",
						"defaultValue": "dev"
					},
					"parAdlsDestinationFolder": {
						"type": "string"
					},
					"parFileName": {
						"type": "string"
					},
					"parShpSiteUrl": {
						"type": "string"
					},
					"parShpRelativeFolderPath": {
						"type": "string"
					},
					"parModifiedLastNHours": {
						"type": "string"
					},
					"parNewFileName": {
						"type": "string"
					},
					"parClientID": {
						"type": "string"
					},
					"parClientSecret": {
						"type": "string"
					},
					"par_UtcNowVar": {
						"type": "string"
					}
				},
				"variables": {
					"var_FileTipificationNameOut": {
						"type": "String"
					},
					"varNombreArchivoAtual": {
						"type": "String"
					},
					"varNombreNewArchivo": {
						"type": "String"
					},
					"varPathUTCArchivoAnterior": {
						"type": "String"
					}
				},
				"folder": {
					"name": "amsmx_finance_creditnotes/Utils/SharePoint/Toolset"
				},
				"annotations": [],
				"lastPublishTime": "2023-01-16T21:13:47Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_common_shp_copy-sharepointsinglefiletodatalake')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Direct copy of sharepoint file to datalake\n\nTo use this pipeline you need to have the sharepoint client id and secret id registered in the dedicated sharepoint key vault",
				"activities": [
					{
						"name": "GetShpClientId",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": true,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@pipeline().parameters.parClientID",
								"type": "Expression"
							},
							"method": "GET",
							"headers": {},
							"authentication": {
								"type": "MSI",
								"resource": "https://vault.azure.net"
							}
						}
					},
					{
						"name": "GetShpSecret",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": true,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@pipeline().parameters.parClientSecret",
								"type": "Expression"
							},
							"method": "GET",
							"headers": {},
							"authentication": {
								"type": "MSI",
								"resource": "https://vault.azure.net"
							}
						}
					},
					{
						"name": "GetSharepointBearerToken",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "GetShpClientId",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "GetShpSecret",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": true,
							"secureInput": true
						},
						"userProperties": [],
						"typeProperties": {
							"url": "https://accounts.accesscontrol.windows.net/12a3af23-a769-4654-847f-958f3d479f4a/tokens/OAuth/2",
							"method": "POST",
							"headers": {
								"Content-Type": "application/x-www-form-urlencoded"
							},
							"body": {
								"value": "@concat('grant_type=client_credentials&client_id=',uriComponent(activity('GetShpClientId').output.value),'@12a3af23-a769-4654-847f-958f3d479f4a&client_secret=',uriComponent(activity('GetShpSecret').output.value),'&resource=00000003-0000-0ff1-ce00-000000000000/nestle.sharepoint.com@12a3af23-a769-4654-847f-958f3d479f4a')\n",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy File",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GetSharepointBearerToken",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": true
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "HttpReadSettings",
									"requestMethod": "GET",
									"additionalHeaders": {
										"value": "@{concat('Authorization: Bearer ', activity('GetSharepointBearerToken').output.access_token)}",
										"type": "Expression"
									},
									"requestTimeout": ""
								},
								"formatSettings": {
									"type": "BinaryReadSettings"
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "ds_ar_rest_shp_binary",
								"type": "DatasetReference",
								"parameters": {
									"par_Url": {
										"value": "@concat(pipeline().parameters.parShpSiteUrl,'/_api/web/GetFileByServerRelativeUrl(''',replace(pipeline().parameters.parShpSiteUrl,'https://nestle.sharepoint.com',''),pipeline().parameters.parShpRelativeFolderPath,'/',pipeline().parameters.parFileName,''')/$value')",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ds_adsl2_origenesmx_binary",
								"type": "DatasetReference",
								"parameters": {
									"par_directory": {
										"value": "@concat(pipeline().parameters.parAdlsDestinationFolder, '/', pipeline().parameters.parUTCNow)",
										"type": "Expression"
									},
									"par_filename": {
										"value": "@pipeline().parameters.parFileName",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"parEnvironment": {
						"type": "string"
					},
					"parAdlsDestinationFolder": {
						"type": "string",
						"defaultValue": "inbound/credit_notes/files_transfer"
					},
					"parFileName": {
						"type": "string"
					},
					"parShpSiteUrl": {
						"type": "string",
						"defaultValue": "https://nestle.sharepoint.com/teams/MXFillOutBillingReference"
					},
					"parShpRelativeFolderPath": {
						"type": "string",
						"defaultValue": "Shared Documents/Archivos tipificación"
					},
					"parNewFileName": {
						"type": "string"
					},
					"parClientID": {
						"type": "string",
						"defaultValue": "https://nmexdvorigmxdhusw2key.vault.azure.net/secrets/shp-clientid-mxbilingrebates/?api-version=7.0"
					},
					"parClientSecret": {
						"type": "string",
						"defaultValue": "https://nmexdvorigmxdhusw2key.vault.azure.net/secrets/shp-clientsecret-mxbilingrebates/?api-version=7.0"
					},
					"parUTCNow": {
						"type": "string"
					}
				},
				"variables": {
					"varUTCNow": {
						"type": "String"
					}
				},
				"folder": {
					"name": "amsmx_finance_creditnotes/Utils/SharePoint/Toolset"
				},
				"annotations": [],
				"lastPublishTime": "2022-12-12T22:29:01Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_common_unzip_flash_test')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get Metadata1",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Binary1_flash_source",
								"type": "DatasetReference",
								"parameters": {}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "BinaryReadSettings"
							}
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Get Metadata1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get Metadata1').output.childItems",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Copy data1",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "BinarySource",
											"storeSettings": {
												"type": "AzureBlobStorageReadSettings",
												"recursive": false,
												"deleteFilesAfterCompletion": false
											},
											"formatSettings": {
												"type": "BinaryReadSettings",
												"compressionProperties": {
													"type": "ZipDeflateReadSettings"
												}
											}
										},
										"sink": {
											"type": "BinarySink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings",
												"copyBehavior": "PreserveHierarchy"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "Binary1_flash_source",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Binary1",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "amsla_data-load-tool"
				},
				"annotations": [],
				"lastPublishTime": "2023-05-30T18:47:53Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_copy_blob_to_blob_atp_files')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get Carpeta",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "ds_adsl2_extdata_binary",
								"type": "DatasetReference",
								"parameters": {
									"par_directory": {
										"value": "@pipeline().parameters.par_Folder",
										"type": "Expression"
									},
									"par_filename": {
										"value": "@pipeline().parameters.par_Archivo_Nombre",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "BinaryReadSettings"
							}
						}
					},
					{
						"name": "Filter Archivos",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "Get Carpeta",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get Carpeta').output.childItems",
								"type": "Expression"
							},
							"condition": {
								"value": "@equals(item().type,'File')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ForEach Copy",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Filter Archivos",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Filter Archivos').output.value",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Copy Files",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "BinarySource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "BinaryReadSettings"
											}
										},
										"sink": {
											"type": "BinarySink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "ds_adsl2_extdata_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": {
													"value": "@pipeline().parameters.par_Folder",
													"type": "Expression"
												},
												"par_filename": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ds_adsl2_origenesmx_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": {
													"value": "@pipeline().parameters.par_Destination_Folder",
													"type": "Expression"
												},
												"par_filename": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Delete",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "Copy Files",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "ds_adsl2_extdata_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": {
													"value": "@pipeline().parameters.par_Folder",
													"type": "Expression"
												},
												"par_filename": {
													"value": "@pipeline().parameters.par_Archivo_Nombre",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "AzureBlobFSReadSettings",
											"recursive": true,
											"wildcardFileName": {
												"value": "@{pipeline().parameters.par_Archivo_Nombre}",
												"type": "Expression"
											},
											"enablePartitionDiscovery": false
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"par_Folder": {
						"type": "string"
					},
					"par_Archivo_Nombre": {
						"type": "string"
					},
					"par_Destination_Folder": {
						"type": "string"
					}
				},
				"variables": {
					"parPathCopy": {
						"type": "String"
					},
					"parFileNameCopy": {
						"type": "String"
					},
					"parContainer": {
						"type": "String"
					},
					"parPathDestination": {
						"type": "String"
					}
				},
				"folder": {
					"name": "amsmx_supply_alice"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-24T22:29:43Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_copy_blob_to_blob_bkup')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get Carpeta",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "ds_adsl2_extdata_binary",
								"type": "DatasetReference",
								"parameters": {
									"par_directory": {
										"value": "@pipeline().parameters.par_Folder",
										"type": "Expression"
									},
									"par_filename": {
										"value": "@pipeline().parameters.par_Archivo_Nombre",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "BinaryReadSettings"
							}
						}
					},
					{
						"name": "Filter Archivos",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "Get Carpeta",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get Carpeta').output.childItems",
								"type": "Expression"
							},
							"condition": {
								"value": "@equals(item().type,'File')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ForEach Copy",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Filter Archivos",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Filter Archivos').output.value",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Copy Files",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "BinarySource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "BinaryReadSettings"
											}
										},
										"sink": {
											"type": "BinarySink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "ds_adsl2_extdata_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": {
													"value": "@pipeline().parameters.par_Folder",
													"type": "Expression"
												},
												"par_filename": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ds_adsl2_origenesmx_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": {
													"value": "@pipeline().parameters.par_Destination_Folder",
													"type": "Expression"
												},
												"par_filename": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"par_Folder": {
						"type": "string"
					},
					"par_Archivo_Nombre": {
						"type": "string"
					},
					"par_Destination_Folder": {
						"type": "string"
					}
				},
				"variables": {
					"parPathCopy": {
						"type": "String"
					},
					"parFileNameCopy": {
						"type": "String"
					},
					"parContainer": {
						"type": "String"
					},
					"parPathDestination": {
						"type": "String"
					}
				},
				"folder": {
					"name": "amsmx_supply_alice"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-24T22:29:43Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_daily_DRIVIN')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"dataset": {
								"referenceName": "DelimitedText1",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lookup1').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Set variable1",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "start_date",
										"value": {
											"value": "@utcnow('dd-MM-yyyy')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set variable2",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Set variable1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "name_provider",
										"value": {
											"value": "@item().provedor",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set variable3",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Set variable2",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "key_provider",
										"value": {
											"value": "@item().key",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Notebook1",
									"type": "DatabricksNotebook",
									"dependsOn": [
										{
											"activity": "Set variable3",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"notebookPath": "/Repos/fernando.vazquez1@mx.nestle.com/DatabricksMX/sl_extras_dev/Rest_API/Drivin_API/execution/DRIVINAPI_1",
										"baseParameters": {
											"end_date": {
												"value": "@variables('start_date')",
												"type": "Expression"
											},
											"key_provider": {
												"value": "@variables('key_provider')",
												"type": "Expression"
											},
											"startdate": {
												"value": "@variables('start_date')",
												"type": "Expression"
											},
											"name_provider": {
												"value": "@variables('name_provider')",
												"type": "Expression"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "lk_nmex_dv_origenesmx_id_usw2_dbr",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"start_date": {
						"type": "String"
					},
					"end_date": {
						"type": "String"
					},
					"key_provider": {
						"type": "String"
					},
					"name_provider": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2023-05-30T18:47:53Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_delete_rpa_files_inbound')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get Carpeta",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "ds_sc_nmex_devorigmx_generic",
								"type": "DatasetReference",
								"parameters": {
									"par_container": {
										"value": "@pipeline().parameters.par_container",
										"type": "Expression"
									},
									"par_diretorio": {
										"value": "@pipeline().parameters.par_diretorio",
										"type": "Expression"
									},
									"par_arquivo": {
										"value": "@pipeline().parameters.par_arquivo",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "BinaryReadSettings"
							}
						}
					},
					{
						"name": "Filter Archivos Hoy",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "Get Carpeta",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get Carpeta').output.childItems",
								"type": "Expression"
							},
							"condition": {
								"value": "@equals(item().type,'File')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ForEach Copy",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Filter Archivos Hoy",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Filter Archivos Hoy').output.value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Delete Files",
									"type": "Delete",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "ds_adsl2_origenesmx_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": {
													"value": "@pipeline().parameters.par_diretorio",
													"type": "Expression"
												},
												"par_filename": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "AzureBlobFSReadSettings",
											"recursive": true,
											"enablePartitionDiscovery": false
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"par_container": {
						"type": "string"
					},
					"par_diretorio": {
						"type": "string"
					},
					"par_arquivo": {
						"type": "string"
					}
				},
				"folder": {
					"name": "amsmx_supply_alice"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-03T23:14:08Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_extract_api_origenes_drivin')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set variable DRIVIN",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "var_driv",
							"value": {
								"value": "@concat(pipeline().parameters.par_url,'api/external/v2/pods?start_date=',pipeline().parameters.par_stardate,'&end_date=',pipeline().parameters.par_enddate)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy DrivIn",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set variable DRIVIN",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "POST",
								"requestBody": "{}",
								"additionalHeaders": {
									"Content-type": {
										"value": "@pipeline().parameters.par_header_content_type",
										"type": "Expression"
									},
									"X-API-Key": {
										"value": "@pipeline().parameters.par_header_key",
										"type": "Expression"
									}
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "ar_rest_api_generic_auth",
								"type": "DatasetReference",
								"parameters": {
									"par_url_complete": {
										"value": "@variables('var_driv')",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "json_api_web",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@concat(pipeline().parameters.FileName,'_DRIVIN_',variables('var_set_fecha_hoy'),'.json')",
										"type": "Expression"
									},
									"ContName": {
										"value": "@pipeline().parameters.par_cont",
										"type": "Expression"
									},
									"FoldPath": {
										"value": "@concat(pipeline().parameters.par_folder,'DRIVIN')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Set variable DRIVIN Vehicles",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "var_driv_vehiculos",
							"value": {
								"value": "@concat(pipeline().parameters.par_url,'api/external/v2/vehicles')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy DrivIn Vehicles",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set variable DRIVIN Vehicles",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"additionalHeaders": {
									"X-API-Key": {
										"value": "@pipeline().parameters.par_header_key",
										"type": "Expression"
									}
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "ar_rest_api_generic_auth",
								"type": "DatasetReference",
								"parameters": {
									"par_url_complete": {
										"value": "@variables('var_driv_vehiculos')",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "json_api_web",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@concat(pipeline().parameters.FileName,'_DRIVIN_VEHICLES',variables('var_set_fecha_hoy'),'.json')",
										"type": "Expression"
									},
									"ContName": {
										"value": "@pipeline().parameters.par_cont",
										"type": "Expression"
									},
									"FoldPath": {
										"value": "@concat(pipeline().parameters.par_folder,'VEHICLES')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Set variable DRIVIN Esquemas",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "var_driv_esquemas",
							"value": {
								"value": "@concat(pipeline().parameters.par_url,'api/external/v2/schemas')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy DrivIn Esquemas",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set variable DRIVIN Esquemas",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"additionalHeaders": {
									"X-API-Key": {
										"value": "@pipeline().parameters.par_header_key",
										"type": "Expression"
									}
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "ar_rest_api_generic_auth",
								"type": "DatasetReference",
								"parameters": {
									"par_url_complete": {
										"value": "@variables('var_driv_esquemas')",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "json_api_web",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@concat(pipeline().parameters.FileName,'_DRIVIN_ESQUEMAS_',variables('var_set_fecha_hoy'),'.json')",
										"type": "Expression"
									},
									"ContName": {
										"value": "@pipeline().parameters.par_cont",
										"type": "Expression"
									},
									"FoldPath": {
										"value": "@concat(pipeline().parameters.par_folder,'ESQUEMAS')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Set variable DRIVIN Grupos Vehicles",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "var_driv_grupo_vehiculos",
							"value": {
								"value": "@concat(pipeline().parameters.par_url,'api/external/v2/vehicles')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy DrivIn Grupo Vehicles",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set variable DRIVIN Grupos Vehicles",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"additionalHeaders": {
									"X-API-Key": {
										"value": "@pipeline().parameters.par_header_key",
										"type": "Expression"
									}
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "ar_rest_api_generic_auth",
								"type": "DatasetReference",
								"parameters": {
									"par_url_complete": {
										"value": "@variables('var_driv_grupo_vehiculos')",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "json_api_web",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@concat(pipeline().parameters.FileName,'_DRIVIN_GRUPO_VEHICLES_',variables('var_set_fecha_hoy'),'.json')",
										"type": "Expression"
									},
									"ContName": {
										"value": "@pipeline().parameters.par_cont",
										"type": "Expression"
									},
									"FoldPath": {
										"value": "@concat(pipeline().parameters.par_folder,'GRUPO_VEHICLES')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Set variable DRIVIN Direccion",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "var_driv_direccion",
							"value": {
								"value": "@concat(pipeline().parameters.par_url,'api/external/v2/addresses')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy DrivIn Grupo Direccion",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set variable DRIVIN Direccion",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"additionalHeaders": {
									"X-API-Key": {
										"value": "@pipeline().parameters.par_header_key",
										"type": "Expression"
									}
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "ar_rest_api_generic_auth",
								"type": "DatasetReference",
								"parameters": {
									"par_url_complete": {
										"value": "@variables('var_driv_direccion')",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "json_api_web",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@concat(pipeline().parameters.FileName,'_DRIVIN_DIRECCIONES_',variables('var_set_fecha_hoy'),'.json')",
										"type": "Expression"
									},
									"ContName": {
										"value": "@pipeline().parameters.par_cont",
										"type": "Expression"
									},
									"FoldPath": {
										"value": "@concat(pipeline().parameters.par_folder,'DIRECCIONES')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Set variable DRIVIN Clientes",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "var_driv_clientes",
							"value": {
								"value": "@concat(pipeline().parameters.par_url,'api/external/v2/v2/clients')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy DrivIn Clientes",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set variable DRIVIN Clientes",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "POST",
								"requestBody": "{}",
								"additionalHeaders": {
									"Content-type": {
										"value": "@pipeline().parameters.par_header_content_type",
										"type": "Expression"
									},
									"X-API-Key": {
										"value": "@pipeline().parameters.par_header_key",
										"type": "Expression"
									}
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "ar_rest_api_generic_auth",
								"type": "DatasetReference",
								"parameters": {
									"par_url_complete": {
										"value": "@variables('var_driv_clientes')",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "json_api_web",
								"type": "DatasetReference",
								"parameters": {
									"FileName": {
										"value": "@concat(pipeline().parameters.FileName,'_DRIVIN_CLIENTES_',variables('var_set_fecha_hoy'),'.json')",
										"type": "Expression"
									},
									"ContName": {
										"value": "@pipeline().parameters.par_cont",
										"type": "Expression"
									},
									"FoldPath": {
										"value": "@concat(pipeline().parameters.par_folder,'CLIENTES')",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"par_url": {
						"type": "string",
						"defaultValue": "https://external.driv.in/"
					},
					"par_stardate": {
						"type": "string"
					},
					"par_enddate": {
						"type": "string"
					},
					"par_header_content_type": {
						"type": "string",
						"defaultValue": "application/json"
					},
					"par_header_key": {
						"type": "string"
					},
					"FileName": {
						"type": "string",
						"defaultValue": "JSON"
					},
					"par_cont": {
						"type": "string",
						"defaultValue": "dev"
					},
					"par_folder": {
						"type": "string",
						"defaultValue": "/inbound/ext_api_files_new/DRIVIN/"
					},
					"par_url_login": {
						"type": "string",
						"defaultValue": "https://central.cevisur.com.mx:8443/nestle/api/auth/login"
					}
				},
				"variables": {
					"var_riv_ventas": {
						"type": "String"
					},
					"var_nie_ventas": {
						"type": "String"
					},
					"var_driv": {
						"type": "String"
					},
					"var_supplier": {
						"type": "String"
					},
					"var_cevi_login": {
						"type": "String"
					},
					"var_cevi_ventas": {
						"type": "String"
					},
					"var_cevi_inventario": {
						"type": "String"
					},
					"var_cevi_clientes": {
						"type": "String"
					},
					"var_cevi_produtos": {
						"type": "String"
					},
					"var_riv_inventario": {
						"type": "String"
					},
					"var_nie_inventarios": {
						"type": "String"
					},
					"var_nie_clientes": {
						"type": "String"
					},
					"var_nie_productos": {
						"type": "String"
					},
					"var_set_fecha_hoy": {
						"type": "String"
					},
					"var_cevi_facturas": {
						"type": "String"
					},
					"var_url_default": {
						"type": "String"
					},
					"var_driv_direccion": {
						"type": "String"
					},
					"var_driv_rutas": {
						"type": "String"
					},
					"var_driv_vehiculos": {
						"type": "String"
					},
					"var_driv_grupo_vehiculos": {
						"type": "String"
					},
					"var_driv_esquemas": {
						"type": "String"
					},
					"var_driv_clientes": {
						"type": "String"
					}
				},
				"folder": {
					"name": "amsmx_finance_creditnotes/Utils/API_Web"
				},
				"annotations": [],
				"lastPublishTime": "2023-06-02T19:16:29Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_extract_api_tablas_inb_outb')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Date UTC",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Fecha Ayer 00",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "var_final_date",
							"value": {
								"value": "@formatDateTime(convertTimeZone(utcNow(),'UTC','Central Standard Time (Mexico)'),'yyyy-MM-dd hh:mm')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Date",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Date UTC",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "date_ext",
							"value": {
								"value": "@formatDateTime(pipeline().TriggerTime,'yyyyMMdd')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "web api auth",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Set Date",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@pipeline().parameters.par_url",
								"type": "Expression"
							},
							"method": "POST",
							"headers": {},
							"body": {
								"value": "{\n    \n}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Switch1",
						"type": "Switch",
						"dependsOn": [
							{
								"activity": "web api auth",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"on": {
								"value": "@pipeline().parameters.par_tabla",
								"type": "Expression"
							},
							"cases": [
								{
									"value": "OUTBOUND_LIVE",
									"activities": [
										{
											"name": "api_web API FECHA_EN_PLAN_COPY_01",
											"type": "Copy",
											"dependsOn": [
												{
													"activity": "Set URL Complete with Token_01",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"timeout": "0.12:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"source": {
													"type": "RestSource",
													"httpRequestTimeout": "00:01:40",
													"requestInterval": "00.00:00:00.010",
													"requestMethod": "POST",
													"requestBody": "{}"
												},
												"sink": {
													"type": "DelimitedTextSink",
													"storeSettings": {
														"type": "AzureBlobFSWriteSettings"
													},
													"formatSettings": {
														"type": "DelimitedTextWriteSettings",
														"quoteAllText": true,
														"fileExtension": ".txt"
													}
												},
												"enableStaging": false,
												"translator": {
													"type": "TabularTranslator",
													"mappings": [
														{
															"source": {
																"path": "$['truck']['eco']"
															},
															"sink": {
																"name": "truck_eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['unity']"
															},
															"sink": {
																"name": "unity",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['type_unity']"
															},
															"sink": {
																"name": "type_unity",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['ARRIVE_SOURCE_TRUCK']"
															},
															"sink": {
																"name": "ARRIVE_SOURCE_TRUCK",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['box']"
															},
															"sink": {
																"name": "box",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['note']"
															},
															"sink": {
																"name": "note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['notes']"
															},
															"sink": {
																"name": "source_notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['status']"
															},
															"sink": {
																"name": "status",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['CREATED']['date']"
															},
															"sink": {
																"name": "source_src_plan_CREATED_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['CREATED']['user']"
															},
															"sink": {
																"name": "source_src_plan_CREATED_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['DISPATCH']['date']"
															},
															"sink": {
																"name": "source_src_plan_DISPATCH_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITH_DOC']['date']"
															},
															"sink": {
																"name": "source_src_plan_WITH_DOC_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITH_DOC']['user']"
															},
															"sink": {
																"name": "source_src_plan_WITH_DOC_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['LOAD_START']['date']"
															},
															"sink": {
																"name": "source_src_plan_LOAD_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITHOUT_DOC']['date']"
															},
															"sink": {
																"name": "source_src_plan_WITHOUT_DOC_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITHOUT_DOC']['user']"
															},
															"sink": {
																"name": "source_src_plan_WITHOUT_DOC_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['EXIT']['date']"
															},
															"sink": {
																"name": "source_src_track_EXIT_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['EXIT']['user']"
															},
															"sink": {
																"name": "source_src_track_EXIT_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['INVOICE']['date']"
															},
															"sink": {
																"name": "source_src_track_INVOICE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['INVOICE']['user']"
															},
															"sink": {
																"name": "source_src_track_INVOICE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DISPATCH']['date']"
															},
															"sink": {
																"name": "source_src_track_DISPATCH_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DISPATCH']['user']"
															},
															"sink": {
																"name": "source_src_track_DISPATCH_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ENTRANCE']['date']"
															},
															"sink": {
																"name": "source_src_track_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ENTRANCE']['user']"
															},
															"sink": {
																"name": "source_src_track_ENTRANCE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_END']['date']"
															},
															"sink": {
																"name": "source_src_track_LOAD_END_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_END']['user']"
															},
															"sink": {
																"name": "source_src_track_LOAD_END_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DESK_TRUCK']['date']"
															},
															"sink": {
																"name": "source_src_track_DESK_TRUCK_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_START']['date']"
															},
															"sink": {
																"name": "source_src_track_LOAD_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_START']['user']"
															},
															"sink": {
																"name": "source_src_track_LOAD_START_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ARRIVE_DESK']['date']"
															},
															"sink": {
																"name": "source_src_track_ARRIVE_DESK_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ARRIVE_DESK']['user']"
															},
															"sink": {
																"name": "source_src_track_ARRIVE_DESK_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DESK_TRAILER']['date']"
															},
															"sink": {
																"name": "source_src_track_DESK_TRAILER_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['date']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['user']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['notes']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['auditor']"
															},
															"sink": {
																"name": "auditor",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_START']['date']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_START']['user']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_START_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['driver_exit']"
															},
															"sink": {
																"name": "source_driver_exit",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['ramp']"
															},
															"sink": {
																"name": "ramp",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['seal']"
															},
															"sink": {
																"name": "seal",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['layout']"
															},
															"sink": {
																"name": "layout",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['customs']"
															},
															"sink": {
																"name": "customs",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['coworker']"
															},
															"sink": {
																"name": "coworker",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['seal_type']"
															},
															"sink": {
																"name": "seal_type",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['box_picking']"
															},
															"sink": {
																"name": "box_picking",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['pallets_rack']"
															},
															"sink": {
																"name": "pallets_rack",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['pallets_block']"
															},
															"sink": {
																"name": "pallets_block",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['platform_chep']"
															},
															"sink": {
																"name": "platform_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['platform_white']"
															},
															"sink": {
																"name": "platform_white",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['warehouse_note']"
															},
															"sink": {
																"name": "warehouse_note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['is_committee_priority']"
															},
															"sink": {
																"name": "is_committee_priority",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['date_invoice']"
															},
															"sink": {
																"name": "date_invoice",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['convenio_chep']"
															},
															"sink": {
																"name": "convenio_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['location_name']"
															},
															"sink": {
																"name": "location_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['main_location']"
															},
															"sink": {
																"name": "main_location",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['with_document']"
															},
															"sink": {
																"name": "with_document",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['valuation_note']"
															},
															"sink": {
																"name": "valuation_note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['client']"
															},
															"sink": {
																"name": "client",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['shipto']"
															},
															"sink": {
																"name": "shipto",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny']"
															},
															"sink": {
																"name": "destiny",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['UPDATE_DATE']['date']"
															},
															"sink": {
																"name": "destiny_dst_plan_UPDATE_DATE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['UPDATE_DATE']['user']"
															},
															"sink": {
																"name": "destiny_dst_plan_UPDATE_DATE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['ENTRANCE_DATE']['date']"
															},
															"sink": {
																"name": "destiny_dst_plan_ENTRANCE_DATE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENT_GPS']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ENT_GPS_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['END_UNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_END_UNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['START_UNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_START_UNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DESTINY_ENTRANCE']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_DESTINY_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['population']"
															},
															"sink": {
																"name": "population",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['driver_exit']"
															},
															"sink": {
																"name": "destiny_driver_exit",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['gross_weight']"
															},
															"sink": {
																"name": "gross_weight",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['eco']"
															},
															"sink": {
																"name": "trailer_eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['plate']"
															},
															"sink": {
																"name": "plate",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['assing_user']"
															},
															"sink": {
																"name": "assing_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['assing_trailer']"
															},
															"sink": {
																"name": "assing_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['trailer_update']"
															},
															"sink": {
																"name": "trailer_update",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['update_date_trailer']"
															},
															"sink": {
																"name": "update_date_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['update_user_trailer']"
															},
															"sink": {
																"name": "update_user_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['ARRIVE_SOURCE_TRAILER']"
															},
															"sink": {
																"name": "ARRIVE_SOURCE_TRAILER",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['carga_tm']"
															},
															"sink": {
																"name": "carga_tm",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['semaforo']"
															},
															"sink": {
																"name": "semaforo",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['user']"
															},
															"sink": {
																"name": "supplier_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['company_name']"
															},
															"sink": {
																"name": "company_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['last_company_update']"
															},
															"sink": {
																"name": "last_company_update",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['deliveries']"
															},
															"sink": {
																"name": "deliveries",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['confirmation']"
															},
															"sink": {
																"name": "confirmation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supply_chain']"
															},
															"sink": {
																"name": "supply_chain",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['type_operation']"
															},
															"sink": {
																"name": "type_operation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['grupo_comercial']"
															},
															"sink": {
																"name": "grupo_comercial",
																"type": "String"
															}
														}
													],
													"collectionReference": ""
												}
											},
											"inputs": [
												{
													"referenceName": "nmex_rest_dataset_api",
													"type": "DatasetReference",
													"parameters": {
														"url_dataset_post_rest_api": {
															"value": "@variables('url_complete')",
															"type": "Expression"
														}
													}
												}
											],
											"outputs": [
												{
													"referenceName": "ds_adsl2_origenesmx_csv",
													"type": "DatasetReference",
													"parameters": {
														"par_directory": {
															"value": "@concat(pipeline().parameters.par_folder,'OUTBOUND_LIVE_ARCHIVOS/',variables('var_final_date'),'/')",
															"type": "Expression"
														},
														"par_filename": {
															"value": "@concat('OUTBOUND_LIVE_01_',pipeline().parameters.par_search_type,'_',variables('date_ext'),'.csv')",
															"type": "Expression"
														},
														"par_delimeter": ","
													}
												}
											]
										},
										{
											"name": "Set URL Complete with Token_01",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "Set Parameters Copy 01",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "url_complete",
												"value": {
													"value": "@concat(pipeline().parameters.par_url_base,pipeline().parameters.par_function,'?token=',activity('web api auth').output.token,'&parameters=',variables('var_parameters'))",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set Parameters Copy 01",
											"type": "SetVariable",
											"dependsOn": [],
											"policy": {
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "var_parameters",
												"value": {
													"value": "@if(empty(pipeline().parameters.par_status),\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"initial_date\":\"',variables('var_fecha_01'),'\",\"final_date\":\"', variables('var_fecha_hoy'),'\"}}')\n    ,\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"status\":\"',pipeline().parameters.par_status,'\",\"initial_date\":\"',variables('var_fecha_01'),'\",\"final_date\":\"', variables('var_fecha_hoy'),'\"}}')\n    )",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set Parameters Copy 02",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "api_web API FECHA_EN_PLAN_COPY_01",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "var_parameters_02",
												"value": {
													"value": "@if(empty(pipeline().parameters.par_status),\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"initial_date\":\"',variables('var_fecha_02'),'\",\"final_date\":\"', variables('var_fecha_01'),'\"}}')\n    ,\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"status\":\"',pipeline().parameters.par_status,'\",\"initial_date\":\"',variables('var_fecha_02'),'\",\"final_date\":\"', variables('var_fecha_01'),'\"}}')\n    )",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set Parameters Copy 03",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "api_web API FECHA_EN_PLAN_COPY_02",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "var_parameters_03",
												"value": {
													"value": "@if(empty(pipeline().parameters.par_status),\n    concat('{\"search_filters\": {\"search_type\":\"DESPACHO_REAL\",\"initial_date\":\"',variables('var_fecha_hoy'),'\",\"final_date\":\"', variables('var_fecha_hoy_02'),'\"}}')\n    ,\n    concat('{\"search_filters\": {\"search_type\":\"DESPACHO_REAL\",\"initial_date\":\"',variables('var_fecha_hoy'),'\",\"final_date\":\"', variables('var_fecha_hoy_02'),'\"}}')\n    )",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set URL Complete with Token_02",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "Set Parameters Copy 02",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "url_complete_02",
												"value": {
													"value": "@concat(pipeline().parameters.par_url_base,pipeline().parameters.par_function,'?token=',activity('web api auth').output.token,'&parameters=',variables('var_parameters_02'))",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set URL Complete with Token_03",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "Set Parameters Copy 03",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "url_complete_03",
												"value": {
													"value": "@concat(pipeline().parameters.par_url_base,pipeline().parameters.par_function,'?token=',activity('web api auth').output.token,'&parameters=',variables('var_parameters_03'))",
													"type": "Expression"
												}
											}
										},
										{
											"name": "api_web API FECHA_EN_PLAN_COPY_02",
											"type": "Copy",
											"dependsOn": [
												{
													"activity": "Set URL Complete with Token_02",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"timeout": "0.12:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"source": {
													"type": "RestSource",
													"httpRequestTimeout": "00:01:40",
													"requestInterval": "00.00:00:00.010",
													"requestMethod": "POST",
													"requestBody": "{}"
												},
												"sink": {
													"type": "DelimitedTextSink",
													"storeSettings": {
														"type": "AzureBlobFSWriteSettings"
													},
													"formatSettings": {
														"type": "DelimitedTextWriteSettings",
														"quoteAllText": true,
														"fileExtension": ".txt"
													}
												},
												"enableStaging": false,
												"translator": {
													"type": "TabularTranslator",
													"mappings": [
														{
															"source": {
																"path": "$['truck']['eco']"
															},
															"sink": {
																"name": "truck_eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['unity']"
															},
															"sink": {
																"name": "unity",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['type_unity']"
															},
															"sink": {
																"name": "type_unity",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['ARRIVE_SOURCE_TRUCK']"
															},
															"sink": {
																"name": "ARRIVE_SOURCE_TRUCK",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['box']"
															},
															"sink": {
																"name": "box",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['note']"
															},
															"sink": {
																"name": "note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['notes']"
															},
															"sink": {
																"name": "source_notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['status']"
															},
															"sink": {
																"name": "status",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['CREATED']['date']"
															},
															"sink": {
																"name": "source_src_plan_CREATED_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['CREATED']['user']"
															},
															"sink": {
																"name": "source_src_plan_CREATED_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['DISPATCH']['date']"
															},
															"sink": {
																"name": "source_src_plan_DISPATCH_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITH_DOC']['date']"
															},
															"sink": {
																"name": "source_src_plan_WITH_DOC_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITH_DOC']['user']"
															},
															"sink": {
																"name": "source_src_plan_WITH_DOC_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['LOAD_START']['date']"
															},
															"sink": {
																"name": "source_src_plan_LOAD_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITHOUT_DOC']['date']"
															},
															"sink": {
																"name": "source_src_plan_WITHOUT_DOC_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITHOUT_DOC']['user']"
															},
															"sink": {
																"name": "source_src_plan_WITHOUT_DOC_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['EXIT']['date']"
															},
															"sink": {
																"name": "source_src_track_EXIT_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['EXIT']['user']"
															},
															"sink": {
																"name": "source_src_track_EXIT_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['INVOICE']['date']"
															},
															"sink": {
																"name": "source_src_track_INVOICE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['INVOICE']['user']"
															},
															"sink": {
																"name": "source_src_track_INVOICE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DISPATCH']['date']"
															},
															"sink": {
																"name": "source_src_track_DISPATCH_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DISPATCH']['user']"
															},
															"sink": {
																"name": "source_src_track_DISPATCH_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ENTRANCE']['date']"
															},
															"sink": {
																"name": "source_src_track_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ENTRANCE']['user']"
															},
															"sink": {
																"name": "source_src_track_ENTRANCE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_END']['date']"
															},
															"sink": {
																"name": "source_src_track_LOAD_END_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_END']['user']"
															},
															"sink": {
																"name": "source_src_track_LOAD_END_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DESK_TRUCK']['date']"
															},
															"sink": {
																"name": "source_src_track_DESK_TRUCK_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_START']['date']"
															},
															"sink": {
																"name": "source_src_track_LOAD_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_START']['user']"
															},
															"sink": {
																"name": "source_src_track_LOAD_START_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ARRIVE_DESK']['date']"
															},
															"sink": {
																"name": "source_src_track_ARRIVE_DESK_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ARRIVE_DESK']['user']"
															},
															"sink": {
																"name": "source_src_track_ARRIVE_DESK_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DESK_TRAILER']['date']"
															},
															"sink": {
																"name": "source_src_track_DESK_TRAILER_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['date']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['user']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['notes']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['auditor']"
															},
															"sink": {
																"name": "auditor",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_START']['date']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_START']['user']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_START_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['driver_exit']"
															},
															"sink": {
																"name": "source_driver_exit",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['ramp']"
															},
															"sink": {
																"name": "ramp",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['seal']"
															},
															"sink": {
																"name": "seal",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['layout']"
															},
															"sink": {
																"name": "layout",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['customs']"
															},
															"sink": {
																"name": "customs",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['coworker']"
															},
															"sink": {
																"name": "coworker",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['seal_type']"
															},
															"sink": {
																"name": "seal_type",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['box_picking']"
															},
															"sink": {
																"name": "box_picking",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['pallets_rack']"
															},
															"sink": {
																"name": "pallets_rack",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['pallets_block']"
															},
															"sink": {
																"name": "pallets_block",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['platform_chep']"
															},
															"sink": {
																"name": "platform_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['platform_white']"
															},
															"sink": {
																"name": "platform_white",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['warehouse_note']"
															},
															"sink": {
																"name": "warehouse_note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['is_committee_priority']"
															},
															"sink": {
																"name": "is_committee_priority",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['date_invoice']"
															},
															"sink": {
																"name": "date_invoice",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['convenio_chep']"
															},
															"sink": {
																"name": "convenio_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['location_name']"
															},
															"sink": {
																"name": "location_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['main_location']"
															},
															"sink": {
																"name": "main_location",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['with_document']"
															},
															"sink": {
																"name": "with_document",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['valuation_note']"
															},
															"sink": {
																"name": "valuation_note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['client']"
															},
															"sink": {
																"name": "client",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['shipto']"
															},
															"sink": {
																"name": "shipto",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny']"
															},
															"sink": {
																"name": "destiny",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['UPDATE_DATE']['date']"
															},
															"sink": {
																"name": "destiny_dst_plan_UPDATE_DATE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['UPDATE_DATE']['user']"
															},
															"sink": {
																"name": "destiny_dst_plan_UPDATE_DATE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['ENTRANCE_DATE']['date']"
															},
															"sink": {
																"name": "destiny_dst_plan_ENTRANCE_DATE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENT_GPS']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ENT_GPS_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['END_UNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_END_UNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['START_UNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_START_UNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DESTINY_ENTRANCE']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_DESTINY_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['population']"
															},
															"sink": {
																"name": "population",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['driver_exit']"
															},
															"sink": {
																"name": "destiny_driver_exit",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['gross_weight']"
															},
															"sink": {
																"name": "gross_weight",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['eco']"
															},
															"sink": {
																"name": "trailer_eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['plate']"
															},
															"sink": {
																"name": "plate",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['assing_user']"
															},
															"sink": {
																"name": "assing_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['assing_trailer']"
															},
															"sink": {
																"name": "assing_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['trailer_update']"
															},
															"sink": {
																"name": "trailer_update",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['update_date_trailer']"
															},
															"sink": {
																"name": "update_date_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['update_user_trailer']"
															},
															"sink": {
																"name": "update_user_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['ARRIVE_SOURCE_TRAILER']"
															},
															"sink": {
																"name": "ARRIVE_SOURCE_TRAILER",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['carga_tm']"
															},
															"sink": {
																"name": "carga_tm",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['semaforo']"
															},
															"sink": {
																"name": "semaforo",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['user']"
															},
															"sink": {
																"name": "supplier_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['company_name']"
															},
															"sink": {
																"name": "company_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['last_company_update']"
															},
															"sink": {
																"name": "last_company_update",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['deliveries']"
															},
															"sink": {
																"name": "deliveries",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['confirmation']"
															},
															"sink": {
																"name": "confirmation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supply_chain']"
															},
															"sink": {
																"name": "supply_chain",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['type_operation']"
															},
															"sink": {
																"name": "type_operation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['grupo_comercial']"
															},
															"sink": {
																"name": "grupo_comercial",
																"type": "String"
															}
														}
													],
													"collectionReference": ""
												}
											},
											"inputs": [
												{
													"referenceName": "nmex_rest_dataset_api",
													"type": "DatasetReference",
													"parameters": {
														"url_dataset_post_rest_api": {
															"value": "@variables('url_complete_02')",
															"type": "Expression"
														}
													}
												}
											],
											"outputs": [
												{
													"referenceName": "ds_adsl2_origenesmx_csv",
													"type": "DatasetReference",
													"parameters": {
														"par_directory": {
															"value": "@concat(pipeline().parameters.par_folder,'OUTBOUND_LIVE_ARCHIVOS/',variables('var_final_date'),'/')",
															"type": "Expression"
														},
														"par_filename": {
															"value": "@concat('OUTBOUND_LIVE_02_',pipeline().parameters.par_search_type,'_',variables('date_ext'),'.csv')",
															"type": "Expression"
														},
														"par_delimeter": ","
													}
												}
											]
										},
										{
											"name": "api_web API FECHA_EN_PLAN_COPY_03",
											"type": "Copy",
											"dependsOn": [
												{
													"activity": "Set URL Complete with Token_03",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"timeout": "0.12:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"source": {
													"type": "RestSource",
													"httpRequestTimeout": "00:01:40",
													"requestInterval": "00.00:00:00.010",
													"requestMethod": "POST",
													"requestBody": "{}"
												},
												"sink": {
													"type": "DelimitedTextSink",
													"storeSettings": {
														"type": "AzureBlobFSWriteSettings"
													},
													"formatSettings": {
														"type": "DelimitedTextWriteSettings",
														"quoteAllText": true,
														"fileExtension": ".txt"
													}
												},
												"enableStaging": false,
												"translator": {
													"type": "TabularTranslator",
													"mappings": [
														{
															"source": {
																"path": "$['truck']['eco']"
															},
															"sink": {
																"name": "truck_eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['unity']"
															},
															"sink": {
																"name": "unity",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['type_unity']"
															},
															"sink": {
																"name": "type_unity",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['ARRIVE_SOURCE_TRUCK']"
															},
															"sink": {
																"name": "ARRIVE_SOURCE_TRUCK",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['box']"
															},
															"sink": {
																"name": "box",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['note']"
															},
															"sink": {
																"name": "note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['notes']"
															},
															"sink": {
																"name": "source_notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['status']"
															},
															"sink": {
																"name": "status",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['CREATED']['date']"
															},
															"sink": {
																"name": "source_src_plan_CREATED_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['CREATED']['user']"
															},
															"sink": {
																"name": "source_src_plan_CREATED_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['DISPATCH']['date']"
															},
															"sink": {
																"name": "source_src_plan_DISPATCH_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITH_DOC']['date']"
															},
															"sink": {
																"name": "source_src_plan_WITH_DOC_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITH_DOC']['user']"
															},
															"sink": {
																"name": "source_src_plan_WITH_DOC_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['LOAD_START']['date']"
															},
															"sink": {
																"name": "source_src_plan_LOAD_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITHOUT_DOC']['date']"
															},
															"sink": {
																"name": "source_src_plan_WITHOUT_DOC_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITHOUT_DOC']['user']"
															},
															"sink": {
																"name": "source_src_plan_WITHOUT_DOC_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['EXIT']['date']"
															},
															"sink": {
																"name": "source_src_track_EXIT_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['EXIT']['user']"
															},
															"sink": {
																"name": "source_src_track_EXIT_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['INVOICE']['date']"
															},
															"sink": {
																"name": "source_src_track_INVOICE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['INVOICE']['user']"
															},
															"sink": {
																"name": "source_src_track_INVOICE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DISPATCH']['date']"
															},
															"sink": {
																"name": "source_src_track_DISPATCH_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DISPATCH']['user']"
															},
															"sink": {
																"name": "source_src_track_DISPATCH_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ENTRANCE']['date']"
															},
															"sink": {
																"name": "source_src_track_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ENTRANCE']['user']"
															},
															"sink": {
																"name": "source_src_track_ENTRANCE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_END']['date']"
															},
															"sink": {
																"name": "source_src_track_LOAD_END_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_END']['user']"
															},
															"sink": {
																"name": "source_src_track_LOAD_END_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DESK_TRUCK']['date']"
															},
															"sink": {
																"name": "source_src_track_DESK_TRUCK_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_START']['date']"
															},
															"sink": {
																"name": "source_src_track_LOAD_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_START']['user']"
															},
															"sink": {
																"name": "source_src_track_LOAD_START_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ARRIVE_DESK']['date']"
															},
															"sink": {
																"name": "source_src_track_ARRIVE_DESK_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ARRIVE_DESK']['user']"
															},
															"sink": {
																"name": "source_src_track_ARRIVE_DESK_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DESK_TRAILER']['date']"
															},
															"sink": {
																"name": "source_src_track_DESK_TRAILER_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['date']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['user']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['notes']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['auditor']"
															},
															"sink": {
																"name": "auditor",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_START']['date']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_START']['user']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_START_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['driver_exit']"
															},
															"sink": {
																"name": "source_driver_exit",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['ramp']"
															},
															"sink": {
																"name": "ramp",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['seal']"
															},
															"sink": {
																"name": "seal",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['layout']"
															},
															"sink": {
																"name": "layout",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['customs']"
															},
															"sink": {
																"name": "customs",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['coworker']"
															},
															"sink": {
																"name": "coworker",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['seal_type']"
															},
															"sink": {
																"name": "seal_type",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['box_picking']"
															},
															"sink": {
																"name": "box_picking",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['pallets_rack']"
															},
															"sink": {
																"name": "pallets_rack",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['pallets_block']"
															},
															"sink": {
																"name": "pallets_block",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['platform_chep']"
															},
															"sink": {
																"name": "platform_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['platform_white']"
															},
															"sink": {
																"name": "platform_white",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['warehouse_note']"
															},
															"sink": {
																"name": "warehouse_note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['is_committee_priority']"
															},
															"sink": {
																"name": "is_committee_priority",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['date_invoice']"
															},
															"sink": {
																"name": "date_invoice",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['convenio_chep']"
															},
															"sink": {
																"name": "convenio_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['location_name']"
															},
															"sink": {
																"name": "location_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['main_location']"
															},
															"sink": {
																"name": "main_location",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['with_document']"
															},
															"sink": {
																"name": "with_document",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['valuation_note']"
															},
															"sink": {
																"name": "valuation_note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['client']"
															},
															"sink": {
																"name": "client",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['shipto']"
															},
															"sink": {
																"name": "shipto",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny']"
															},
															"sink": {
																"name": "destiny",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['UPDATE_DATE']['date']"
															},
															"sink": {
																"name": "destiny_dst_plan_UPDATE_DATE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['UPDATE_DATE']['user']"
															},
															"sink": {
																"name": "destiny_dst_plan_UPDATE_DATE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['ENTRANCE_DATE']['date']"
															},
															"sink": {
																"name": "destiny_dst_plan_ENTRANCE_DATE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENT_GPS']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ENT_GPS_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['END_UNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_END_UNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['START_UNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_START_UNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DESTINY_ENTRANCE']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_DESTINY_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['population']"
															},
															"sink": {
																"name": "population",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['driver_exit']"
															},
															"sink": {
																"name": "destiny_driver_exit",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['gross_weight']"
															},
															"sink": {
																"name": "gross_weight",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['eco']"
															},
															"sink": {
																"name": "trailer_eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['plate']"
															},
															"sink": {
																"name": "plate",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['assing_user']"
															},
															"sink": {
																"name": "assing_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['assing_trailer']"
															},
															"sink": {
																"name": "assing_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['trailer_update']"
															},
															"sink": {
																"name": "trailer_update",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['update_date_trailer']"
															},
															"sink": {
																"name": "update_date_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['update_user_trailer']"
															},
															"sink": {
																"name": "update_user_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['ARRIVE_SOURCE_TRAILER']"
															},
															"sink": {
																"name": "ARRIVE_SOURCE_TRAILER",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['carga_tm']"
															},
															"sink": {
																"name": "carga_tm",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['semaforo']"
															},
															"sink": {
																"name": "semaforo",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['user']"
															},
															"sink": {
																"name": "supplier_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['company_name']"
															},
															"sink": {
																"name": "company_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['last_company_update']"
															},
															"sink": {
																"name": "last_company_update",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['deliveries']"
															},
															"sink": {
																"name": "deliveries",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['confirmation']"
															},
															"sink": {
																"name": "confirmation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supply_chain']"
															},
															"sink": {
																"name": "supply_chain",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['type_operation']"
															},
															"sink": {
																"name": "type_operation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['grupo_comercial']"
															},
															"sink": {
																"name": "grupo_comercial",
																"type": "String"
															}
														}
													],
													"collectionReference": ""
												}
											},
											"inputs": [
												{
													"referenceName": "nmex_rest_dataset_api",
													"type": "DatasetReference",
													"parameters": {
														"url_dataset_post_rest_api": {
															"value": "@variables('url_complete_03')",
															"type": "Expression"
														}
													}
												}
											],
											"outputs": [
												{
													"referenceName": "ds_adsl2_origenesmx_csv",
													"type": "DatasetReference",
													"parameters": {
														"par_directory": {
															"value": "@concat(pipeline().parameters.par_folder,'OUTBOUND_LIVE_ARCHIVOS/',variables('var_final_date'),'/')",
															"type": "Expression"
														},
														"par_filename": {
															"value": "@concat('OUTBOUND_LIVE_03_',pipeline().parameters.par_search_type,'_',variables('date_ext'),'.csv')",
															"type": "Expression"
														},
														"par_delimeter": ","
													}
												}
											]
										}
									]
								},
								{
									"value": "INBOUND_LIVE",
									"activities": [
										{
											"name": "api_web API FECHA_CREACION_COPY_01_IN",
											"type": "Copy",
											"dependsOn": [
												{
													"activity": "Set URL Complete with Token_01_IN",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"timeout": "0.12:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"source": {
													"type": "RestSource",
													"httpRequestTimeout": "00:01:40",
													"requestInterval": "00.00:00:00.010",
													"requestMethod": "POST",
													"requestBody": "{}"
												},
												"sink": {
													"type": "DelimitedTextSink",
													"storeSettings": {
														"type": "AzureBlobFSWriteSettings"
													},
													"formatSettings": {
														"type": "DelimitedTextWriteSettings",
														"quoteAllText": true,
														"fileExtension": ".txt"
													}
												},
												"enableStaging": false,
												"translator": {
													"type": "TabularTranslator",
													"mappings": [
														{
															"source": {
																"path": "$['source']['location_name']"
															},
															"sink": {
																"name": "location_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['status']"
															},
															"sink": {
																"name": "status",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['date_gi']"
															},
															"sink": {
																"name": "date_gi",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny']"
															},
															"sink": {
																"name": "destiny",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['STAY']['hours']"
															},
															"sink": {
																"name": "hours",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['RAMP_ON']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_RAMP_ON_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENTRANCE']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENTRANCE']['rcontrol']"
															},
															"sink": {
																"name": "rcontrol",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ON_DOWNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ON_DOWNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DOWNLOAD_ON_CUSTOM']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_DOWNLOAD_ON_CUSTOM_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DOWNLOAD_ON_CUSTOM']['user']"
															},
															"sink": {
																"name": "user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['STO']"
															},
															"sink": {
																"name": "STO",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['ramp']"
															},
															"sink": {
																"name": "ramp",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['notes']"
															},
															"sink": {
																"name": "notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['auditor']"
															},
															"sink": {
																"name": "auditor",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['customs']"
															},
															"sink": {
																"name": "customs",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['picking']"
															},
															"sink": {
																"name": "picking",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['coworker']"
															},
															"sink": {
																"name": "coworker",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['number_chep']"
															},
															"sink": {
																"name": "number_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['seal_number']"
															},
															"sink": {
																"name": "seal_number",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['temperature']"
															},
															"sink": {
																"name": "temperature",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['pallets_rack']"
															},
															"sink": {
																"name": "pallets_rack",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['pallets_block']"
															},
															"sink": {
																"name": "pallets_block",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['eco']"
															},
															"sink": {
																"name": "eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['box_type']"
															},
															"sink": {
																"name": "box_type",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['carga_tm']"
															},
															"sink": {
																"name": "carga_tm",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['priority']"
															},
															"sink": {
																"name": "priority",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['company_name']"
															},
															"sink": {
																"name": "company_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['circuit_name']"
															},
															"sink": {
																"name": "circuit_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['type_operation']"
															},
															"sink": {
																"name": "type_operation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['grupo_comercial']"
															},
															"sink": {
																"name": "grupo_comercial",
																"type": "String"
															}
														}
													],
													"collectionReference": ""
												}
											},
											"inputs": [
												{
													"referenceName": "nmex_rest_dataset_api",
													"type": "DatasetReference",
													"parameters": {
														"url_dataset_post_rest_api": {
															"value": "@variables('url_complete')",
															"type": "Expression"
														}
													}
												}
											],
											"outputs": [
												{
													"referenceName": "ds_adsl2_origenesmx_csv",
													"type": "DatasetReference",
													"parameters": {
														"par_directory": {
															"value": "@concat(pipeline().parameters.par_folder,'INBOUND_LIVE_ARCHIVOS/',variables('var_final_date'),'/')",
															"type": "Expression"
														},
														"par_filename": {
															"value": "@concat('INBOUND_LIVE_01_',pipeline().parameters.par_search_type,'_',variables('date_ext'),'.csv')",
															"type": "Expression"
														},
														"par_delimeter": ","
													}
												}
											]
										},
										{
											"name": "Set URL Complete with Token_01_IN",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "Set Parameters Copy 01_IN",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "url_complete",
												"value": {
													"value": "@concat(pipeline().parameters.par_url_base,pipeline().parameters.par_function,'?token=',activity('web api auth').output.token,'&parameters=',variables('var_parameters'))",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set Parameters Copy 01_IN",
											"type": "SetVariable",
											"dependsOn": [],
											"policy": {
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "var_parameters",
												"value": {
													"value": "@if(empty(pipeline().parameters.par_status),\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"initial_date\":\"',variables('var_fecha_01'),'\",\"final_date\":\"', variables('var_fecha_hoy'),'\"}}')\n    ,\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"status\":\"',pipeline().parameters.par_status,'\",\"initial_date\":\"',variables('var_fecha_01'),'\",\"final_date\":\"', variables('var_fecha_hoy'),'\"}}')\n    )",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set Parameters Copy 02_IN",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "api_web API FECHA_CREACION_COPY_01_IN",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "var_parameters_02",
												"value": {
													"value": "@if(empty(pipeline().parameters.par_status),\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"initial_date\":\"',variables('var_fecha_02'),'\",\"final_date\":\"', variables('var_fecha_01'),'\"}}')\n    ,\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"status\":\"',pipeline().parameters.par_status,'\",\"initial_date\":\"',variables('var_fecha_02'),'\",\"final_date\":\"', variables('var_fecha_01'),'\"}}')\n    )",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set Parameters Copy 03_IN",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "api_web API FECHA_CREACION_COPY_02_IN",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "var_parameters_03",
												"value": {
													"value": "@if(empty(pipeline().parameters.par_status),\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"initial_date\":\"',variables('var_fecha_02'),'\",\"final_date\":\"', variables('var_fecha_01'),'\"}}')\n    ,\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"status\":\"SI9\",\"initial_date\":\"',variables('var_fecha_02'),'\",\"final_date\":\"', variables('var_fecha_01'),'\"}}')\n    )",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set URL Complete with Token_02_IN",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "Set Parameters Copy 02_IN",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "url_complete_02",
												"value": {
													"value": "@concat(pipeline().parameters.par_url_base,pipeline().parameters.par_function,'?token=',activity('web api auth').output.token,'&parameters=',variables('var_parameters_02'))",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set URL Complete with Token_03_copy1",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "Set Parameters Copy 03_IN",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "url_complete_03",
												"value": {
													"value": "@concat(pipeline().parameters.par_url_base,pipeline().parameters.par_function,'?token=',activity('web api auth').output.token,'&parameters=',variables('var_parameters_03'))",
													"type": "Expression"
												}
											}
										},
										{
											"name": "api_web API FECHA_CREACION_COPY_02_IN",
											"type": "Copy",
											"dependsOn": [
												{
													"activity": "Set URL Complete with Token_02_IN",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"timeout": "0.12:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"source": {
													"type": "RestSource",
													"httpRequestTimeout": "00:01:40",
													"requestInterval": "00.00:00:00.010",
													"requestMethod": "POST",
													"requestBody": "{}"
												},
												"sink": {
													"type": "DelimitedTextSink",
													"storeSettings": {
														"type": "AzureBlobFSWriteSettings"
													},
													"formatSettings": {
														"type": "DelimitedTextWriteSettings",
														"quoteAllText": true,
														"fileExtension": ".txt"
													}
												},
												"enableStaging": false,
												"translator": {
													"type": "TabularTranslator",
													"mappings": [
														{
															"source": {
																"path": "$['source']['location_name']"
															},
															"sink": {
																"name": "location_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['status']"
															},
															"sink": {
																"name": "status",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['date_gi']"
															},
															"sink": {
																"name": "date_gi",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny']"
															},
															"sink": {
																"name": "destiny",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['STAY']['hours']"
															},
															"sink": {
																"name": "hours",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['RAMP_ON']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_RAMP_ON_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENTRANCE']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENTRANCE']['rcontrol']"
															},
															"sink": {
																"name": "rcontrol",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ON_DOWNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ON_DOWNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DOWNLOAD_ON_CUSTOM']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_DOWNLOAD_ON_CUSTOM_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DOWNLOAD_ON_CUSTOM']['user']"
															},
															"sink": {
																"name": "user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['STO']"
															},
															"sink": {
																"name": "STO",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['ramp']"
															},
															"sink": {
																"name": "ramp",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['notes']"
															},
															"sink": {
																"name": "notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['auditor']"
															},
															"sink": {
																"name": "auditor",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['customs']"
															},
															"sink": {
																"name": "customs",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['picking']"
															},
															"sink": {
																"name": "picking",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['coworker']"
															},
															"sink": {
																"name": "coworker",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['number_chep']"
															},
															"sink": {
																"name": "number_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['seal_number']"
															},
															"sink": {
																"name": "seal_number",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['temperature']"
															},
															"sink": {
																"name": "temperature",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['pallets_rack']"
															},
															"sink": {
																"name": "pallets_rack",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['pallets_block']"
															},
															"sink": {
																"name": "pallets_block",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['eco']"
															},
															"sink": {
																"name": "eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['box_type']"
															},
															"sink": {
																"name": "box_type",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['carga_tm']"
															},
															"sink": {
																"name": "carga_tm",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['priority']"
															},
															"sink": {
																"name": "priority",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['company_name']"
															},
															"sink": {
																"name": "company_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['circuit_name']"
															},
															"sink": {
																"name": "circuit_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['type_operation']"
															},
															"sink": {
																"name": "type_operation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['grupo_comercial']"
															},
															"sink": {
																"name": "grupo_comercial",
																"type": "String"
															}
														}
													],
													"collectionReference": ""
												}
											},
											"inputs": [
												{
													"referenceName": "nmex_rest_dataset_api",
													"type": "DatasetReference",
													"parameters": {
														"url_dataset_post_rest_api": {
															"value": "@variables('url_complete_02')",
															"type": "Expression"
														}
													}
												}
											],
											"outputs": [
												{
													"referenceName": "ds_adsl2_origenesmx_csv",
													"type": "DatasetReference",
													"parameters": {
														"par_directory": {
															"value": "@concat(pipeline().parameters.par_folder,'INBOUND_LIVE_ARCHIVOS/',variables('var_final_date'),'/')",
															"type": "Expression"
														},
														"par_filename": {
															"value": "@concat('INBOUND_LIVE_02_',pipeline().parameters.par_search_type,'_',variables('date_ext'),'.csv')",
															"type": "Expression"
														},
														"par_delimeter": ","
													}
												}
											]
										},
										{
											"name": "api_web API FECHA_CREACION_COPY_03_IN",
											"type": "Copy",
											"dependsOn": [
												{
													"activity": "Set URL Complete with Token_03_copy1",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"timeout": "0.12:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"source": {
													"type": "RestSource",
													"httpRequestTimeout": "00:01:40",
													"requestInterval": "00.00:00:00.010",
													"requestMethod": "POST",
													"requestBody": "{}"
												},
												"sink": {
													"type": "DelimitedTextSink",
													"storeSettings": {
														"type": "AzureBlobFSWriteSettings"
													},
													"formatSettings": {
														"type": "DelimitedTextWriteSettings",
														"quoteAllText": true,
														"fileExtension": ".txt"
													}
												},
												"enableStaging": false,
												"translator": {
													"type": "TabularTranslator",
													"mappings": [
														{
															"source": {
																"path": "$['source']['location_name']"
															},
															"sink": {
																"name": "location_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['status']"
															},
															"sink": {
																"name": "status",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['date_gi']"
															},
															"sink": {
																"name": "date_gi",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny']"
															},
															"sink": {
																"name": "destiny",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['STAY']['hours']"
															},
															"sink": {
																"name": "hours",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['RAMP_ON']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_RAMP_ON_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENTRANCE']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENTRANCE']['rcontrol']"
															},
															"sink": {
																"name": "rcontrol",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ON_DOWNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ON_DOWNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DOWNLOAD_ON_CUSTOM']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_DOWNLOAD_ON_CUSTOM_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DOWNLOAD_ON_CUSTOM']['user']"
															},
															"sink": {
																"name": "user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['STO']"
															},
															"sink": {
																"name": "STO",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['ramp']"
															},
															"sink": {
																"name": "ramp",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['notes']"
															},
															"sink": {
																"name": "notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['auditor']"
															},
															"sink": {
																"name": "auditor",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['customs']"
															},
															"sink": {
																"name": "customs",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['picking']"
															},
															"sink": {
																"name": "picking",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['coworker']"
															},
															"sink": {
																"name": "coworker",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['number_chep']"
															},
															"sink": {
																"name": "number_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['seal_number']"
															},
															"sink": {
																"name": "seal_number",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['temperature']"
															},
															"sink": {
																"name": "temperature",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['pallets_rack']"
															},
															"sink": {
																"name": "pallets_rack",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['pallets_block']"
															},
															"sink": {
																"name": "pallets_block",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['eco']"
															},
															"sink": {
																"name": "eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['box_type']"
															},
															"sink": {
																"name": "box_type",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['carga_tm']"
															},
															"sink": {
																"name": "carga_tm",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['priority']"
															},
															"sink": {
																"name": "priority",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['company_name']"
															},
															"sink": {
																"name": "company_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['circuit_name']"
															},
															"sink": {
																"name": "circuit_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['type_operation']"
															},
															"sink": {
																"name": "type_operation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['grupo_comercial']"
															},
															"sink": {
																"name": "grupo_comercial",
																"type": "String"
															}
														}
													],
													"collectionReference": ""
												}
											},
											"inputs": [
												{
													"referenceName": "nmex_rest_dataset_api",
													"type": "DatasetReference",
													"parameters": {
														"url_dataset_post_rest_api": {
															"value": "@variables('url_complete_03')",
															"type": "Expression"
														}
													}
												}
											],
											"outputs": [
												{
													"referenceName": "ds_adsl2_origenesmx_csv",
													"type": "DatasetReference",
													"parameters": {
														"par_directory": {
															"value": "@concat(pipeline().parameters.par_folder,'INBOUND_LIVE_ARCHIVOS/',variables('var_final_date'),'/')",
															"type": "Expression"
														},
														"par_filename": {
															"value": "@concat('INBOUND_LIVE_03_',pipeline().parameters.par_search_type,'_',variables('date_ext'),'.csv')",
															"type": "Expression"
														},
														"par_delimeter": ","
													}
												}
											]
										}
									]
								},
								{
									"value": "OUTBOUND_HISTORICO",
									"activities": [
										{
											"name": "api_web API DESPACHO_REAL_HIST_COPY_01",
											"type": "Copy",
											"dependsOn": [
												{
													"activity": "Set URL Complete with Token_01_H",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"timeout": "0.12:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"source": {
													"type": "RestSource",
													"httpRequestTimeout": "00:01:40",
													"requestInterval": "00.00:00:00.010",
													"requestMethod": "POST",
													"requestBody": "{}"
												},
												"sink": {
													"type": "DelimitedTextSink",
													"storeSettings": {
														"type": "AzureBlobFSWriteSettings"
													},
													"formatSettings": {
														"type": "DelimitedTextWriteSettings",
														"quoteAllText": true,
														"fileExtension": ".txt"
													}
												},
												"enableStaging": false,
												"translator": {
													"type": "TabularTranslator",
													"mappings": [
														{
															"source": {
																"path": "$['truck']['eco']"
															},
															"sink": {
																"name": "truck_eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['unity']"
															},
															"sink": {
																"name": "unity",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['type_unity']"
															},
															"sink": {
																"name": "type_unity",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['truck']['ARRIVE_SOURCE_TRUCK']"
															},
															"sink": {
																"name": "ARRIVE_SOURCE_TRUCK",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['box']"
															},
															"sink": {
																"name": "box",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['note']"
															},
															"sink": {
																"name": "note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['notes']"
															},
															"sink": {
																"name": "source_notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['status']"
															},
															"sink": {
																"name": "status",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['CREATED']['date']"
															},
															"sink": {
																"name": "source_src_plan_CREATED_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['CREATED']['user']"
															},
															"sink": {
																"name": "source_src_plan_CREATED_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['DISPATCH']['date']"
															},
															"sink": {
																"name": "source_src_plan_DISPATCH_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITH_DOC']['date']"
															},
															"sink": {
																"name": "source_src_plan_WITH_DOC_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITH_DOC']['user']"
															},
															"sink": {
																"name": "source_src_plan_WITH_DOC_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['LOAD_START']['date']"
															},
															"sink": {
																"name": "source_src_plan_LOAD_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITHOUT_DOC']['date']"
															},
															"sink": {
																"name": "source_src_plan_WITHOUT_DOC_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_plan']['WITHOUT_DOC']['user']"
															},
															"sink": {
																"name": "source_src_plan_WITHOUT_DOC_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['EXIT']['date']"
															},
															"sink": {
																"name": "source_src_track_EXIT_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['EXIT']['user']"
															},
															"sink": {
																"name": "source_src_track_EXIT_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['INVOICE']['date']"
															},
															"sink": {
																"name": "source_src_track_INVOICE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['INVOICE']['user']"
															},
															"sink": {
																"name": "source_src_track_INVOICE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DISPATCH']['date']"
															},
															"sink": {
																"name": "source_src_track_DISPATCH_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DISPATCH']['user']"
															},
															"sink": {
																"name": "source_src_track_DISPATCH_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ENTRANCE']['date']"
															},
															"sink": {
																"name": "source_src_track_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ENTRANCE']['user']"
															},
															"sink": {
																"name": "source_src_track_ENTRANCE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_END']['date']"
															},
															"sink": {
																"name": "source_src_track_LOAD_END_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_END']['user']"
															},
															"sink": {
																"name": "source_src_track_LOAD_END_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DESK_TRUCK']['date']"
															},
															"sink": {
																"name": "source_src_track_DESK_TRUCK_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_START']['date']"
															},
															"sink": {
																"name": "source_src_track_LOAD_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['LOAD_START']['user']"
															},
															"sink": {
																"name": "source_src_track_LOAD_START_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ARRIVE_DESK']['date']"
															},
															"sink": {
																"name": "source_src_track_ARRIVE_DESK_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['ARRIVE_DESK']['user']"
															},
															"sink": {
																"name": "source_src_track_ARRIVE_DESK_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['DESK_TRAILER']['date']"
															},
															"sink": {
																"name": "source_src_track_DESK_TRAILER_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['date']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['user']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['notes']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_END_notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_END']['auditor']"
															},
															"sink": {
																"name": "auditor",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_START']['date']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_START_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['src_track']['PREPARATION_START']['user']"
															},
															"sink": {
																"name": "source_src_track_PREPARATION_START_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['driver_exit']"
															},
															"sink": {
																"name": "source_driver_exit",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['ramp']"
															},
															"sink": {
																"name": "ramp",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['seal']"
															},
															"sink": {
																"name": "seal",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['layout']"
															},
															"sink": {
																"name": "layout",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['customs']"
															},
															"sink": {
																"name": "customs",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['coworker']"
															},
															"sink": {
																"name": "coworker",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['seal_type']"
															},
															"sink": {
																"name": "seal_type",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['box_picking']"
															},
															"sink": {
																"name": "box_picking",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['pallets_rack']"
															},
															"sink": {
																"name": "pallets_rack",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['pallets_block']"
															},
															"sink": {
																"name": "pallets_block",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['platform_chep']"
															},
															"sink": {
																"name": "platform_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['platform_white']"
															},
															"sink": {
																"name": "platform_white",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['warehouse_note']"
															},
															"sink": {
																"name": "warehouse_note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['preparation']['is_committee_priority']"
															},
															"sink": {
																"name": "is_committee_priority",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['date_invoice']"
															},
															"sink": {
																"name": "date_invoice",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['convenio_chep']"
															},
															"sink": {
																"name": "convenio_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['location_name']"
															},
															"sink": {
																"name": "location_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['main_location']"
															},
															"sink": {
																"name": "main_location",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['with_document']"
															},
															"sink": {
																"name": "with_document",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['source']['valuation_note']"
															},
															"sink": {
																"name": "valuation_note",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['client']"
															},
															"sink": {
																"name": "client",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['shipto']"
															},
															"sink": {
																"name": "shipto",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny']"
															},
															"sink": {
																"name": "destiny",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['UPDATE_DATE']['date']"
															},
															"sink": {
																"name": "destiny_dst_plan_UPDATE_DATE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['UPDATE_DATE']['user']"
															},
															"sink": {
																"name": "destiny_dst_plan_UPDATE_DATE_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_plan']['ENTRANCE_DATE']['date']"
															},
															"sink": {
																"name": "destiny_dst_plan_ENTRANCE_DATE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENT_GPS']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ENT_GPS_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['END_UNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_END_UNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['START_UNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_START_UNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DESTINY_ENTRANCE']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_DESTINY_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['population']"
															},
															"sink": {
																"name": "population",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['driver_exit']"
															},
															"sink": {
																"name": "destiny_driver_exit",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['gross_weight']"
															},
															"sink": {
																"name": "gross_weight",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['eco']"
															},
															"sink": {
																"name": "trailer_eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['plate']"
															},
															"sink": {
																"name": "plate",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['assing_user']"
															},
															"sink": {
																"name": "assing_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['assing_trailer']"
															},
															"sink": {
																"name": "assing_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['trailer_update']"
															},
															"sink": {
																"name": "trailer_update",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['update_date_trailer']"
															},
															"sink": {
																"name": "update_date_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['update_user_trailer']"
															},
															"sink": {
																"name": "update_user_trailer",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['ARRIVE_SOURCE_TRAILER']"
															},
															"sink": {
																"name": "ARRIVE_SOURCE_TRAILER",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['carga_tm']"
															},
															"sink": {
																"name": "carga_tm",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['semaforo']"
															},
															"sink": {
																"name": "semaforo",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['user']"
															},
															"sink": {
																"name": "supplier_user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['company_name']"
															},
															"sink": {
																"name": "company_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['last_company_update']"
															},
															"sink": {
																"name": "last_company_update",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['deliveries']"
															},
															"sink": {
																"name": "deliveries",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['confirmation']"
															},
															"sink": {
																"name": "confirmation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supply_chain']"
															},
															"sink": {
																"name": "supply_chain",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['type_operation']"
															},
															"sink": {
																"name": "type_operation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['grupo_comercial']"
															},
															"sink": {
																"name": "grupo_comercial",
																"type": "String"
															}
														}
													],
													"collectionReference": ""
												}
											},
											"inputs": [
												{
													"referenceName": "nmex_rest_dataset_api",
													"type": "DatasetReference",
													"parameters": {
														"url_dataset_post_rest_api": {
															"value": "@variables('url_complete')",
															"type": "Expression"
														}
													}
												}
											],
											"outputs": [
												{
													"referenceName": "ds_adsl2_origenesmx_csv",
													"type": "DatasetReference",
													"parameters": {
														"par_directory": {
															"value": "@concat(pipeline().parameters.par_folder,'OUTBOUND_HISTORICO_ARCHIVOS/',variables('var_final_date'),'/')",
															"type": "Expression"
														},
														"par_filename": {
															"value": "@concat('OUTBOUND_HISTORICO_01_',pipeline().parameters.par_search_type,'_',variables('date_ext'),'.csv')",
															"type": "Expression"
														},
														"par_delimeter": ","
													}
												}
											]
										},
										{
											"name": "Set URL Complete with Token_01_H",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "Set Parameters Copy 01_H",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "url_complete",
												"value": {
													"value": "@concat(pipeline().parameters.par_url_base,pipeline().parameters.par_function,'?token=',activity('web api auth').output.token,'&parameters=',variables('var_parameters'))",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set Parameters Copy 01_H",
											"type": "SetVariable",
											"dependsOn": [],
											"policy": {
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "var_parameters",
												"value": {
													"value": "@if(empty(pipeline().parameters.par_status),\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"initial_date\":\"',variables('var_fecha_ayer_00'),'\",\"final_date\":\"', variables('var_fecha_ayer_23'),'\"}}')\n    ,\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"status\":\"',pipeline().parameters.par_status,'\",\"initial_date\":\"',variables('var_fecha_ayer_00'),'\",\"final_date\":\"', variables('var_fecha_ayer_23'),'\"}}')\n    )",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"value": "INBOUND_HISTORICO",
									"activities": [
										{
											"name": "api_web API FIN_DESCARGA_HIST_COPY_01_copy1",
											"type": "Copy",
											"dependsOn": [
												{
													"activity": "Set URL Complete with Token_01_H_copy1",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"timeout": "0.12:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"source": {
													"type": "RestSource",
													"httpRequestTimeout": "00:01:40",
													"requestInterval": "00.00:00:00.010",
													"requestMethod": "POST",
													"requestBody": "{}"
												},
												"sink": {
													"type": "DelimitedTextSink",
													"storeSettings": {
														"type": "AzureBlobFSWriteSettings"
													},
													"formatSettings": {
														"type": "DelimitedTextWriteSettings",
														"quoteAllText": true,
														"fileExtension": ".txt"
													}
												},
												"enableStaging": false,
												"translator": {
													"type": "TabularTranslator",
													"mappings": [
														{
															"source": {
																"path": "$['source']['location_name']"
															},
															"sink": {
																"name": "location_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['status']"
															},
															"sink": {
																"name": "status",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['date_gi']"
															},
															"sink": {
																"name": "date_gi",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny']"
															},
															"sink": {
																"name": "destiny",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['STAY']['hours']"
															},
															"sink": {
																"name": "hours",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['RAMP_ON']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_RAMP_ON_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENTRANCE']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ENTRANCE_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ENTRANCE']['rcontrol']"
															},
															"sink": {
																"name": "rcontrol",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['ON_DOWNLOAD']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_ON_DOWNLOAD_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DOWNLOAD_ON_CUSTOM']['date']"
															},
															"sink": {
																"name": "destiny_dst_track_DOWNLOAD_ON_CUSTOM_date",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['dst_track']['DOWNLOAD_ON_CUSTOM']['user']"
															},
															"sink": {
																"name": "user",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['STO']"
															},
															"sink": {
																"name": "STO",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['ramp']"
															},
															"sink": {
																"name": "ramp",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['notes']"
															},
															"sink": {
																"name": "notes",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['auditor']"
															},
															"sink": {
																"name": "auditor",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['customs']"
															},
															"sink": {
																"name": "customs",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['picking']"
															},
															"sink": {
																"name": "picking",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['coworker']"
															},
															"sink": {
																"name": "coworker",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['number_chep']"
															},
															"sink": {
																"name": "number_chep",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['seal_number']"
															},
															"sink": {
																"name": "seal_number",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['temperature']"
															},
															"sink": {
																"name": "temperature",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['pallets_rack']"
															},
															"sink": {
																"name": "pallets_rack",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['destiny']['destiny_complement']['pallets_block']"
															},
															"sink": {
																"name": "pallets_block",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['eco']"
															},
															"sink": {
																"name": "eco",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['trailer']['box_type']"
															},
															"sink": {
																"name": "box_type",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['carga_tm']"
															},
															"sink": {
																"name": "carga_tm",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['priority']"
															},
															"sink": {
																"name": "priority",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['supplier']['company_name']"
															},
															"sink": {
																"name": "company_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['circuit_name']"
															},
															"sink": {
																"name": "circuit_name",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['type_operation']"
															},
															"sink": {
																"name": "type_operation",
																"type": "String"
															}
														},
														{
															"source": {
																"path": "$['grupo_comercial']"
															},
															"sink": {
																"name": "grupo_comercial",
																"type": "String"
															}
														}
													],
													"collectionReference": ""
												}
											},
											"inputs": [
												{
													"referenceName": "nmex_rest_dataset_api",
													"type": "DatasetReference",
													"parameters": {
														"url_dataset_post_rest_api": {
															"value": "@variables('url_complete')",
															"type": "Expression"
														}
													}
												}
											],
											"outputs": [
												{
													"referenceName": "ds_adsl2_origenesmx_csv",
													"type": "DatasetReference",
													"parameters": {
														"par_directory": {
															"value": "@concat(pipeline().parameters.par_folder,'INBOUND_HISTORICO_ARCHIVOS/',variables('var_final_date'),'/')",
															"type": "Expression"
														},
														"par_filename": {
															"value": "@concat('INBOUND_HISTORICO_01_',pipeline().parameters.par_search_type,'_',variables('date_ext'),'.csv')",
															"type": "Expression"
														},
														"par_delimeter": ","
													}
												}
											]
										},
										{
											"name": "Set URL Complete with Token_01_H_copy1",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "Set Parameters Copy 01_H_copy1",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "url_complete",
												"value": {
													"value": "@concat(pipeline().parameters.par_url_base,pipeline().parameters.par_function,'?token=',activity('web api auth').output.token,'&parameters=',variables('var_parameters'))",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set Parameters Copy 01_H_copy1",
											"type": "SetVariable",
											"dependsOn": [],
											"policy": {
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"variableName": "var_parameters",
												"value": {
													"value": "@if(empty(pipeline().parameters.par_status),\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"initial_date\":\"',variables('var_fecha_ayer_00'),'\",\"final_date\":\"', variables('var_fecha_ayer_23'),'\"}}')\n    ,\n    concat('{\"search_filters\": {\"search_type\":\"',pipeline().parameters.par_search_type,'\",\"status\":\"',pipeline().parameters.par_status,'\",\"initial_date\":\"',variables('var_fecha_ayer_00'),'\",\"final_date\":\"', variables('var_fecha_ayer_23'),'\"}}')\n    )",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Fecha Ayer 00",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Fecha Ayer 23",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "var_fecha_ayer_00",
							"value": {
								"value": "@formatDateTime(adddays(convertTimeZone(utcNow(),'UTC','Central Standard Time (Mexico)'),-1),'yyyy-MM-dd 00:00')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Fecha Ayer 23",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Fecha Hoy_02",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "var_fecha_ayer_23",
							"value": {
								"value": "@formatDateTime(adddays(convertTimeZone(utcNow(),'UTC','Central Standard Time (Mexico)'),-1),'yyyy-MM-dd 23:59')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Fecha 01",
						"description": "Fecha 01 = Fecha Actual - 14 Dias",
						"type": "SetVariable",
						"dependsOn": [],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "var_fecha_01",
							"value": {
								"value": "@formatDateTime(adddays(convertTimeZone(utcNow(),'UTC','Central Standard Time (Mexico)'),-14),'yyyy-MM-dd 00:00')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Fecha 02",
						"description": "Fecha 02 = Fecha 01 - 14 Dias",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Fecha 01",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "var_fecha_02",
							"value": {
								"value": "@formatDateTime(adddays(variables('var_fecha_01'),-14),'yyyy-MM-dd 00:00')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Fecha 03",
						"description": "Fecha 03 = Hoy",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Fecha 02",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "var_fecha_03",
							"value": {
								"value": "@formatDateTime(adddays(convertTimeZone(utcNow(),'UTC','Central Standard Time (Mexico)'),-1),'yyyy-MM-dd 23:59')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Fecha Hoy",
						"description": "Fecha Hoy = Hoy 23:59",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Fecha 03",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "var_fecha_hoy",
							"value": {
								"value": "@formatDateTime(convertTimeZone(utcNow(),'UTC','Central Standard Time (Mexico)'),'yyyy-MM-dd 00:00')\n\n",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Fecha Hoy_02",
						"description": "Fecha Hoy = Hoy 23:59",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Fecha Hoy",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "var_fecha_hoy_02",
							"value": {
								"value": "@formatDateTime(convertTimeZone(utcNow(),'UTC','Central Standard Time (Mexico)'),'yyyy-MM-dd 23:59')\n\n",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Execute Carga Tablas",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Switch1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_load_tablas_api_inb_out_alice",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"parFechaExec": {
									"value": "@variables('var_final_date')",
									"type": "Expression"
								},
								"parFechaTabla": {
									"value": "@pipeline().parameters.par_tabla",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Send Error Auth",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "web api auth",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_send_email_notification_alice",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"par_conteudo_email": "Ocorreu um Erro na Autenticação da API",
								"par_lista_email": "rafael.medeiros2@br.nestle.com;yair.atristain@mx.nestle.com;Roberto.Fernandez@mx.nestle.com;valeria.camacho1@mx.nestle.com",
								"par_project_name": "ALICE API",
								"par_status_msg": "Error",
								"par_etapa": {
									"value": "@concat('Auth API - ',pipeline().parameters.par_tabla)",
									"type": "Expression"
								},
								"par_fecha": {
									"value": "@variables('var_final_date')",
									"type": "Expression"
								},
								"par_runid": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Send Error Copy",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Switch1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_send_email_notification_alice",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"par_conteudo_email": "Ocorreu um Erro na Copia dos Dados da API",
								"par_lista_email": "rafael.medeiros2@br.nestle.com;yair.atristain@mx.nestle.com;Roberto.Fernandez@mx.nestle.com;valeria.camacho1@mx.nestle.com",
								"par_project_name": "ALICE API",
								"par_status_msg": "Error",
								"par_etapa": {
									"value": "@concat('Copy Data API - ',pipeline().parameters.par_tabla)",
									"type": "Expression"
								},
								"par_fecha": {
									"value": "@variables('var_final_date')",
									"type": "Expression"
								},
								"par_runid": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Send Error Load",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Execute Carga Tablas",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_send_email_notification_alice",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"par_conteudo_email": "Ocorreu um Erro na Carga das Tabelas no Databricks",
								"par_lista_email": "rafael.medeiros2@br.nestle.com;yair.atristain@mx.nestle.com;Roberto.Fernandez@mx.nestle.com;valeria.camacho1@mx.nestle.com",
								"par_project_name": "ALICE API",
								"par_status_msg": "Error",
								"par_etapa": {
									"value": "@concat('Load Tablas API - ',pipeline().parameters.par_tabla)",
									"type": "Expression"
								},
								"par_fecha": {
									"value": "@variables('var_final_date')",
									"type": "Expression"
								},
								"par_runid": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Send Sucesso",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Execute Carga Tablas",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "pl_send_email_notification_alice",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"par_conteudo_email": "Proceso de carga y copia de datos API completado con éxito",
								"par_lista_email": "rafael.medeiros2@br.nestle.com;yair.atristain@mx.nestle.com;Roberto.Fernandez@mx.nestle.com;valeria.camacho1@mx.nestle.com",
								"par_project_name": "ALICE API",
								"par_status_msg": "Sucesso",
								"par_etapa": {
									"value": "@concat('Fin Carga API Sucesso - ',pipeline().parameters.par_tabla)",
									"type": "Expression"
								},
								"par_fecha": {
									"value": "@variables('var_final_date')",
									"type": "Expression"
								},
								"par_runid": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"par_search_type": {
						"type": "string",
						"defaultValue": "DESPACHO_REAL"
					},
					"par_url": {
						"type": "string",
						"defaultValue": "https://www.rcontrol.com.mx/rcSuite/GetUserToken?arg00=Origenes02&arg01=Temporal1"
					},
					"par_folder": {
						"type": "string",
						"defaultValue": "/inbound/ext_api_files/"
					},
					"par_url_base": {
						"type": "string",
						"defaultValue": "https://www.rcontrol.com.mx/japi/"
					},
					"par_cont": {
						"type": "string",
						"defaultValue": "dev"
					},
					"par_status": {
						"type": "string"
					},
					"par_function": {
						"type": "string",
						"defaultValue": "get_shipment_info_outb"
					},
					"par_tabla": {
						"type": "string"
					}
				},
				"variables": {
					"var_initial_date": {
						"type": "String"
					},
					"var_final_date": {
						"type": "String"
					},
					"date_ext": {
						"type": "String"
					},
					"var_parameters": {
						"type": "String"
					},
					"url_complete": {
						"type": "String"
					},
					"var_fecha_01": {
						"type": "String"
					},
					"var_fecha_02": {
						"type": "String"
					},
					"var_fecha_03": {
						"type": "String"
					},
					"var_fecha_hoy": {
						"type": "String"
					},
					"var_parameters_02": {
						"type": "String"
					},
					"var_parameters_03": {
						"type": "String"
					},
					"url_complete_02": {
						"type": "String"
					},
					"url_complete_03": {
						"type": "String"
					},
					"var_fecha_hoy_02": {
						"type": "String"
					},
					"var_fecha_ayer_00": {
						"type": "String"
					},
					"var_fecha_ayer_23": {
						"type": "String"
					},
					"teste": {
						"type": "String"
					}
				},
				"folder": {
					"name": "amsmx_supply_alice"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-04T16:04:17Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_extract_merge_files')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get Carpeta",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "ds_adsl2_origenesmx_binary",
								"type": "DatasetReference",
								"parameters": {
									"par_directory": {
										"value": "@pipeline().parameters.parPathCopy",
										"type": "Expression"
									},
									"par_filename": {
										"value": "@pipeline().parameters.parFileNameCopy",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "BinaryReadSettings"
							}
						}
					},
					{
						"name": "Filter Archivos Hoy",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "Get Carpeta",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get Carpeta').output.childItems",
								"type": "Expression"
							},
							"condition": {
								"value": "@and(contains(item().name,pipeline().parameters.parFechaAtual),equals(item().type,'File'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ForEach Copy",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Filter Archivos Hoy",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Filter Archivos Hoy').output.value",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Copy Files Hoy",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "BinarySource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "BinaryReadSettings"
											}
										},
										"sink": {
											"type": "BinarySink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "ds_adsl2_origenesmx_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": {
													"value": "@pipeline().parameters.parPathCopy",
													"type": "Expression"
												},
												"par_filename": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ds_adsl2_origenesmx_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": {
													"value": "@concat(pipeline().parameters.parPathDestination,pipeline().parameters.parFechaAtual,'_',pipeline().parameters.parFileNameTitle)",
													"type": "Expression"
												},
												"par_filename": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Delete Files",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "Copy Files Hoy",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "ds_adsl2_origenesmx_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": {
													"value": "@pipeline().parameters.parPathCopy",
													"type": "Expression"
												},
												"par_filename": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "AzureBlobFSReadSettings",
											"recursive": true,
											"enablePartitionDiscovery": false
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"parFileNameCopy": {
						"type": "string"
					},
					"parPathCopy": {
						"type": "string"
					},
					"parPathDestination": {
						"type": "string"
					},
					"parFileNameTitle": {
						"type": "string"
					},
					"parContainer": {
						"type": "string"
					},
					"parFechaAtual": {
						"type": "string"
					}
				},
				"folder": {
					"name": "amsmx_supply_alice"
				},
				"annotations": [],
				"lastPublishTime": "2023-06-02T19:16:28Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_extract_move_blob_to_blob')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get Carpeta",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "ds_sc_nmex_devorigmx_generic",
								"type": "DatasetReference",
								"parameters": {
									"par_container": {
										"value": "@pipeline().parameters.parContainer",
										"type": "Expression"
									},
									"par_diretorio": {
										"value": "@pipeline().parameters.parPathCopy",
										"type": "Expression"
									},
									"par_arquivo": {
										"value": "@pipeline().parameters.parFileNameCopy",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "BinaryReadSettings"
							}
						}
					},
					{
						"name": "Filter Archivos Hoy",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "Get Carpeta",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get Carpeta').output.childItems",
								"type": "Expression"
							},
							"condition": {
								"value": "@equals(item().type,'File')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ForEach Copy",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Filter Archivos Hoy",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Filter Archivos Hoy').output.value",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Copy Files Hoy",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "BinarySource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "BinaryReadSettings"
											}
										},
										"sink": {
											"type": "BinarySink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "ds_adsl2_origenesmx_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": {
													"value": "@pipeline().parameters.parPathCopy",
													"type": "Expression"
												},
												"par_filename": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ds_adsl2_origenesmx_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": {
													"value": "@concat(pipeline().parameters.parPathDestination,pipeline().parameters.parFechaAtual,'_',pipeline().parameters.parFileNameTitle)",
													"type": "Expression"
												},
												"par_filename": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Delete",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "Copy Files Hoy",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "ds_adsl2_origenesmx_binary",
											"type": "DatasetReference",
											"parameters": {
												"par_directory": {
													"value": "@pipeline().parameters.parPathCopy",
													"type": "Expression"
												},
												"par_filename": {
													"value": "@item().name",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "AzureBlobFSReadSettings",
											"recursive": true,
											"wildcardFileName": {
												"value": "@{item().name}",
												"type": "Expression"
											},
											"enablePartitionDiscovery": false
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"parFileNameCopy": {
						"type": "string"
					},
					"parPathCopy": {
						"type": "string"
					},
					"parPathDestination": {
						"type": "string"
					},
					"parFileNameTitle": {
						"type": "string"
					},
					"parContainer": {
						"type": "string"
					},
					"parFechaAtual": {
						"type": "string"
					}
				},
				"folder": {
					"name": "amsmx_supply_alice"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-24T22:29:43Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pl_extract_move_blob_to_blob_filter')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get Metadata Alice",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "ds_adsl2_origenesmx_binary",
								"type": "DatasetReference",
								"parameters": {
									"par_directory": {
										"value": "@pipeline().parameters.parPathCopy",
										"type": "Expression"
									},
									"par_filename": {
										"value": "@pipeline().parameters.parFolderName",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobFSReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "BinaryReadSettings"
							}
						}
					},
					{
						"name": "ForEach Folders",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Filter Folder",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Filter Folder').output.value",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Get Metadata Inside Folder",
									"type": "GetMetadata",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "ds_adsl2_origenesmx_binary_source",
											"type": "DatasetReference",
											"parameters": {
												"parContName": {
													"value": "@pipeline().parameters.parContName",
													"type": "Expression"
												},
												"parPathCopy": {
													"value": "@concat(pipeline().parameters.parPathCopy,item().name)",
													"type": "Expression"
												}
											}
										},
										"fieldList": [
											"childItems",
											"itemName"
										],
										"storeSettings": {
											"type": "AzureBlobFSReadSettings",
											"recursive": true,
											"enablePartitionDiscovery": false
										},
										"formatSettings": {
											"type": "BinaryReadSettings"
										}
									}
								},
								{
									"name": "Copy Folder Content",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Get Metadata Inside Folder",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "BinarySource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"wildcardFolderPath": {
													"value": "@concat(pipeline().parameters.parPathCopy,item().name)",
													"type": "Expression"
												},
												"wildcardFileName": "*",
												"deleteFilesAfterCompletion": false
											},
											"formatSettings": {
												"type": "BinaryReadSettings"
											}
										},
										"sink": {
											"type": "BinarySink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											}
										},
										"enableStaging": false
									},
									"inputs": [
										{
											"referenceName": "ds_adsl2_origenesmx_binary_source",
											"type": "DatasetReference",
											"parameters": {
												"parContName": {
													"value": "@pipeline().parameters.parContName",
													"type": "Expression"
												},
												"parPathCopy": {
													"value": "@pipeline().parameters.parPathCopy",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ds_adsl2_origenesmx_binary_sink",
											"type": "DatasetReference",
											"parameters": {
												"parContName": {
													"value": "@pipeline().parameters.parContName",
													"type": "Expression"
												},
												"parPathDestination": {
													"value": "@concat(pipeline().parameters.parPathDestination,'/',item().name)",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Delete Files and Folders",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "Copy Folder Content",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "ds_adsl2_origenesmx_binary_source",
											"type": "DatasetReference",
											"parameters": {
												"parContName": {
													"value": "@pipeline().parameters.parContName",
													"type": "Expression"
												},
												"parPathCopy": {
													"value": "@{concat(pipeline().parameters.parPathCopy,item().name)}",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "AzureBlobFSReadSettings",
											"recursive": true,
											"enablePartitionDiscovery": false
										}
									}
								}
							]
						}
					},
					{
						"name": "Filter Folder",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "Get Metadata Alice",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get Metadata Alice').output.childItems",
								"type": "Expression"
							},
							"condition": {
								"value": "@equals(item().type,'Folder')",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"parFolderName": {
						"type": "string"
					},
					"parContName": {
						"type": "string"
					},
					"parPathCopy": {
						"type": "string"
					},
					"parPathDestination": {
						"type": "string"
					}
				},
				"variables": {
					"varFiles30Days": {
						"type": "String"
					},
					"varReferenceDate": {
						"type": "String",
						"defaultValue": "1900-01-01 00:00:00"
					}
				},
				"folder": {
					"name": "amsmx_supply_alice"
				},
				"annotations": [],
				"lastPublishTime": "2023-05-19T16:52:50Z"
			},
			"dependsOn": []
		}
	]
}