{"name":"Visitas","description":"","version":"1.0","culture":"es-ES","modifiedTime":"2021-02-09T07:16:02.6432285+00:00","pbi:mashup":{"fastCombine":false,"allowNativeQueries":false,"queriesMetadata":{"07 Visitas":{"queryId":"1cf0d8f4-33ef-4a4c-acbc-ec0a9a6d98dc","queryName":"07 Visitas","loadEnabled":true},"Archivo de ejemplo":{"queryId":"7a532a96-5de0-4b85-bbf4-e1abc8f10179","queryName":"Archivo de ejemplo","queryGroupId":"9249fe5a-27b1-4759-adc2-acc97eda55ba"},"Parámetro":{"queryId":"e5c7ba36-3cc9-4909-b8da-3dcf1a5f317d","queryName":"Parámetro","queryGroupId":"9249fe5a-27b1-4759-adc2-acc97eda55ba"},"Transformar Archivo de ejemplo":{"queryId":"a0531daf-7023-4ee8-ac3f-9527b1309189","queryName":"Transformar Archivo de ejemplo","queryGroupId":"1133ee19-c804-4fbf-9158-a21c38c1019f"},"Transformar archivo":{"queryId":"6031049b-1ba2-4194-9745-331061223014","queryName":"Transformar archivo","queryGroupId":"9249fe5a-27b1-4759-adc2-acc97eda55ba"}},"document":"section Section1;\r\nshared #\"07 Visitas\" = let\r\n  Origen = Folder.Files(\"C:\\Users\\user\\Desktop\\07 Visitas\"),\r\n  #\"Archivos ocultos filtrados\" = Table.SelectRows(Origen, each [Attributes]?[Hidden]? <> true),\r\n  #\"Invocar función personalizada\" = Table.AddColumn(#\"Archivos ocultos filtrados\", \"Transformar archivo\", each #\"Transformar archivo\"([Content])),\r\n  #\"Columnas con nombre cambiado\" = Table.RenameColumns(#\"Invocar función personalizada\", {{\"Name\", \"Source.Name\"}}),\r\n  #\"Se han quitado otras columnas.\" = Table.SelectColumns(#\"Columnas con nombre cambiado\", {\"Source.Name\", \"Transformar archivo\"}),\r\n  #\"Columna de tabla expandida\" = Table.ExpandTableColumn(#\"Se han quitado otras columnas.\", \"Transformar archivo\", Table.ColumnNames(#\"Transformar archivo\"(#\"Archivo de ejemplo\"))),\r\n  #\"Tipo de columna cambiado\" = Table.TransformColumnTypes(#\"Columna de tabla expandida\", {{\"Source.Name\", type text}, {\"FECHA\", type date}, {\"HORA\", type text}, {\"ID VISITA\", Int64.Type}, {\"IDPOS\", Int64.Type}, {\"NOMBRE PUNTO\", type text}, {\"REGIONAL\", type text}, {\"RUTA\", type text}, {\"CIRCUITO\", type text}, {\"VISITA\", type text}, {\"PROCESO\", type text}, {\"MOTIVO\", type text}, {\"OBSERVACION\", type text}, {\"LATITUD\", Int64.Type}, {\"LONGITUD\", Int64.Type}, {\"ASESOR\", type text}, {\"PRECISION GPS\", Int64.Type}, {\"FECHA Y HORA GPS\", type datetime}, {\"QR\", type text}, {\"OBSERVACION QR\", type text}, {\"POSICION SIMULADA\", type text}, {\"\", type text}}),\r\n  #\"Columnas con nombre cambiado 1\" = Table.RenameColumns(#\"Tipo de columna cambiado\", {{\"\", \"_\"}}),\r\n  #\"Tipo de columna cambiado 1\" = Table.TransformColumnTypes(#\"Columnas con nombre cambiado 1\", {{\"FECHA Y HORA GPS\", type date}}),\r\n  #\"Columnas quitadas\" = Table.RemoveColumns(#\"Tipo de columna cambiado 1\", {\"FECHA Y HORA GPS\"})\r\nin\r\n  #\"Columnas quitadas\";\r\nshared #\"Archivo de ejemplo\" = let\r\n  Origen = Folder.Files(\"C:\\Users\\user\\Desktop\\07 Visitas\"),\r\n  #\"Archivos ocultos filtrados\" = Table.SelectRows(Origen, each [Attributes]?[Hidden]? <> true),\r\n  Navegación = #\"Archivos ocultos filtrados\"{0}[Content]\r\nin\r\n  Navegación;\r\nshared Parámetro = let\r\n  Parámetro = #\"Archivo de ejemplo\" meta [IsParameterQuery = true, IsParameterQueryRequired = true, Type = type binary]\r\nin\r\n  Parámetro;\r\nshared #\"Transformar Archivo de ejemplo\" = let\r\n  Origen = Csv.Document(Parámetro, [Delimiter = \";\", Columns = 21, QuoteStyle = QuoteStyle.None]),\r\n  #\"Encabezados promovidos\" = Table.PromoteHeaders(Origen, [PromoteAllScalars = true]),\r\n  #\"Tipo de columna cambiado\" = Table.TransformColumnTypes(#\"Encabezados promovidos\", {{\"FECHA\", type date}, {\"HORA\", type text}, {\"ID VISITA\", Int64.Type}, {\"IDPOS\", Int64.Type}, {\"NOMBRE PUNTO\", type text}, {\"REGIONAL\", type text}, {\"RUTA\", type text}, {\"CIRCUITO\", type text}, {\"VISITA\", type text}, {\"PROCESO\", type text}, {\"MOTIVO\", type text}, {\"OBSERVACION\", type text}, {\"LATITUD\", Int64.Type}, {\"LONGITUD\", Int64.Type}, {\"ASESOR\", type text}, {\"PRECISION GPS\", Int64.Type}, {\"FECHA Y HORA GPS\", type datetime}, {\"QR\", type text}, {\"OBSERVACION QR\", type text}, {\"POSICION SIMULADA\", type text}, {\"\", type text}})\r\nin\r\n  #\"Tipo de columna cambiado\";\r\nshared #\"Transformar archivo\" = let\r\n  Origen = (Parámetro as binary) => let\r\n  Origen = Csv.Document(Parámetro, [Delimiter = \";\", Columns = 21, QuoteStyle = QuoteStyle.None]),\r\n  #\"Encabezados promovidos\" = Table.PromoteHeaders(Origen, [PromoteAllScalars = true]),\r\n  #\"Tipo de columna cambiado\" = Table.TransformColumnTypes(#\"Encabezados promovidos\", {{\"FECHA\", type date}, {\"HORA\", type text}, {\"ID VISITA\", Int64.Type}, {\"IDPOS\", Int64.Type}, {\"NOMBRE PUNTO\", type text}, {\"REGIONAL\", type text}, {\"RUTA\", type text}, {\"CIRCUITO\", type text}, {\"VISITA\", type text}, {\"PROCESO\", type text}, {\"MOTIVO\", type text}, {\"OBSERVACION\", type text}, {\"LATITUD\", Int64.Type}, {\"LONGITUD\", Int64.Type}, {\"ASESOR\", type text}, {\"PRECISION GPS\", Int64.Type}, {\"FECHA Y HORA GPS\", type datetime}, {\"QR\", type text}, {\"OBSERVACION QR\", type text}, {\"POSICION SIMULADA\", type text}, {\"\", type text}})\r\nin\r\n  #\"Tipo de columna cambiado\"\r\nin\r\n  Origen;\r\n"},"annotations":[{"name":"pbi:QueryGroups","value":"[{\"id\":\"1133ee19-c804-4fbf-9158-a21c38c1019f\",\"name\":\"Transformar archivo de 07 Visitas\",\"description\":null,\"parentId\":null,\"order\":0},{\"id\":\"9249fe5a-27b1-4759-adc2-acc97eda55ba\",\"name\":\"Consultas auxiliares\",\"description\":null,\"parentId\":\"1133ee19-c804-4fbf-9158-a21c38c1019f\",\"order\":0}]"}],"entities":[{"$type":"LocalEntity","name":"07 Visitas","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"07%20Visitas.csv"},"attributes":[{"name":"Source.Name","dataType":"string"},{"name":"FECHA","dataType":"date"},{"name":"HORA","dataType":"string"},{"name":"ID VISITA","dataType":"int64"},{"name":"IDPOS","dataType":"int64"},{"name":"NOMBRE PUNTO","dataType":"string"},{"name":"REGIONAL","dataType":"string"},{"name":"RUTA","dataType":"string"},{"name":"CIRCUITO","dataType":"string"},{"name":"VISITA","dataType":"string"},{"name":"PROCESO","dataType":"string"},{"name":"MOTIVO","dataType":"string"},{"name":"OBSERVACION","dataType":"string"},{"name":"LATITUD","dataType":"int64"},{"name":"LONGITUD","dataType":"int64"},{"name":"ASESOR","dataType":"string"},{"name":"PRECISION GPS","dataType":"int64"},{"name":"QR","dataType":"string"},{"name":"OBSERVACION QR","dataType":"string"},{"name":"POSICION SIMULADA","dataType":"string"},{"name":"_","dataType":"string"}],"partitions":[{"name":"FullRefreshPolicyPartition","refreshTime":"2021-02-09T07:17:44.7484565+00:00","location":"https://wabipaas1scuscdsa.blob.core.windows.net:443/6be19129-a1e5-4d83-957d-9af156bd3740/07%20Visitas.csv?snapshot=2021-02-09T07%3A17%3A44.7156249Z"}]}]}